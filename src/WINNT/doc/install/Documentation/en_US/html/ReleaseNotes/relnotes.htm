<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 11 (filtered)">
<title>OpenAFS for Windows 1.4.3 Release Notes</title>

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Albany;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:StarSymbol;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Thorndale;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:Cumberland;
	panose-1:2 7 3 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Andale Sans UI";
	panose-1:2 11 5 2 0 0 0 0 0 1;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
h1
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	text-indent:0pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:Albany;}
h2
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	text-indent:0pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Albany;
	font-style:italic;}
h3
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	text-indent:0pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Albany;}
h4
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:3.0pt;
	margin-left:0pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman";}
h5
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:3.0pt;
	margin-left:0pt;
	font-size:13.0pt;
	font-family:Thorndale;
	font-style:italic;}
h6
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:3.0pt;
	margin-left:0pt;
	font-size:11.0pt;
	font-family:"Times New Roman";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:14.15pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:28.3pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:0pt;
	font-size:10.0pt;
	font-family:Thorndale;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.MsoEnvelopeAddress, li.MsoEnvelopeAddress, div.MsoEnvelopeAddress
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:144.0pt;
	font-size:12.0pt;
	font-family:Arial;}
span.MsoFootnoteReference
	{vertical-align:super;}
p.MsoList, li.MsoList, div.MsoList
	{margin-top:0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	text-align:center;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:Albany;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:14.15pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	text-align:center;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Albany;
	font-style:italic;}
a:link, span.MsoHyperlink
	{color:navy;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:maroon;
	text-decoration:underline;}
pre
	{margin:0pt;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
span.Bullets
	{font-family:StarSymbol;}
p.Heading, li.Heading, div.Heading
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Albany;}
p.Caption1, li.Caption1, div.Caption1
	{margin-top:6.0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	font-size:10.0pt;
	font-family:Thorndale;
	font-style:italic;}
p.Index, li.Index, div.Index
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.ContentsHeading, li.ContentsHeading, div.ContentsHeading
	{margin-top:12.0pt;
	margin-right:0pt;
	margin-bottom:6.0pt;
	margin-left:0pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:Albany;
	font-weight:bold;}
p.PreformattedText, li.PreformattedText, div.PreformattedText
	{margin:0pt;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:Cumberland;}
p.ListContents, li.ListContents, div.ListContents
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:28.35pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.ListHeading, li.ListHeading, div.ListHeading
	{margin-top:4.3pt;
	margin-right:0pt;
	margin-bottom:4.3pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
span.HeadingChar
	{font-family:Albany;}
span.Heading3Char
	{font-family:Albany;
	font-weight:bold;}
p.Header5, li.Header5, div.Header5
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
p.Heading3, li.Heading3, div.Heading3
	{margin-top:7.2pt;
	margin-right:0pt;
	margin-bottom:7.2pt;
	margin-left:0pt;
	font-size:12.0pt;
	font-family:Thorndale;}
span.Heading4Char
	{font-family:"Andale Sans UI";
	font-weight:bold;}
p.Default, li.Default, div.Default
	{margin:0pt;
	margin-bottom:.0001pt;
	text-autospace:none;
	font-size:12.0pt;
	font-family:Arial;
	color:black;}
span.BodyTextChar
	{font-family:Thorndale;}
 /* Page Definitions */
 @page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.Section1
	{page:Section1;}
@page Section2
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.Section2
	{page:Section2;}
 /* List Definitions */
 ol
	{margin-bottom:0pt;}
ul
	{margin-bottom:0pt;}
-->
</style>

</head>

<body lang=EN-US link=navy vlink=maroon style='line-break:strict'>

<div class=Section1>

<p class=MsoTitle>OpenAFS for Windows 1.4.3<br>
Release Notes</p>

<p class=MsoBodyText>The Andrew File System (AFS) is a location-independent
file system that uses a local cache to increase its performance.  An AFS client
accesses files anonymously or via a Kerberos authentication.  The global AFS is
partitioned into cells.  The AFS cell is a collection of AFS volumes that are
administered by a common entity.   AFS cells can be administered by a
department even when the Kerberos realm used for local authentication is
managed by a much larger organization.  AFS clients and servers take advantage
of Kerberos cross realm authentication to enable authenticated access by
entities located outside the local realm.  Authorization is enforced by the use
of directory level access control lists which can consist of individual or
group identities.  </p>

<p class=MsoBodyText>The AFS volume is a tree of files and sub-directories. 
AFS volumes are created by administrators and are joined to an AFS cell via the
use of a mount point.   Once a volume is created, users can create files and
directories as well as mount points and symlinks within the volume without
regard for the physical location of the volume.  Administrators can move the
volume to another server as necessary without the need to notify users.   In
fact, the volume move can occur while files in the volume are in use.  </p>

<p class=MsoBodyText>AFS volumes can be replicated to read-only copies.   When
accessing files from a read-only replica, clients will read all of the data
from a single replica.   If that replica becomes unavailable, the clients will
failover to any replica that is reachable.  Users of the data are unaware of
where the replicas are stored or which one is being accessed.   The contents of
the replicas can be updated at any time by <i>releasing</i> the current
contents of the source volume.</p>

<p class=MsoBodyText>OpenAFS for Windows (OAFW) provides AFS client access
Microsoft Windows operating systems.  It strives to maintain transparency such
that the user is unaware of the distinction between the use of AFS and
Microsoft Windows file shares.   OAFW can be part of a single sign-on solution
by allowing credentials for a Kerberos principal to be obtained at logon and
for that principal to be used to obtain AFS tokens for one or more cells.  
Although OAFW is implemented as a locally installed SMB to AFS gateway, OAFW
maintains the portability of file paths by its use of the <a href="file:///\\AFS">\\AFS</a>
UNC server name.</p>

<p class=MsoBodyText>OpenAFS is the product of an open source development
effort begun on October 31 2000.  OpenAFS is maintained and developed by a
group of volunteers with the support of the user community.   If you use
OpenAFS as part of your computing infrastructure please contribute to its
continued growth.</p>

<p class=MsoToc1><span class=MsoHyperlink><a
href="#_Toc115417109">1. Installer Options<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a
href="#_Toc115417110">2. System Requirements<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a
href="#_Toc115417111">3. Operational Notes<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a
href="#_Toc115417112">4. How to Debug Problems
with OpenAFS for Windows:<span style='color:windowtext;display:none;text-decoration:
none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a
href="#_Toc115417113">5. Reporting Bugs:<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a
href="#_Toc115417114">6. How to Contribute to
the Development of OpenAFS for Windows<span style='color:windowtext;display:
none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a
href="#_Toc115417115">7. MSI Deployment Guide<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a
href="#_Toc115417116">Appendix A: Registry
Values<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>26</span></a></span></p>

<h1 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980939"></a><a
name="_Toc126872163"></a><a name="_Toc115417109"></a><a name="_Toc115417037"></a><a
name="_Toc115416098">1. Installer Options</a></h1>

<p class=MsoNormal>It can be installed either as a new installation or an upgrade
from previous versions of OpenAFS for Windows or IBM AFS for Windows. 
Installers are provided in two forms:</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>an executable (.exe) that is built using the Nullsoft Scriptable
Installation System, or</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>a Windows Installer package (.msi) that is built using WiX and
can be customized for organizations via the use of MSI Transforms (see <a
href="#_MSI_Deployment_Guide">MSI Deployment
Guide</a>)</p>

<h1 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980940"></a><a
name="_Toc126872164"></a><a name="_Toc115417110"></a><a name="_Toc115417038"></a><a
name="_Toc115416099">2. System Requirements</a></h1>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980941"></a><a
name="_Toc126872165"></a><a name="_Toc115417039"></a><a name="_Toc115416100">2.1
Supported Operating Systems</a></h2>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows 2000 Workstation</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows 2000 Server</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows XP Home</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows XP Professional</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows 2003 Server</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows 2003 R2 Server</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows Vista Beta 2 (not for production use)</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980942"></a><a
name="_Toc126872166"></a><a name="_Toc115416101">2.1.1 Unsupported Operating
Systems</a></h3>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows 95</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows 98</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows 98 OSR2</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows ME</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft NT</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>All 64-bit versions of Microsoft Windows on Itanium and x86-64
chipsets.</p>

<p class=MsoNormal>Older releases of OpenAFS are available for download if
unsupported 32-bit operating systems must be used.  The last version of OpenAFS
with support for Win9x is 1.2.2b.  The last version with support for Windows NT
4.0 is 1.2.10.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980943"></a><a
name="_Toc126872167"></a><a name="_Toc115417040"></a><a name="_Toc115416102">2.2
Disk Space</a></h2>

<p class=MsoNormal>Up to 60mb required for the OpenAFS binaries plus 100MB for
the default AFSCache file.   (The size of the AFSCache file may be adjusted via
the Registry after installation.)</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980944"></a><a
name="_Toc126872168"></a><a name="_Toc115417041"></a><a name="_Toc115416103">2.3
Additional Software</a> Packages</h2>

<p class=MsoNormal><a href="http://web.mit.edu/kerberos/dist/index.html">MIT
Kerberos for Windows</a> 2.6.x or 3.x.x if Kerberos 5 authentication support is
desired.</p>

<h1 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980945"></a><a
name="_Toc126872169"></a><a name="_Toc115417111"></a><a name="_Toc115417042"></a><a
name="_Toc115416104">3. Operational Notes</a></h1>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980946"></a><a
name="_Toc126872170"></a><a name="_Toc115417043"></a><a name="_Toc115416105">3.1.
Requirements for Kerberos 5 Authentication</a></h2>

<p class=MsoNormal>The Kerberos 4 infrastructure on which the OpenAFS 1.2
series is reliant is no longer secure.  Cross-realm Kerberos is very important
in the AFS context and most sites have or are migrating to Kerberos 5 environments. 
The OpenAFS 1.4 series integrates with MIT Kerberos for Windows 2.6.5 and above
to support Kerberos 5 authentication including automatic renewal of AFS tokens
and single sign-on via the Microsoft Windows Kerberos Logon Service.</p>

<p class=MsoNormal>When KFW is installed, the OpenAFS 1.4 client will obtain
Kerberos 5 tickets and use them as tokens without modification.  The OpenAFS
1.4 client requires that all of the AFS Servers with which it communicates
support the use of Kerberos 5 tickets as tokens. If Kerberos 5 based tokens are
presented to an AFS server that does not understand them, the server will be
unable to communicate with the client when tokens are present. Kerberos 5 based
tokens are supported by OpenAFS release 1.2.8 or later.  IBM Transarc servers
do not support Kerberos 5.</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980947"></a><a
name="_Toc126872171"></a><a name="_Toc115416106">3.1.1. Active Directory</a></h3>

<p class=MsoNormal>There are two things to consider when using a Microsoft
Windows Active Directory as the Kerberos realm that issues the AFS service
ticket.  First, the Kerberos 5 tickets issued by Active Directory can be quite
large when compared to tickets issued by a traditional KDC due to the
incorporation of authorization data in the PAC.  If the issued tickets become
larger than 344 bytes OpenAFS 1.2 servers will be unable to process them. 
OpenAFS 1.4 servers can support the largest tickets that Active Directory can
issue.  Second, the Kerberos 5 tickets issued by Windows 2003 Active Directory
are encrypted with the DES-CBC-MD5 enctype.  OpenAFS 1.2 servers only support
the DES-CBC-CRC enctype.</p>

<p class=MsoNormal>Microsoft has documented in <a
href="http://support.microsoft.com/kb/832572/">Knowledge Base article 832572</a>
a new NO_AUTH_REQUIRED flag that can be set on the account mapped to the AFS
service principal which will prevent the generation of a PAC.</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980948"></a><a
name="_Toc126872172"></a><a name="_Toc115416107">3.1.2. Using the krb524
service</a></h3>

<p class=MsoNormal>Some organizations which have AFS cell names and Kerberos
realm names which differ by more then just lower and upper case rely on a
modification to krb524d which maps a Kerberos 5 ticket from realm FOO to a
Kerberos 4 ticket in realm BAR.  This allows user@FOO to appear to be user@bar
for the purposes of accessing the AFS cell.  As of OpenAFS 1.2.8, support was
added to allow the immediate use of Kerberos 5 tickets as AFS (2b) tokens. This
is the first building block necessary to break away from the limitations of
Kerberos 4 with AFS.  By using Kerberos 5 directly we avoid the security holes
inherent in Kerberos 4 cross-realm.  We also gain access to cryptographically
stronger algorithms for authentication and encryption. </p>

<p class=MsoNormal>Another reason for using Kerberos 5 directly is because the
krb524 service runs on a port (4444) which has become increasingly blocked by
ISPs.  The port was used to spread a worm which attacked Microsoft Windows in
the summer of 2003.  When the port is blocked users find that they are unable
to authenticate.</p>

<p class=MsoNormal>Replacing the Kerberos 4 ticket with a Kerberos 5 ticket is
a win in all situations except when the cell name does not match the realm name
and the principal names placed into the ACLs are not the principal names from
the Kerberos 5 ticket.  To support this transition, OpenAFS for Windows 1.4
adds a new registry value, <i><a
href="#_Value___: Use524">Use524</a></i>, to
force the use of krb524d.  However, the availability of this option should only
be used by individuals until such time as their organizations can provide a
more permanent solution.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980949"></a><a
name="_Toc126872173"></a><a name="_Toc115417044"></a><a name="_Toc115416108">3.2.
Use of the Microsoft Loopback Adapter</a></h2>

<p class=MsoNormal>By itself the OpenAFS Client Service does not provide robust
behavior in a plug-n-play network environment.  Changes to the number of
network adapters or their assigned IP addresses will cause the service to
terminate unexpectedly.  To avoid this behavior OpenAFS for Windows installs a
single instance of the Microsoft Loopback Adapter (MLA) on the machine.  With
the MLA installed, the OpenAFS Client Service will not be affected by the
configuration changes of other network adapters installed on the system.  </p>

<p class=MsoNormal>The MLA is installed with a name of &quot;AFS&quot; and a pre-assigned
IP address in the 10.x.x.x range.  The MLA is bound to the Client for
Microsoft Networks service and not bound to the File and Printer Sharing for
Microsoft Networks.  If the MLA is unbound to &quot;Client Microsoft
Networks&quot;, the OpenAFS Client Service will become inaccessible when the
machine is disconnected from the network.  If the MLA is bound to &quot;File
and Printer Sharing ...&quot; there will be a service type collision between
the name &quot;AFS&quot; and the name of the machine on the MLA's IP Address
that will result in the OpenAFS client service becoming inaccessible and the
&quot;NET VIEW \\AFS&quot; command will return a &quot;System Error 52&quot;
message.  To correct the problem:</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span> stop the AFS Client Service</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span> bind the &quot;Client for Microsoft Networks&quot; to the MLA</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span> unbind &quot;File and Printer Sharing for Microsoft
Networks&quot; from the MLA</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span> Disable and then re-enable the MLA</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span> start the AFS Client Service</p>

<p class=MsoNormal>When the MLA is not installed the unique NETBIOS name
published by OpenAFS SMB server is &quot;<i>MACHINE</i>-AFS&quot;.  One of the
benefits of using the MLA is that the NETBIOS name does not have to be
published on any adapter other than the MLA.  Therefore the chosen name is no
longer required to be unique.  Instead the NETBIOS name associated with the AFS
Client Service is simply &quot;AFS&quot; and portable UNC paths of the form \\AFS\cellname\path
can now be used on all machines.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980950"></a><a
name="_Toc126872174"></a><a name="_Toc115417045"></a><a name="_Toc115416109">3.3.
Using Freelance (Dynamic Root) Mode to Improve Mobility</a></h2>

<p class=MsoNormal>Traditionally, when the OpenAFS Client Service starts it
must be able to access the &quot;root.afs&quot; volume of the default cell. 
The &quot;root.afs&quot; volume contains the set of mount points to the
&quot;root.cell&quot; volumes of various cells the administrator of the default
cell believes should be accessible.  If the &quot;root.afs&quot; volume is
inaccessible when the client service is started, the service will terminate
unexpectedly.  Since many users now use laptops or otherwise operate in
disconnected environments in which a VPN may be required to access the cell's
servers, it is often the case that the &quot;root.afs&quot; volume for the
default cell is not reachable and the OpenAFS Client Service will not
successfully start. </p>

<p class=MsoNormal>To allow the OpenAFS Client Service to operate in these
environments, a fake &quot;root.afs&quot; volume is dynamically constructed
from mount points and symlinks stored in the local registry.  This method of
operation is referred to as Freelance mode.</p>

<p class=MsoNormal>The content of the fake root.afs volume is dynamically
modified as cells are accessed.  When the fake &quot;root.afs&quot; volume is
initially constructed it will only contain two mount points: a <i>regular path </i>and
<i>read-write path </i>mount point used to access the &quot;root.cell&quot;
volume of the default AFS cell.  Any attempt to access a valid cell name will
result in a new mount point being created in the fake &quot;root.afs&quot;
volume.  If the cellname begins with a &quot;.&quot; the mount point will be a <i>read-write
path</i>; otherwise the mount point will be a <i>regular path</i>.  These mount
points are preserved in the registry at key:</p>

<p class=PreformattedText style='margin-left:35.45pt'><a
href="#_Regkey:_[HKLMSOFTWAREOpenAFSClie">HKLM\SOFTWARE\OpenAFS\Client\Freelance</a></p>

<p class=MsoNormal>Additional mount points may be manually created using the
&quot;fs mkmount&quot; command.  Mount points may be removed using the &quot;fs
rmmount&quot; command.</p>

<p class=PreformattedText style='margin-left:35.45pt'>&gt;fs mkmount
\\AFS\athena.mit.edu root.cell athena.mit.edu</p>

<p class=PreformattedText style='margin-left:35.45pt'>&gt;fs mkmount \\AFS\.athena.mit.edu
root.cell athena.mit.edu -rw</p>

<p class=PreformattedText style='margin-left:35.45pt'>&gt;fs rmmount
\\AFS\athena.mit.edu</p>

<p class=PreformattedText style='margin-left:35.45pt'>&gt;fs rmmount
\\AFS\.athena.mit.edu</p>

<p class=MsoNormal>Symlinks may also be created within the Freelance root.afs
volume.</p>

<p class=PreformattedText style='margin-left:35.45pt'>&gt;symlink make \\afs\link
\\afs\athena.mit.edu\user\j\a\jaltman</p>

<p class=PreformattedText>      &gt;symlink list \\afs\link</p>

<p class=PreformattedText>      '\\afs\link' is a symlink to
'athena.mit.edu\user\j\a\jaltman'</p>

<p class=PreformattedText style='margin-left:35.45pt'>&gt;symlink rm \\afs\link</p>

<p class=MsoNormal>The symlinks are stored in the registry at:</p>

<p class=PreformattedText style='margin-left:35.45pt'><a
href="#_Regkey:_[HKLMSOFTWAREOpenAFSClie_1">HKLM\SOFTWARE\OpenAFS\Client\Freelance\Symlinks</a> </p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980951"></a><a
name="_Toc126872175"></a><a name="_Toc115417046"></a><a name="_Toc115416110">3.4.
Locating AFS Volume Database Servers</a> </h2>

<p class=MsoNormal>The OpenAFS for Windows client will use DNS AFSDB records to
discover the location of AFS Volume Database servers when entries are not
present in the client's CellServDB file
(\%PROGRAMFILES%\OpenAFS\Client\CellServDB).</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980952"></a><a
name="_Toc126872176"></a><a name="_Toc115417047"></a><a name="_Toc115416111">3.5.
Obtaining AFS Tokens as a Part of Windows Logon</a></h2>

<p class=MsoNormal>OpenAFS for Windows installs a WinLogon Network Provider to
provide Single Sign-On functionality (aka Integrated Logon.)  Integrated Logon
can be used when the Windows username and password match the username and
password associated with the default cell's Kerberos realm.  For example, if
the Windows username is &quot;jaltman&quot; and the default cell is
&quot;athena.mit.edu&quot;, then Integrated Logon can be successfully used if
the windows password matches the password assigned to the Kerberos principal
&quot;<a href="mailto:jaltman@ATHENA.MIT.EDU">jaltman@ATHENA.MIT.EDU</a>&quot;. 
The realm ATHENA.MIT.EDU is obtained by performing a domain name to realm
mapping on the hostname of one of the cell's Volume Database servers.</p>

<p class=MsoNormal>Integrated Logon is required if you desire the ability to
store roaming user profiles within the AFS file system.  OpenAFS does not
provide tools for synchronizing the Windows and Kerberos user accounts and
passwords.</p>

<p class=MsoNormal>When KFW is configured, Integrated Logon will use it to
obtain tokens.  The Kerberos 5 tickets obtained during the process of
generating AFS tokens are preserved and stored into the default ccache within
the user logon session.</p>

<p class=MsoNormal>Integrated Logon does not have the ability to cache the
user's username and password for the purpose of obtaining tokens if the
Kerberos KDC is inaccessible at logon time.</p>

<p class=MsoNormal>Integrated Login supports the ability to obtain tokens for
multiple cells.  For further information on how to configure this feature read
the <a href="#_Value:_TheseCells">TheseCells</a> value in <a
href="#_Appendix_A:_Registry_Values">Appendix A</a>.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980953"></a><a
name="_Toc126872177"></a><a name="_Toc115417048"></a><a name="_Toc115416112">3.6.
AFS System Tray Command Line Options</a></h2>

<p class=MsoNormal>The AFS System Tray tool (afscreds.exe) supports several
command line options: </p>

<p class=PreformattedText>    -A = autoinit </p>

<p class=PreformattedText>    -E = force existing afscreds to exit</p>

<p class=PreformattedText>    -I = install startup shortcut</p>

<p class=PreformattedText>    -M = renew drive maps </p>

<p class=PreformattedText>    -N = IP address change detection </p>

<p class=PreformattedText>    -Q = quiet mode.  do not display start service
dialog</p>

<p class=PreformattedText>         if afsd_service is not already running</p>

<p class=PreformattedText>    -S = show tokens dialog on startup</p>

<p class=PreformattedText>    -U = uninstall startup shortcut</p>

<p class=PreformattedText>    -X = test and do map share</p>

<p class=PreformattedText>    -Z = unmap drives</p>

<p class=MsoNormal>autoinit will result in automated attempts to acquire AFS
tokens when afscreds.exe is started.  afscreds.exe will attempt to utilize
tickets stored in the MSLSA credentials cache; any existing CCAPI credentials
cache; and finally display an Obtain Tokens dialog to the user.  When used in
combination with IP address change detection, afscreds.exe will attempt to
acquire AFS tokens whenever the IP address list changes and the Kerberos KDC is
accessible.</p>

<p class=MsoNormal>The renew drive maps option is used to ensure that the user
drive maps constructed via the OpenAFS tools (not NET USE) are re-constructed
each time afscreds.exe is started.</p>

<p class=MsoNormal>By default afscreds.exe is configured by the OpenAFS.org
installers to use -A -N -M -Q as startup options.  Currently, there is no
user interface to change this selection after install time although these
options may be altered via the registry on either per machine or per user
basis.  See <a
href="#_Value___: AfscredsShortcutParams">AfscredsShortcutParams</a>
in <a href="#_Appendix_A:_Registry_Values">Appendix
A</a>.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980954"></a><a
name="_Toc126872178"></a><a name="_Toc115417049"></a><a name="_Toc115416113">3.7.
The AFS Client Admins Authorization Group</a></h2>

<p class=MsoNormal>The OpenAFS for Windows 1.4 client supports a local Windows
authorization group named &quot;AFS Client Admins&quot;.  This group is used in
place of the &quot;Administrators&quot; group to determine which users are
allowed to modify the AFS Client Service configuration via the AFS Control
Panel (afs_config.exe) or fs.exe command line tool.  The following fs.exe
commands are now restricted to members of the &quot;AFS Client Admins&quot;
group:</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>checkservers with a non-zero timer value</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setcachesize</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>newcell</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>sysname with a new sysname list</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>exportafs</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setcell</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setserverprefs</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>storebehind</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setcrypt</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>cscpolicy</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>trace</p>

<p class=PreformattedText style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>minidump</p>

<p class=MsoNormal>The creation or removal of mount points and symlinks in the
Freelance root.afs volume are also restricted to members of the AFS Client
Admins group.</p>

<p class=MsoNormal>The initial membership of the &quot;AFS Client Admins&quot;
group when created by the installer is equivalent to the local
&quot;Administrators&quot; group.  If a user is added to the
&quot;Administrators&quot; group after the creation of the &quot;AFS Client
Admin&quot; group, that user will not be an AFS Client Administrator.  Only
users that are members of the &quot;AFS Client Admins&quot; group are AFS
Client Administrators.  The local &quot;SYSTEM&quot; account is an implicit
member of the &quot;AFS Client Admins&quot; group.</p>

<p class=MsoNormal>Setting the default sysname for a machine should be done via
the <a href="#_Value_:_SysName">registry</a>
and not via &quot;fs sysname&quot;.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980955"></a><a
name="_Toc126872179"></a><a name="_Toc115417050"></a><a name="_Toc115416114">3.8.
OpenAFS support for UNC paths</a> </h2>

<p class=MsoNormal>The OpenAFS 1.4 client supports UNC paths everywhere.  UNC
paths provide a canonical name for resources stored within AFS.  UNC paths
should be used instead of drive letter mappings whenever possible.   This is
especially true when specifying the location of roaming profiles and redirected
folders.  </p>

<p class=MsoNormal>Power users that make extensive use of the command line
shell, cmd.exe, should consider using JP Software's 4NT or Take Command command
processors.  Unlike cmd.exe, the JPSoftware shells fully support UNC paths as
the current directory.  With the release of version 4NT 7.0 and Take Command 7.0,
JPSoftware is adding special recognition of OpenAFS.  AFS paths can be entered
in UNIX notation (e.g., <a href="file:///\\afs\openafs.org\software">/afs/openafs.org/software</a>),
space utilization reports the output of the volume status for the specified
path, and many AFS specific functions and variables have been added to the
command language.</p>

<p class=MsoNormal>JPSoftware's web site is <span class=MsoHyperlink>http://www.jpsoft.com</span>.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980956"></a><a
name="_Toc126872180"></a><a name="_Toc115417051"></a><a name="_Toc115416115">3.9.
OpenAFS includes aklog.exe</a></h2>

<p class=MsoNormal>The OpenAFS 1.4 Client ships with its own version of
aklog.exe which should be used in preference to those obtained by third party
sources.  The OpenAFS aklog.exe supports Kerberos 5 as well as the ability to
auto-generate AFS IDs within foreign PTS databases.</p>

<p class=PreformattedText>Usage: aklog [-d] [[-cell | -c] cell [-k krb_realm]]</p>

<p class=PreformattedText>             [[-p | -path] pathname]</p>

<p class=PreformattedText>             [-noprdb] [-force]</p>

<p class=PreformattedText>             [-5 [-m]| -4]</p>

<p class=PreformattedText>&nbsp;</p>

<p class=PreformattedText>   -d = output debugging information.</p>

<p class=PreformattedText>   cell = zero or more cells for which tokens will be
obtained</p>

<p class=PreformattedText>   krb_realm = the kerberos realm of the cell.</p>

<p class=PreformattedText>   pathname = the directory for which authentication
is required</p>

<p class=PreformattedText>   -noprdb = don't try to determine AFS ID.</p>

<p class=PreformattedText>   -5 or -4 = use Kerberos V (default) or Kerberos IV
tickets</p>

<p class=PreformattedText>   -m = use krb524d to convert Kerberos V tickets to
Kerberos IV</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980957"></a><a
name="_Toc126872181"></a><a name="_Toc115417052"></a><a name="_Toc115416116">3.10.
OpenAFS Servers on Windows are Unsupported</a></h2>

<p class=MsoNormal>The AFS Server functionality provided with OpenAFS 1.4 might
work but should be considered highly experimental.  It has not been thoroughly
tested.  Any data which would cause pain if lost should not be stored in an
OpenAFS Server on Windows.</p>

<p class=MsoNormal>A few notes on the usage of the AFS Client Service if it is
going to be used with the OpenAFS AFS Server:</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>When installed on the same machine as the AFS Server, Freelance
mode must be turned off.  Otherwise, you will be unable to manipulate the
contents of the root.afs volume for the hosted cell.</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The AFS Server and related tools only support the built in kaserver
(Kerberos IV).  If the AFS Server is being used, MIT Kerberos for Windows
should not be installed or must be disabled.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980958"></a><a
name="_Toc126872182"></a><a name="_Toc115417053"></a><a name="_Toc115416117">3.11.
OpenAFS Debugging Symbol files</a></h2>

<p class=MsoNormal>The OpenAFS for Windows installers now include Debugging
Symbol files which should be installed if you are experiencing problems and
need to send crash reports.  This is true for both the release and the debug
versions of the installers.  The difference between the release and debug
versions are:</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>whether or not the binaries were compiled with optimization</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>whether the debug symbols are installed by default</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>whether additional debug statements were compiled into the
binaries</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980959"></a><a
name="_Toc126872183"></a><a name="_Toc115417054"></a><a name="_Toc115416118">3.12.
Maximum File Size is 2GB</a></h2>

<p class=MsoNormal>OpenAFS for Windows does not support files larger than 2GB. 
The version of the SMB/CIFS protocol implemented imposes this limitation. 
Upgrading the SMB/CIFS implementation or replacing it with an Installable File
System will allow larger files to be supported. </p>

<p class=MsoNormal>OpenAFS for Windows 1.5.3 or greater will provide support
for files up to 16777216 terabytes.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980960"></a><a
name="_Toc126872184"></a><a name="_Toc115417055"></a><a name="_Toc115416119">3.13.
Encrypted AFS File Access</a></h2>

<p class=MsoNormal>The OpenAFS for Windows installer by default activates a
weak form of encrypted data transfer between the AFS client and the AFS
servers.  This is often referred to as &quot;fcrypt&quot; mode.  Encrypted data
transfer can be turned on or off with the fs crypt command.  Transitions
between crypt and non-crypt modes are logged to the Windows Application
Event Log. </p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980961"></a><a
name="_Toc126872185"></a><a name="_Toc115417056"></a><a name="_Toc115416120">3.14.
Authenticated Access to the OpenAFS Client Service</a></h2>

<p class=MsoNormal>OpenAFS 1.4 supports authenticated SMB connections using
either NTLM or GSS SPNEGO (NTLM).  In previous versions of OpenAFS, the SMB
connections were unauthenticated which opened the door for several attacks
which could be used to obtain access to another user's tokens on shared
machines.    </p>

<p class=MsoNormal>When GSS SPNEGO attempts a Kerberos 5 authentication, the
Windows SMB client will attempt to retrieve service tickets for
&quot;cifs/afs@REALM&quot; (if the loopback adapter is in use) or
&quot;cifs/machine-afs@REALM&quot; (if the loopback adapter is not being
used).  It is extremely important that this service principal not exist in the
KDC database as the Kerberos authentication must fail allowing automatic
fallback to NTLM.  When NTLM is used a special local authentication mode will
be used that does not require access to the user's password.  Instead, Windows
will internally recognize the request as coming from a local logon session.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980962"></a><a
name="_Toc126872186"></a><a name="_Toc115417057"></a><a name="_Toc115416121">3.15.
No More INI Files</a></h2>

<p class=MsoNormal>Previous AFS clients for Windows stored configuration data
in Windows .INI files.   OpenAFS 1.4 does not use Windows .INI files for the storage
of configuration data.   All settings are now stored in the registry (see <a
href="#_Appendix_A:_Registry_Values">Appendix A</a>). 
The CellServDB file is now stored in the %PROGRAMFILES%\OpenAFS\Client directory.  
The <i><a href="#_Value___: CellServDBDir">CellServDBDir</a></i>
registry value can be used to specify an alternative location.</p>

<p class=MsoNormal>OpenAFS 1.4 will relocate the contents of the afsdcell.ini
file to the new CellServDB file.  OpenAFS 1.4 will also import the contents of
the afs_freelance.ini file to the Windows registry.   OpenAFS 1.4 will not
process the contents of the afsddbmt.ini.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980963"></a><a
name="_Toc126872187"></a><a name="_Toc115417058"></a><a name="_Toc115416122">3.16.
Microsoft Windows Internet Connection Firewall</a></h2>

<p class=MsoNormal>The OpenAFS 1.4 Client is compatible with the Internet Connection
Firewall that debuted with Windows XP SP2 and Windows 2003 SP1.  The Internet
Connection Firewall will be automatically adjusted to allow the receipt of
incoming callback messages from the AFS file server.  In addition, the
appropriate <i>Back Connection</i> registry entries are added to allow SMB
authentication to be performed across the Microsoft Loopback Adapter.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980964"></a><a
name="_Toc126872188"></a><a name="_Toc115417059"></a><a name="_Toc115416123">3.17.
Browsing AFS from the Explorer Shell and Office</a></h2>

<p class=MsoNormal>The OpenAFS 1.4 Client Service implements the CIFS Remote
Admin Protocol which allows Explorer to browse server and share information.
This significantly enhances the interoperability of AFS volumes within the
Explorer Shell and Microsoft Office applications.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980965"></a><a
name="_Toc126872189"></a><a name="_Toc115417060"></a><a name="_Toc115416124">3.18.
</a>Byte Range Locking</h2>

<p class=MsoBodyText>Many applications on Windows (e.g. Microsoft Office)
require the use of byte range locks applied to a file either to protect against
simultaneous file access or as a signaling mechanism.   OpenAFS implements byte
range locking local to the machine.   OpenAFS does not obtain file locks on the
server.   It is strongly recommended that files not be edited within AFS if
they might be accessed by multiple users or multiple processes on more than one
machine at the same time.</p>

<p class=MsoNormal>Note: <span style='font-family:"Times New Roman"'>In a
future release, OpenAFS for Windows will utilize AFS' advisory locks to
simulate Microsoft Windows mandatory locks.&nbsp;&nbsp; When an application
opens a file, a lock will be placed in AFS indicating that the file is in
use.&nbsp; If the lock is a write lock, the use of the file will be restricted
to other applications running on the same machine as the first application to
apply the lock.&nbsp;&nbsp; Applications running on other machines will see the
full lock and will be unable to access the file.</span></p>

<p class=MsoNormal><span style='font-family:"Times New Roman"'>Most Windows
applications and Windows itself opens files in shared read mode. When this is
done, a read lock is applied to the file.&nbsp;&nbsp; This does not prevent
shared read access across multiple machines but is used to ensure that no one
writes to the file while it is in use.</span></p>

<p class=MsoNormal>As locks are checked and applied during the file open
operation, it is crucial that users have the locking 'k' privilege in all
directories in which the user might read a file or execute an application
unless the directory exists on a read only volume.&nbsp; A failure to assign
the 'k' privilege will result in &quot;Access Denied&quot; errors during file
open. </p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980966"></a><a
name="_Toc126872190"></a><a name="_Toc115417061"></a><a name="_Toc115416125">3.19.
Automatic Discarding of AFS Tokens at Logoff</a></h2>

<p class=MsoNormal>OpenAFS 1.4 will automatically forget a user's tokens upon
Logoff unless the user's profile was loaded from an AFS volume.  In this
situation there is no mechanism to determine when the profile has been successfully
written back to the network.  It is therefore unsafe to release the user's
tokens.  Whether or not the profile has been loaded from the registry can be
determined for Local Accounts, Active Directory accounts and NT4 accounts.</p>

<p class=MsoNormal>If there is a need to disable this functionality, the <a
href="#_Value_:_LogoffPreserveTokens">LogoffPreserveTokens</a>
registry value can be used. (see <a
href="#_Appendix_A:_Registry_Values">Appendix A</a>.)</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980967"></a><a
name="_Toc126872191"></a><a name="_Toc115417062"></a><a name="_Toc115416126">3.20.
Terminal Server installations</a></h2>

<p class=MsoNormal>When installing the NSIS (.exe) installer under Terminal
Server, you must execute it from within the Add/Remove Programs Control Panel. 
Failure to do so will result in AFS not running properly.  The AFS Server
should not be installed on a machine with Terminal Server installed.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980968"></a><a
name="_Toc126872192"></a><a name="_Toc115417063"></a><a name="_Toc115416127">3.21.
Hidden Dot Files</a></h2>

<p class=MsoNormal>AFS is a UNIX native file system.  The OpenAFS client
attempts to treat the files stored in AFS as they would be on UNIX.  File and
directory names beginning with a &quot;.&quot; are automatically given the
Hidden attribute so they will not normally be displayed.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980969"></a><a
name="_Toc126872193"></a><a name="_Toc115417064"></a><a name="_Toc115416128">3.22.
Status Cache Limits</a></h2>

<p class=MsoNormal>The Status Cache (AFS Configuration Control Panel: Advanced
Page) is defined to have a maximum number of entries.  Each entry represents a
single file or directory entry accessed within the AFS file system.  When the
maximum number of entries are allocated, entries will begin to be reused
according to a least recently used (LRU) algorithm.  If the number of files or
directories being accessed repeatedly by your applications is greater then the
maximum number of entries, your host will begin to experience thrashing of the
Status Cache and all requests will result in network operations.</p>

<p class=MsoNormal>If you are experiencing poor performance try increasing the
maximum number of Status Cache entries.  Each entry requires approximately
1.2K.  In OpenAFS 1.4, the default number of Status Cache entries is 10,000.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980970"></a><a
name="_Toc126872194"></a><a name="_Toc115417065"></a><a name="_Toc115416129">3.23.
NETBIOS over TCP/IP must be enabled</a></h2>

<p class=MsoNormal>&quot;Netbios over TCP/IP&quot; must be active on the
machine in order for communication with the AFS Client Service to succeed.  If
&quot;Netbios over TCP/IP&quot; is disabled on the machine, then communication
with the AFS Client Service will be impossible.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980971"></a><a
name="_Toc126872195"></a><a name="_Toc115417066"></a><a name="_Toc115416130">3.24.
OpenAFS binaries are digitally signed</a></h2>

<p class=MsoNormal>The OpenAFS Client Service and related binaries distributed
by OpenAFS.org are digitally signed by &quot;Secure Endpoints Inc.&quot;.  The
OpenAFS Client Service will perform a run-time verification check to ensure
that all OpenAFS related DLLs loaded by the service match the same file version
number and were signed by the same entity.  This check has been added to
prevent the stability problems caused by more than one AFS installation present
on a machine at the same time.  Many hours of support time have been wasted
tracking down problems caused by the mixture of files from different releases. 
</p>

<p class=MsoNormal><a
href="#_Appendix_A:_Registry_Values">Appendix A</a>
documents the &quot;<a
href="#_Value___: VerifyServiceSignature">VerifyServiceSignature</a>&quot;
registry value which can be used to disable the signature check.  The file
version check cannot be disabled.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980972"></a><a
name="_Toc126872196"></a><a name="_Toc115417067"></a><a name="_Toc115416131">3.25.
Maximum Size of the AFSCache File</a></h2>

<p class=MsoNormal>The maximum cache size is approximately 1.3GB.  This is the
largest contiguous block of memory in the 2GB process address space which can
be used for constructing a memory mapped file.  Due to fragmentation of the
process space caused by the loading of libraries required by the digital
signature verification code, any attempt to specify a cache size greater then
700MB will result in the automatic disabling of the signature check.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980973"></a><a
name="_Toc126872197"></a><a name="_Toc115417068"></a><a name="_Toc115416132">3.26.
Filename Character Sets</a></h2>

<p class=MsoNormal>OpenAFS for Windows implements an SMB server which is used
as a gateway to the AFS filesystem.  Because of limitations of the SMB
implementation, Windows stores all files into AFS using OEM code pages such as
CP437 (United States) or CP850 (Western Europe).  These code pages are
incompatible with the ISO Latin-1 character set typically used as the default
on UNIX systems in both the United States and Western Europe.  Filenames stored
by OpenAFS for Windows are therefore unreadable on UNIX systems if they include
any of the following characters:</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr style='height:399.5pt'>
  <td width=590 valign=top style='width:442.8pt;border:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt;height:399.5pt'>
  <p class=PreformattedText>     [Ç]  128  08/00  200  80  C cedilla</p>
  <p class=PreformattedText>     [ü]  129  08/01  201  81  u diaeresis</p>
  <p class=PreformattedText>     [é]  130  08/02  202  82  e acute</p>
  <p class=PreformattedText>     [â]  131  08/03  203  83  a circumflex</p>
  <p class=PreformattedText>     [ä]  132  08/04  204  84  a diaeresis</p>
  <p class=PreformattedText>     [à]  133  08/05  205  85  a grave</p>
  <p class=PreformattedText>     [å]  134  08/06  206  86  a ring</p>
  <p class=PreformattedText>     [ç]  135  08/07  207  87  c cedilla</p>
  <p class=PreformattedText>     [ê]  136  08/08  210  88  e circumflex</p>
  <p class=PreformattedText>     [ë]  137  08/09  211  89  e diaeresis</p>
  <p class=PreformattedText>     [è]  138  08/10  212  8A  e grave</p>
  <p class=PreformattedText>     [ï]  139  08/11  213  8B  i diaeresis</p>
  <p class=PreformattedText>     [î]  140  08/12  214  8C  i circumflex</p>
  <p class=PreformattedText>     [ì]  141  08/13  215  8D  i grave</p>
  <p class=PreformattedText>     [Ä]  142  08/14  216  8E  A diaeresis</p>
  <p class=PreformattedText>     [Å]  143  08/15  217  8F  A ring</p>
  <p class=PreformattedText>     [É]  144  09/00  220  90  E acute</p>
  <p class=PreformattedText>     [æ]  145  09/01  221  91  ae diphthong</p>
  <p class=PreformattedText>     [Æ]  146  09/02  222  92  AE diphthong</p>
  <p class=PreformattedText>     [ô]  147  09/03  223  93  o circumflex</p>
  <p class=PreformattedText>     [ö]  148  09/04  224  94  o diaeresis</p>
  <p class=PreformattedText>     [ò]  149  09/05  225  95  o grave</p>
  <p class=PreformattedText>     [û]  150  09/06  226  96  u circumflex</p>
  <p class=PreformattedText>     [ù]  151  09/07  227  97  u grave</p>
  <p class=PreformattedText>     [ÿ]  152  09/08  230  98  y diaeresis</p>
  <p class=PreformattedText>     [Ö]  153  09/09  231  99  O diaeresis</p>
  <p class=PreformattedText>     [Ü]  154  09/10  232  9A  U diaeresis</p>
  <p class=PreformattedText>     [ø]  155  09/11  233  9B  o slash</p>
  <p class=PreformattedText>     [£]  156  09/12  234  9C  Pound sterling sign</p>
  <p class=PreformattedText>     [Ø]  157  09/13  235  9D  O slash</p>
  <p class=PreformattedText>     [×]  158  09/14  236  9E  Multiplication sign</p>
  <p class=PreformattedText>     []  159  09/15  237  9F  Florin sign</p>
  </td>
 </tr>
</table>

<p class=PreformattedText>&nbsp;</p>

<p class=MsoNormal>OpenAFS 1.4 provides an optional registry value, <i><a
href="#_Value___: StoreAnsiFilenames">StoreAnsiFilenames</a></i>,
that can be set to instruct OpenAFS to store filenames using the ANSI Code Page
instead of the OEM Code Page.  The ANSI Code Page is a compatible superset of
Latin-1.  This setting is not the default setting because making this change
would prevent OpenAFS for Windows from being able to access filenames
containing the above characters which were created without this setting.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980974"></a><a
name="_Toc126872198"></a><a name="_Toc115417069"></a><a name="_Toc115416133">3.27.
Known Character Set Issues with Roaming Profiles</a></h2>

<p class=MsoNormal>There is a known issue with storing Windows Roaming Profiles
when the profile contains either directories or files with names which cannot
be represented in the local OEM character set.  In this case, attempts to write
the profile back to AFS will fail.  OpenAFS for Windows does not currently
support UNICODE.  To avoid this problem some sites run logoff scripts (assigned
by group policy) which rename all files to use only the supported characters
for the locale.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980975"></a><a
name="_Toc126872199"></a><a name="_Toc115417070"></a><a name="_Toc115416134">3.28.
The AFSCache File</a></h2>

<p class=MsoNormal>The AFS Cache file is stored by default at %TEMP%\AFSCache
in a persistent file marked with the Hidden and System attributes.  The
persistent nature of the data stored in the cache file improves the performance
of OpenAFS by reducing the number of times data must be read from the AFS file
servers.  </p>

<p class=MsoNormal>The performance of the AFS Client Service is significantly
affected by the access times associated with the AFSCache paging file.   When
given the choice, the AFSCache file should be placed on a fast disk, preferably
NTFS, the file should not be compressed and should consist of as few fragments
as possible.   Significant performance gains can be achieved by defragmenting
the AFSCache file with Sysinternal's Contig utility.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980976"></a><a
name="_Toc126872200"></a><a name="_Toc115417071"></a><a name="_Toc115416135">3.29.
Restricting OpenAFS Client Service Start and Stop</a></h2>

<p class=MsoNormal>A new command line tool, afsdacl.exe, can be used to
restrict the ability to start and stop the OpenAFS Client Service.</p>

<p class=PreformattedText>    afsdacl : Set or reset the DACL to allow starting
or stopping</p>

<p class=PreformattedText>         the afsd service by any ordinary user.</p>

<p class=PreformattedText>&nbsp;</p>

<p class=PreformattedText>    Usage : afsdacl [-set | -reset] [-show]</p>

<p class=PreformattedText>          -set   : Sets the DACL</p>

<p class=PreformattedText>          -reset : Reset the DACL</p>

<p class=PreformattedText>          -show  : Show current DACL (SDSF)</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980977"></a><a
name="_Toc126872201"></a><a name="_Toc115417072"></a><a name="_Toc115416136">3.30.
The @sys Name List</a></h2>

<p class=MsoNormal>The default @sys name list in OpenAFS 1.4 is set to
&quot;x86_win32 i386_w2k i386_nt40&quot; for 32-bit x86 systems.  The default
for itanium will be &quot;ia64_win64&quot; and &quot;amd64_win64&quot; for amd
64-bit processors when those platforms are supported.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980978"></a><a
name="_Toc126872202"></a><a name="_Toc115417073"></a><a name="_Toc115416137">3.31.
Symlinks to AFS UNC paths</a></h2>

<p class=MsoNormal>In OpenAFS 1.4, symlinks to AFS UNC paths, \\AFS[\all]\...,
are treated the same as symlinks to /afs/...  However, please use /afs/... as
the Windows UNC form will not work on UNIX.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980979"></a><a
name="_Toc126872203"></a><a name="_Toc115417074"></a><a name="_Toc115416138">3.32.
Cache Manager Debugging Now Supported</a></h2>

<p class=MsoNormal>OpenAFS for Windows 1.4 implements the Cache Manager
Debugging RPC Interface.  The CM debugger can be queried with cmdebug.exe.</p>

<p class=PreformattedText>Usage: cmdebug -servers &lt;server machine&gt; [-port
&lt;IP port&gt;] [-long]</p>

<p class=PreformattedText>               [-addrs] [-cache] [-help]</p>

<p class=PreformattedText>Where: -long   print all info</p>

<p class=PreformattedText>       -addrs  print only host interfaces</p>

<p class=PreformattedText>       -cache  print only cache configuration</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980980"></a><a
name="_Toc126872204"></a><a name="_Toc115417075"></a><a name="_Toc115416139">3.33.
Windows Logon Caching vs. Kerberos Logons</a></h2>

<p class=MsoNormal>If you are a site which utilizes MIT/Heimdal Kerberos
principals to logon to Windows via a cross-realm relationship with a
multi-domain Windows forest, you must enable Windows logon caching unless the
workstation is Windows Vista Beta 2 or later.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980981"></a><a
name="_Toc126872205"></a><a name="_Toc115417076"></a><a name="_Toc115416140">3.34.
Initial Server Preferences</a></h2>

<p class=MsoNormal>VLDB and File Server Preferences can now be provided initial
values using registry keys.  This is useful for managed machines in a Windows
domain which are centrally located (e.g., in a computing lab.)  See <a
href="#_Appendix_A:_Registry_Values">Appendix A</a>
for details on the &quot;<a
href="#_Regkey:_[HKLMSOFTWAREOpenAFSClie_2">Server
Preferences</a>&quot; keys.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980982"></a><a
name="_Toc126872206"></a><a name="_Toc115417077"></a><a name="_Toc115416141">3.35.
File Timestamps</a></h2>

<p class=MsoNormal>OpenAFS 1.4 reports timestamps on files stored in AFS in UTC
all year round.  In locales with daylight savings time, previous versions of
AFS for Windows reported the time when DST is active as UTC+1.  This was done
to preserve the relative local time for the user.  A file stored at 11:00am EST
in January would be reported as having been stored at 11:00am EDT in June. 
Unfortunately, this has the negative side effect of changing the reported timestamp
from 16:00UTC to 15:00UTC.  Since Windows treats all file times in UTC, data
synchronization applications which rely on the timestamp would believe that all
files stored in AFS had changed.</p>

<p class=MsoNormal>It should be noted that UNIX based operating systems (such
as Solaris) do not appear to report file times to applications in UTC.  They do
preserve the relative local time.  This may confuse some users who are used to
being able to compare the timestamp in an UNIX shell with the timestamp from
the Windows explorer.  During DST, these two times will no longer agree even
though they are in fact representing the same moment in time.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980983"></a><a
name="_Toc126872207"></a><a name="_Toc115417078"></a><a name="_Toc115416142">3.36.
Windows RPC client support must be installed</a> </h2>

<p class=MsoNormal>If the installer refuses to install and complains about an
RPC configuration error, check to ensure that the following registry entries
are present and that they refer to the dll &quot;rpcrt4.dll&quot;:</p>

<p class=PreformattedText>   HKLM
&quot;SOFTWARE\Microsoft\RPC\ClientProtocols&quot; &quot;ncacn_np&quot;</p>

<p class=PreformattedText>   HKLM
&quot;SOFTWARE\Microsoft\RPC\ClientProtocols&quot; &quot;ncacn_ip_tcp&quot;</p>

<p class=PreformattedText>   HKLM &quot;SOFTWARE\Microsoft\RPC\ClientProtocols&quot;
&quot;ncadg_ip_udp&quot;</p>

<p class=PreformattedText>   HKLM
&quot;SOFTWARE\Microsoft\RPC\ClientProtocols&quot; &quot;ncacn_http&quot;</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980984"></a><a
name="_Toc126872208"></a><a name="_Toc115417079"></a><a name="_Toc115416143">3.37.
Generating Minidumps of the OpenAFS Client Service</a></h2>

<p class=MsoNormal>OpenAFS 1.4 adds a new command, &quot;fs minidump&quot;. 
This command can be used at any time to generate a mini dump file containing
the current stack of the afsd_service.exe process.   This output can be very
helpful when debugging the AFS Client Service when it is unresponsive to
SMB/CIFS requests.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980985"></a><a
name="_Toc126872209"></a><a name="_Toc115417080"></a><a name="_Toc115416144">3.38.
AFS Client Universally Unique Identifiers</a></h2>

<p class=MsoNormal>The OpenAFS for Windows 1.4 client implements Universally
Unique Identifiers (UUIDs).  They are used to provide the server with a method
of identifying the client that is independent of IP address.  The UUID is
generated when the AFSCache file is created and is maintained as long as the
contents of the AFSCache file are kept intact.  The UUID is stored in the
AFSCache file.   When cloning machines that have Windows AFS client installed,
the AFSCache files should be deleted as part of the cloning process.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980986">3.39. Delayed
Write Errors with Microsoft Office Applications</a></h2>

<p class=MsoBodyText>Microsoft Office makes heavy use of asynchronous
input/output methods for reading and writing to file streams.  This can result
in hundreds of requests being simultaneously queued for service by the CIFS client
with a fixed timeout period.  As the AFS CIFS server is local to the machine
the Windows CIFS client believes that it can respond almost instantaneously to
write requests as the actual writing to the AFS file server is performed by a
background daemon thread.  When the actual network bandwidth to the AFS file
server is slow and the file size is large it is possible for the CIFS client to
time out the connection.  When this happens a delayed write error will be
reported to the user and the application may crash.  The only workaround at the
current time is to save first to a local disk and subsequently copy the file to
AFS as copying a file with the explorer shell does not use asynchronous i/o.</p>

<p class=MsoBodyText>The CIFS session timeout defaults to 45 seconds and can be
increased by modifying the <a href="#_Value:_ConnDeadTimeout">registry</a>.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980987">3.40.
Global Drives (aka </a>Service Drive Letters) are no longer supported by
Microsoft</h2>

<p class=MsoBodyText>The Global DriveAuto-mount feature has been deprecated due
to the following Microsoft KB article.</p>

<p class=MsoBodyText style='text-indent:35.45pt'><a
href="http://msdn.microsoft.com/library/en-us/dllproc/base/services_and_redirected_drives.asp">http://msdn.microsoft.com/library/en-us/dllproc/base/services_and_redirected_drives.asp</a></p>

<p class=MsoBodyText>It says that services mounting drive letters are no longer
supported by Microsoft and may act unpredictably.  The experience other users
have had is that if the connection to the OpenAFS CIFS/SMB server is terminated
by the Windows CIFS client, the drive mapping may not be re-established until
the machine is rebooted.</p>

<p class=MsoBodyText>OpenAFS supports UNC paths and whenever possible
applications should be modified to use of \\AFS\&lt;cellname&gt;\&lt;path&gt;
instead of drive letters.</p>

<h1 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980988"></a><a
name="_Toc126872210"></a><a name="_Toc115417112"></a><a name="_Toc115417081"></a><a
name="_Toc115416145">4. How to Debug Problems with OpenAFS for Windows:</a></h1>

<p class=MsoNormal>OpenAFS for Windows provides a wide range of tools to assist
you in debugging problems.  The techniques available to you are varied because
of the wide range of issues that have been discovered over the years.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980989"></a><a
name="_Toc126872211"></a><a name="_Toc115417082"></a><a name="_Toc115416146">4.1.
pioctl debugging (</a><a
href="#_Value___: IoctlDebug">IoctlDebug</a>
registry key)</h2>

<p class=MsoNormal>pioctl (path-based ioctl) calls are used by various tools to
communicate with the AFS Client Service.  Some of the operations performed
include:</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setting/querying tokens  (tokens.exe, aklog.exe, afscreds.exe)</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setting/querying ACLs </p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setting/querying cache parameters</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>flushing files or volumes</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setting/querying server preferences</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>querying path location</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>checking the status of servers and volumes</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>setting/querying the sysname list</p>

<p class=MsoNormal>pioctl calls are implemented by writing to a special UNC
path that is processed by the AFS Client Service.   If there is a failure to
communicate with the AFS Client Service via SMB/CIFS, it will be impossible to
perform any of the above operations.   </p>

<p class=MsoNormal>To assist in debugging these problems, the registry value:</p>

<p class=PreformattedText>  [HKLM\SOFTWARE\OpenAFS\Client]</p>

<p class=PreformattedText>  REG_DWORD:  IoctlDebug   = 0x01</p>

<p class=MsoNormal>should be set.  Then any of the commands that perform pioctl
calls should be executed from the command prompt.  With this key set the pioctl
library will generate debugging output to stderr.  The output will contain the
Win32 API calls executed along with their most important parameters and their
return code.   The MSDN Library and the Microsoft KnowledgeBase can be used as
a reference to help you determine the configuration probem with your system.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980990"></a><a
name="_Toc126872212"></a><a name="_Toc115417083"></a><a name="_Toc115416147">4.2.
afsd_service initialization log (%WinDir%\TEMP\afsd_init.log)</a></h2>

<p class=MsoNormal>Every time the AFS Client Service starts it appends data
about its progress and configuration to a file.  This file provides information
crucial to determining why the service cannot start when there are problems. 
When the process terminates due to a panic condition it will write to this file
the source code file and line number of the error.  In many cases the panic
condition is due to a misconfiguration of the machine.  In other cases it might
be due to a programming error in the software.  A quick review of the location
in the source code will quickly reveal the reason for the termination.</p>

<p class=MsoNormal>The <i><a
href="#_Value___: MaxLogSize">MaxLogSize</a></i>
registry value determines the maximum size of the %WINDIR%\TEMP\afsd_init.log
file.  If the file is larger than this value when OpenAFS Client Service
starts, the file will be reset to 0 bytes.  If value is set to 0, the file will
be allowed to grow indefinitely.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980991"></a><a
name="_Toc126872213"></a><a name="_Toc115417084"></a><a name="_Toc115416148">4.3.
afsd_service debug logs (fs trace {-on, -off, -dump} -&gt;%WinDir%\TEMP\afsd.log)</a></h2>

<p class=MsoNormal>When attempting to debug the behavior of the SMB/CIFS Server
and the Cache Manager it is often useful to examine a log of the operations
being performed.  While running the AFS Client Service keeps an in memory log
of many of its actions.   The default number of actions preserved at any one
time is 5000.  This can be adjusted with the <a
href="#_Value_:_TraceBufferSize">registry value</a>:</p>

<p class=PreformattedText> 
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters]</p>

<p class=PreformattedText>  REG_DWORD  TraceBufferSize </p>

<p class=MsoNormal>A restart of the service is necessary when adjusting this
value.   Execute &quot;fs trace -on&quot; to clear to the log and &quot;fs
trace -dump&quot; to output the contents of the log to the file.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980992"></a><a
name="_Toc126872214"></a><a name="_Toc115417085"></a><a name="_Toc115416149">4.4.
Using SysInternals DbgView and FileMon Tools</a></h2>

<p class=MsoNormal>An alternatve option to the use of &quot;fs trace -dump&quot;
to capture internal OpenAFS Client Service events is to use a tool such as
Sysinternal's DbgView to capture real-time debugging output.  When the OpenAFS
Client Service starts and Bit 2 of the <a
href="#_Value__:_TraceOption">TraceOption</a>
value in the registry is set, all trace log events are output using the Windows
Debug Monitor interface (OutputDebugString).  </p>

<p class=PreformattedText> 
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters]</p>

<p class=PreformattedText style='text-indent:12.0pt'>REG_DWORD   TraceOption =
0x04</p>

<p class=MsoNormal>Use fs trace on and fs trace off to toggle the
generation of log messages. </p>

<p class=MsoNormal>Sysinternals FileMon utility can be use to monitor the file
operations requested by applications and their success or failure.   Use the
Volumes menu to restrict FileMon monitor to <i>Network</i> volumes only in
order to reduce the output to just the CIFS requests.  Turn on the <i>Advanced
Output</i> option in order to log with finer granularity.</p>

<p class=MsoNormal>Turn on the <i>Clock Time</i> and <i>Show Milliseconds</i> options
in both tools to make it easier to synchronize the application requests and the
resulting OpenAFS Client Service operations.   The captured data can be stored
to files for inclusion in <a href="#_5._Reporting_Bugs:">bug
reports</a>.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980993"></a><a
name="_Toc126872215"></a><a name="_Toc115417086"></a><a name="_Toc115416150">4.5.
Microsoft MiniDumps <br>
(fs minidump -&gt; %WinDir%\TEMP\afsd.dmp)</a></h2>

<p class=MsoNormal>If the AFS Client Service become unresponsive to any form of
communication there may be a serious error that can only be debugged by someone
with access to the source code and a debugger.   The &quot;fs minidump&quot;
command can be used to force the generation of a MiniDump file containing the
state of all of the threads in the AFS Client Service process.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980994"></a><a
name="_Toc126872216"></a><a name="_Toc115417087"></a><a name="_Toc115416151">4.6.
Single Sign-on (Integrated Logon) debugging</a></h2>

<p class=MsoNormal>If you are having trouble with the Integrated Logon
operations it is often useful to be able to obtain a log of what it is
attempting to do.   Setting Bit 0 of the <a
href="#_Value__:_TraceOption">TraceOption</a> registry
value:</p>

<p class=PreformattedText> 
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters]</p>

<p class=PreformattedText>  REG_DWORD   TraceOption = 0x01</p>

<p class=MsoNormal>will instruct the Integrated Logon Network Provider and
Event Handlers to log information to the Windows Event Log: Application under
the name AFS Logon&quot;.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980995"></a><a
name="_Toc126872217"></a><a name="_Toc115417088"></a><a name="_Toc115416152">4.7.
RX (AFS RPC) debugging (rxdebug)</a></h2>

<p class=MsoNormal>The rxdebug.exe tool can be used to query a variety of
information about the AFS services installed on a given machine.  The port for
the AFS Cache Manager is 7001.  </p>

<p class=PreformattedText>Usage: rxdebug -servers &lt;server machine&gt; [-port
&lt;IP port&gt;] [-nodally] </p>

<p class=PreformattedText style='margin-left:35.45pt;text-indent:35.45pt'>  
[-allconnections] [-rxstats] [-onlyserver] [-onlyclient] </p>

<p class=PreformattedText style='margin-left:70.9pt'>   [-onlyport &lt;show
only &lt;port&gt;&gt;] </p>

<p class=PreformattedText style='margin-left:70.9pt'>   [-onlyhost &lt;show
only &lt;host&gt;&gt;] </p>

<p class=PreformattedText style='margin-left:70.9pt'>   [-onlyauth &lt;show
only &lt;auth level&gt;&gt;] [-version] </p>

<p class=PreformattedText style='margin-left:70.9pt'>   [-noconns] [-peers]
[-help]</p>

<p class=PreformattedText>Where: -nodally         don't show dallying conns</p>

<p class=PreformattedText>       -allconnections  don't filter out
uninteresting connections</p>

<p class=PreformattedText>       -rxstats         show Rx statistics</p>

<p class=PreformattedText>       -onlyserver      only show server conns</p>

<p class=PreformattedText>       -onlyclient      only show client conns</p>

<p class=PreformattedText>       -version         show AFS version id</p>

<p class=PreformattedText>       -noconns         show no connections</p>

<p class=PreformattedText>       -peers           show peers</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980996"></a><a
name="_Toc126872218"></a><a name="_Toc115417089"></a><a name="_Toc115416153">4.8.
Cache Manager debugging (cmdebug)</a></h2>

<p class=MsoNormal>The cmdebug.exe tool can be used to query the state of the
AFS Cache Manager on a given machine.</p>

<p class=PreformattedText>Usage: cmdebug -servers &lt;server machine&gt; [-port
&lt;IP port&gt;] [-long] </p>

<p class=PreformattedText style='margin-left:70.9pt'>   [-refcounts]
[-callbacks] [-addrs] [-cache] [-help]</p>

<p class=PreformattedText>Where: -long       print all info</p>

<p class=PreformattedText>       -refcounts  print only cache entries with
positive reference counts</p>

<p class=PreformattedText>       -callbacks  print only cache entries with
callbacks</p>

<p class=PreformattedText>       -addrs      print only host interfaces</p>

<p class=PreformattedText>       -cache      print only cache configuration</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980997"></a><a
name="_Toc126872219"></a><a name="_Toc115417090"></a><a name="_Toc115416154">4.9.
Persistent Cache consistency check</a></h2>

<p class=MsoNormal>The persistent cache is stored in a Hidden System file at
%WinDir%\TEMP\AFSCache.  If there is a problem with the persistent cache that
prevent the AFS Client Service from being able to start a validation check on
the file can be performed.</p>

<p class=PreformattedText>  afsd_service.exe --validate-cache
&lt;cache-path&gt;</p>

<h1 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980998"></a><a
name="_Toc126872220"></a><a name="_Toc115417113"></a><a name="_Toc115417091"></a><a
name="_Toc115416155"></a><a name="_5._Reporting_Bugs:"></a>5. Reporting Bugs:</h1>

<p class=MsoNormal>Bug reports should be sent to <a
href="mailto:openafs-bugs@openafs.org?subject=Bug%20Report">openafs-bugs@openafs.org</a>. 
Please include as much information as possible about the issue.  If you are
reporting a crash, please install the debugging symbols by re-running the
installer.  If a dump file is available for the problem,
%WINDIR%\TEMP\afsd.dmp, include it along with the AFS Client Trace file 
%WINDIR%\TEMP\afsd.log.  The AFS Client startup log is
%WINDIR%\TEMP\afsd_init.log.  Send the last continuous block of  log
information from this file.</p>

<p class=MsoNormal>Configuring DrWatson to generate dump files for crashes:</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Run drwtsn32.exe to configure or to identify where the log and
the crash dump files are created: </p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>click Start &gt; Run...  </p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>type drwtsn32 &lt;enter&gt;. </p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Select either a Crash Dump Type: Mini or Full. </p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Clear Dump Symbol Table</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Clear Append to Existing Log file. </p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Check Dump All Thread Contexts.</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Check Create Crash Dump File</p>

<p class=MsoNormal style='margin-left:14.15pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Next run the monitoring module of Dr. Watson: </p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>click Start &gt; Run...</p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>type drwatson &lt;enter&gt;. </p>

<p class=MsoNormal style='margin-left:49.6pt;text-indent:-14.15pt'><span
style='font-size:9.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Once a crash happens, Dr. Watson generates a dump file and a
report in the log file, including the address of the crash and the stack dump.</p>

<p class=MsoNormal>Once you have the Dr. Watson's logfile and minidump, zip
them and attach them to your e-mail.</p>

<p class=MsoNormal>When reporting a error, please be sure to include the
version of OpenAFS.</p>

<h1 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139980999"></a><a
name="_Toc126872221"></a><a name="_Toc115417114"></a><a name="_Toc115417092"></a><a
name="_Toc115416156">6. How to Contribute to the Development of OpenAFS for
Windows</a></h1>

<p class=MsoNormal>Contributions to the development of OpenAFS for Windows are continuously
needed.  Contributions may take many forms including cash donations, support
contracts, donated developer time, and even donated tech writer time.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981000"></a><a
name="_Toc126872222"></a><a name="_Toc115417093"></a><a name="_Toc115416157">6.1.
The USENIX OpenAFS Fund</a> </h2>

<p class=MsoBodyText><a href="http://www.usenix.org/">USENIX</a>, a 501c3
non-profit corporation, has formed the USENIX OpenAFS Fund in order to accept
tax deductible donations on behalf of the OpenAFS Elders. The donated funds
will be allocated by the OpenAFS Elders to fund OpenAFS development,
documentation, project management, and maintaining openafs.org. </p>

<div>

<table cellspacing=0 cellpadding=0 hspace=0 vspace=0 width=540 height=88>
 <tr>
  <td valign=top align=left height=88 style='padding-top:0pt;padding-right:
  9.0pt;padding-bottom:0pt;padding-left:9.0pt'>
  <p class=MsoEnvelopeAddress>USENIX OpenAFS Fund<br>
  USENIX Association <br>
    2560 Ninth St., Suite 215 <br>
    Berkeley, CA 94710 </p>
  </td>
 </tr>
</table>

</div>

<br clear=ALL>

<p class=MsoBodyText>Donations can be made by sending a check, drawn on a U.S.
bank, made out to the USENIX OpenAFS Fund or by making a <a
href="https://db.usenix.org/cgi-bin/openafs/openafs.cgi">donation online</a>.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981001"></a><a
name="_Toc126872223"></a><a name="_Toc115417094">6.2. Secure Endpoints Inc.</a>
</h2>

<p class=MsoBodyText><a href="http://www.secure-endpoints.com/">Secure
Endpoints Inc.</a> provides development and support services for OpenAFS for
Windows and MIT Kerberos for Windows.  Donations provided to Secure Endpoints
Inc. for the development of OpenAFS are used to cover the OpenAFS gatekeeper
responsibilities; providing support to the OpenAFS community via the OpenAFS
mailing lists; and furthering development of desired features that are either
too small to be financed by development contracts.</p>

<p class=MsoBodyText>Secure Endpoints Inc. accepts software development
agreements from organizations who wish to fund a well-defined set of bug fixes
or new features. </p>

<p class=MsoBodyText>Secure Endpoints Inc. provides contract based support for
the OpenAFS for Windows and the MIT Kerberos for Windows products. </p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981002"></a><a
name="_Toc126872224"></a><a name="_Toc115417095">6.3. The MIT Kerberos Account</a>
</h2>

<p class=MsoNormal style='margin:0pt;margin-bottom:.0001pt;text-autospace:none'><span
style='font-family:"Times New Roman";color:black'>Th</span><span
class=BodyTextChar>e <a href="http://web.mit.edu/kerberos/">MIT Kerberos</a> development
team accepts unrestricted grants.  Grants are tax deductible and the full amount
of the grant will be used to fund the development of Kerberos 5 and/or Kerberos
for Windows.  OpenAFS for Windows is dependent on MIT Kerberos for Windows for
authentication and shares many of the same re</span><span style='font-family:
"Times New Roman";color:black'>quirements for credential management.  Future
releases of both products will share a common identity management user
interface. </span></p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981003"></a><a
name="_Toc126872225"></a><a name="_Toc115417096">6.4. Direct contributions of
code and/or documentation</a> </h2>

<p class=MsoBodyText>Organizations that use OpenAFS in house and have
development staffs are encouraged to contribute any code modifications they
make to OpenAFS.org via <u><span style='color:blue'>openafs-bugs@openafs.org</span></u>.
 Contributions of documentation are highly desired. </p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981004"></a><a
name="_Toc126872226"></a><a name="_Toc115417097">6.5. OpenAFS for Windows
Mailing Lists</a></h2>

<p class=MsoNormal>If you wish to participate in OpenAFS for Windows
development please join the <i><a
href="mailto:openafs-win32-devel@openafs.org?subject=OpenAFS%20for%20Windows%20Development%20Contribution">openafs-win32-devel@openafs.org</a></i>
mailing list.</p>

<p class=MsoNormal style='margin-left:35.45pt'><span class=MsoHyperlink>https://lists.openafs.org/mailman/listinfo/openafs-win32-devel</span></p>

<p class=MsoNormal>User questions should be sent to the <a
href="mailto:openafs-info@openafs.org?subject=OpenAFS%20for%20Windows%20User%20Question">openafs-info@openafs.org</a>
mailing list.  </p>

<p class=MsoNormal style='margin-left:35.45pt'><span class=MsoHyperlink>https://lists.openafs.org/mailman/listinfo/openafs-info</span></p>

<p class=MsoNormal>You must join the mailing lists if you wish to post to the
list without incurring a moderation delay.</p>

<h1 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981005"></a><a
name="_Toc126872227"></a><a name="_Toc115417115"></a><a name="_Toc115417098"></a><a
name="_Toc115416158"></a><a name="_MSI_Deployment_Guide"></a>7. MSI Deployment
Guide</h1>

</div>

<b><span style='font-size:16.0pt;font-family:Albany'><br clear=all
style='page-break-before:always'>
</span></b>

<div class=Section2>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981006"></a><a
name="_Toc126872228"></a><a name="_Toc115417099"></a><a name="_Toc115416159">7.1.
Introduction</a></h2>

<p class=MsoNormal>A MSI installer option is available for those who wish to
use Windows Installer for installing OpenAFS and for organizations that wish to
deploy OpenAFS through Group Policy.  The first version of OpenAFS for Windows
available as an MSI was 1.3.65.</p>

<p class=MsoNormal>This document provides a guide for authoring transforms used
to customize the MSI package for a particular organization.  Although many
settings can be deployed via transforms, in an Active Directory environment it
is advisable to deploy registry settings    and configuration files through
group policy and/or startup scripts so that machines where OpenAFS for Windows
is already installed will pick up these customizations.</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981007"></a><a
name="_Toc126872229"></a><a name="_Toc115416160">7.1.1 Requirements</a></h3>

<p class=MsoNormal>The information in this document applies to MSI packages
distributed with OpenAFS for Windows releases from 1.3.65 and onwards or MSI
packages built from corresponding source releases.  Not all releases support
all the configuration options documented here.</p>

<p class=MsoNormal>Authoring a &quot;Windows Installer&quot; transform requires
additional software for editing the MSI database tables and generating the
transform from the modified MSI package.  ORCA.EXE and MSITRAN.EXE which are
included in the Windows Platform SDK (&quot;Windows Installer&quot; SDK) can be
used for this purpose.</p>

<p class=MsoNormal>For reference, the schema for the MSI package is based on
SCHEMA.MSI distributed with the Platform SDK.</p>

<p class=MsoNormal>For general information about &quot;Windows Installer&quot;,
refer to:</p>

<p class=MsoNormal>    <a
href="http://msdn.microsoft.com/library/en-us/msi/setup/windows_installer_start_page.asp">http://msdn.microsoft.com/library/en-us/msi/setup/windows_installer_start_page.asp</a></p>

<p class=MsoNormal>For general information about authoring MSI transforms,
refer to:</p>

<p class=MsoNormal>    <a
href="http://msdn.microsoft.com/library/en-us/msi/setup/transforms.asp">http://msdn.microsoft.com/library/en-us/msi/setup/transforms.asp</a></p>

<p class=MsoNormal>The remainder of this document assumes some familiarity with
authoring transforms.  While the MSDN documentation for Windows Installer is a
bit dense, the guide on MSI transforms found at the second link above is
recommended reading.  MSDN also includes a step-by-step example for creating a
transform at:</p>

<p class=MsoNormal>    <a
href="http://msdn.microsoft.com/library/en-us/msi/setup/a_customization_transform_example.asp">http://msdn.microsoft.com/library/en-us/msi/setup/a_customization_transform_example.asp</a></p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981008"></a><a
name="_Toc126872230"></a><a name="_Toc115416161">7.1.2 Authoring a Transform</a></h3>

<p class=MsoNormal>Transforms describe a set of modifications to be performed
on an existing MSI for the purpose of customizing it.  This is ordinarily done
by making a copy of the MSI to be customized, modifying the copy and then using
the old and the new MSI to generate a transform.  For example:</p>

<p class=PreformattedText style='margin-left:36.0pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>copy openafs.msi
openafs-modified.msi</p>

<p class=PreformattedText style='margin-left:36.0pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>(edit the
openafs-modified.msi to include the necessary changes)</p>

<p class=PreformattedText style='margin-left:36.0pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>msitran -g
openafs.msi openafs-modified.msi openafs-transform.mst</p>

<p class=PreformattedText style='margin-left:36.0pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>(generates
openafs-transform.mst, which is the transform)</p>

<p class=MsoNormal>Transforms have an extension of .mst.  'msitran' is a tool
distributed as part of the &quot;Windows Installer&quot; SDK (part of the
Windows Platform SDK).</p>

<p class=MsoNormal>You can test a transform by:</p>

<p class=PreformattedText style='margin-left:36.0pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>copy openafs.msi
openafs-test.msi</p>

<p class=PreformattedText style='margin-left:36.0pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>msitran -a
openafs-transform.mst openafs-test.msi</p>

<p class=MsoNormal>and then checking the resulting openafs-test.msi to see if
all changes you have made above to openafs-modified.msi is present in
openafs-test.msi.  'msitran' will complain if some modification in the
transform can not be successfully applied.</p>

<p class=MsoNormal>As mentioned above, you can use a tool like ORCA.EXE to edit
the MSI databases directly when editing openafs-modified.msi.  More details are
given below.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981009"></a><a
name="_Toc126872231"></a><a name="_Toc115417100"></a><a name="_Toc115416162">7.2.
Configuration Options</a></h2>

<p class=MsoNormal>The logic necessary to implement many of the settings
described in <a
href="#_Appendix_A:_Registry_Values">Appendix A</a>
are present in the MSI.  Most of these can be controlled by setting the
corresponding properties to the desired value.  Some settings may require
modifying existing registry entries (though not recommended) or adding new
resources (like files or registry keys).  Instructions for performing these
tasks are below.</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981010"></a><a
name="_Toc126872232"></a><a name="_Toc115416163">7.2.1 Configurable Properties</a></h3>

<p class=MsoNormal>Most configurable properties correspond to registry keys or
values.  Due to the logic invoked based on the existence of these registry keys
or values, they are only set if the associated property is defined to have a
non null value.  If the associated property is not defined in the MSI, the
registry key or value will not be touched.  By default, the MSI does not
contain these properties and hence will not set the registry keys.  You will
need to add properties as needed to the MSI.</p>

<p class=MsoNormal>When one of the configurable properties is set, the
installer will use the property value to set the corresponding setting in the
HKEY_LOCAL_MACHINE registry hive.  The HKEY_CURRENT_USER hive is not touched by
the installer.</p>

<p class=MsoNormal>For each property, the associated registry setting is
referenced by the same text used in <a
href="#_Appendix_A:_Registry_Values">Appendix A</a>.</p>

<p class=MsoNormal>Strings are quoted using single quotes (e.g. 'a string'). An
empty string is denoted as ''.  Note that you can't author null values into the
'Property' table.</p>

<p class=MsoNormal>Numeric values should be authored as decimal strings.</p>

<h4><a name="_Toc139981011"></a><a name="_Toc126872233"></a><a
name="_Toc115416164">7.2.1.1 Setting Properties</a></h4>

<p class=MsoNormal>In order to set a property,</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:18.0pt;text-indent:-18.0pt'><span style='font-size:9.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Open the MSI in ORCA.EXE</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:18.0pt;text-indent:-18.0pt'><span style='font-size:9.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Select the 'Property' table from the list of tables on the left.</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:18.0pt;text-indent:-18.0pt'><span style='font-size:9.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Find the property in the list of properties on the right, double
click the value and type the new value.</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:18.0pt;text-indent:-18.0pt'><span style='font-size:9.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If the property does not exist in the property list, right click
the list and select 'Add Row', type the property name and the desired value.</p>

<h4><a name="_Toc139981012"></a><a name="_Toc126872234"></a><a
name="_Toc115416165">7.2.1.2 OpenAFS for Windows Properties</a></h4>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h5><a name="_Toc139981013"></a><a name="_Toc126872235"></a><a
  name="_Toc115416166"></a><a name="_(Service_parameters):"></a>(Service
  parameters):</h5>
  <p class=ListContents style='margin-left:0pt'>[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters]</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h5><a name="_Toc139981014"></a><a name="_Toc126872236"></a><a
  name="_Toc115416167"></a><a name="_(Network_provider):"></a>(Network
  provider):</h5>
  <p class=ListContents style='margin-left:0pt'>[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider]</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h5><a name="_Toc139981015"></a><a name="_Toc126872237"></a><a
  name="_Toc115416168"></a><a name="_(OpenAFS_Client):"></a>(OpenAFS Client):</h5>
  <p class=ListContents style='margin-left:0pt'>[HKLM\SOFTWARE\OpenAFS\Client]</p>
  </td>
 </tr>
</table>

<h5><a name="_Toc139981016"></a><a name="_Toc126872238"></a><a
name="_Toc115416169">7.2.1.2.1 Registry Properties</a></h5>

<p class=MsoNormal>These properties are used to set the values of registry
entries associated with OpenAFS for Windows.</p>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981017"></a><a name="_Toc126872239"></a><a
  name="_Toc115416170">AFSCACHEPATH</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value_:_CachePath">CachePath</a></p>
  <p class=MsoList>Valid values    : string .</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981018"></a><a name="_Toc126872240"></a><a
  name="_Toc115416171">AFSCACHESIZE</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value___: CacheSize">CacheSize</a></p>
  <p class=MsoList>Valid values    : numeric</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981019"></a><a name="_Toc126872241"></a><a
  name="_Toc115416172">AFSCELLNAME</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value_:_Cell">Cell</a></p>
  <p class=MsoList>Valid values    : string</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981020"></a><a name="_Toc126872242"></a><a
  name="_Toc115416173">FREELANCEMODE</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value_:_FreelanceClient">FreelanceClient</a></p>
  <p class=MsoList>Valid values    : '1' or '0'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981021"></a><a name="_Toc126872243"></a><a
  name="_Toc115416174">HIDEDOTFILES</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value_:_HideDotFiles">HideDotFiles</a></p>
  <p class=MsoList>Valid values    : '1' or '0'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981022"></a><a name="_Toc126872244"></a><a
  name="_Toc115416175">LOGONOPTIONS</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Network_provider):">(Network
  provider)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value___: LogonOptions">LogonOptions</a></p>
  <p class=MsoList>Valid values    : '0', '1' or '3'</p>
  <p class=MsoNormal>See <a
  href="#_Appendix_A:_Registry_Values">Appendix
  A</a> <a
  href="#_A.2.1_Domain_specific_configuration">section
  2.1 (Domain specific configuration keys for Network Provider)</a> for more
  details.</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981023"></a><a name="_Toc126872245"></a><a
  name="_Toc115416176">MOUNTROOT</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value_:_Mountroot">Mountroot</a></p>
  <p class=MsoList>Valid values    : string</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981024"></a><a name="_Toc126872246"></a><a
  name="_Toc115416177">NETBIOSNAME</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value___: NetbiosName">NetbiosName</a></p>
  <p class=MsoList>Valid values    : string (at most 15 characters)</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981025"></a><a name="_Toc126872247"></a><a
  name="_Toc115416178">NOFINDLANABYNAME</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value___: NoFindLanaByName">NoFindLanaByName</a></p>
  <p class=MsoList>Valid values    : '1' or '0'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981026"></a><a name="_Toc126872248"></a><a
  name="_Toc115416179">RXMAXMTU</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value_:_RxMaxMTU">RxMaxMTU</a></p>
  <p class=MsoList>Valid values    : numeric</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981027"></a><a name="_Toc126872249"></a><a
  name="_Toc115416180">SECURITYLEVEL</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value_:_SecurityLevel">SecurityLevel</a></p>
  <p class=MsoList>Valid values    : '1' or '0'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981028"></a><a name="_Toc126872250"></a><a
  name="_Toc115416181">SMBAUTHTYPE</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value___: smbAuthType">SMBAuthType</a></p>
  <p class=MsoList>Valid values    : '0','1' or '2'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981029"></a><a name="_Toc126872251"></a><a
  name="_Toc115416182">STOREANSIFILENAMES</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(OpenAFS_Client):">(OpenAFS Client)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value___: StoreAnsiFilenames">StoreAnsiFilenames</a></p>
  <p class=MsoList>Valid values    : '0' or '1'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981030"></a><a name="_Toc126872252"></a><a
  name="_Toc115416183">USEDNS</a></h6>
  <p class=MsoList>Registry key    : <a
  href="#_(Service_parameters):">(Service
  parameters)</a></p>
  <p class=MsoList>Registry value : <a
  href="#_Value_:_UseDNS">UseDNS</a></p>
  <p class=MsoList>Valid values    : '1' or '0'</p>
  </td>
 </tr>
</table>

<h5><a name="_Toc139981031"></a><a name="_Toc126872253"></a><a
name="_Toc115416184"></a><a name="_7.2.1.2.2_AFSCreds.exe_Properties"></a>7.2.1.2.2
AFSCreds.exe Properties</h5>

<p class=MsoNormal>These properties are combined to add a command line option
to the shortcut that will be created in the Start:Programs:OpenAFS and
Start:Programs:Startup folders (see CREDSSTARTUP).  The method of specifying
the option was chosen for easy integration with the Windows Installer user
interface.  Although other methods can be used to specify options to
AFSCREDS.EXE, it is advised that they be avoided as transforms including such
options may not apply to future releases of OpenAFS.</p>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981032"></a><a name="_Toc126872254"></a><a
  name="_Toc115416185">CREDSSTARTUP</a></h6>
  <p class=MsoList>Valid values    : '1' or '0'</p>
  <p class=MsoList>Controls whether AFSCreds.exe starts up automatically when the
  user logs on.  When CREDSSTARTUP is '1' a shortcut is added to the 'Startup'
  folder in the 'Program menu' which starts AFSCREDS.EXE with the options that
  are determined by the other CREDS* properties.</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981033"></a><a name="_Toc126872255"></a><a
  name="_Toc115416186">CREDSAUTOINIT</a></h6>
  <p class=MsoList>Valid values    : '-a' or ''</p>
  <p class=MsoList>Enables automatic initialization.</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981034"></a><a name="_Toc126872256"></a><a
  name="_Toc115416187">CREDSIPCHDET</a></h6>
  <p class=MsoList>Valid values    : '-n' or ''</p>
  <p class=MsoList>Enables IP address change detection.</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981035"></a><a name="_Toc126872257"></a><a
  name="_Toc115416188">CREDSQUIET</a></h6>
  <p class=MsoList>Valid values    : '-q' or ''</p>
  <p class=MsoList>Enables quiet mode.</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981036"></a><a name="_Toc126872258"></a><a
  name="_Toc115416189">CREDSRENEWDRMAP</a></h6>
  <p class=MsoList>Valid values    : '-m' or '</p>
  <p class=MsoList>Enables renewing drive map at startup.</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h6><a name="_Toc139981037"></a><a name="_Toc126872259"></a><a
  name="_Toc115416190">CREDSSHOW</a></h6>
  <p class=MsoList>Valid values    : '-s' or ''</p>
  <p class=MsoList>Enables displaying the credential manager window when
  AFSCREDS starts up.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981038"></a><a
name="_Toc126872260"></a><a name="_Toc115416191">7.2.2 Existing Registry
Entries</a></h3>

<p class=MsoNormal>You can change existing registry values subject to the
restrictions mentioned in the Windows Platform SDK.  Pay special attention to
component key paths and try to only change the 'Value' column in the 'Registry'
table.  If you want to add additional registry keys please refer to section 3
(Additional resources).</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981039"></a><a
name="_Toc126872261"></a><a name="_Toc115416192">7.2.3 Replacing Configuration
Files</a></h3>

<p class=MsoNormal>The OpenAFS configuration files (CellServDB) can be replaced
by your own configuration files.  These files are contained in separate MSI
components so that you can disable them individually.</p>

<p class=MsoNormal>The recommended method for replacing these files is to first
disable the components containing the configuration files that you want to
replace, and then add new components for the replacement files.  This is
outlined below (assuming you are using ORCA.EXE to author the transform).</p>

<p class=MsoNormal>Note that transforms are not a good way to add a new file as
an embedded stream.  The method outlined here places the file in the same
directory as the MSI for deployment.</p>

<p class=MsoNormal>The walkthrough below is to add a custom 'CellServDB' file.</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:18.0pt;text-indent:-18.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Disable the component that contains the configuration file that you want
to replace.</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:39.6pt;text-indent:-21.6pt'>1.1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span>Locate and select the 'Component' table in the 'Tables' list.</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:39.6pt;text-indent:-21.6pt'>1.2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span>In the Component table, locate the component you need to change ( Ctrl-F
invokes the 'Find' dialog).  The component names are listed below in section <a
href="#_2.3.1_Components_for_Configuration ">7.2.3.1</a>. 
For this example, the component name is 'elf_CellServDB'.</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:39.6pt;text-indent:-21.6pt'>1.3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span>Go to the 'Condition' column of the component.</p>

<p class=MsoNormal style='margin-top:4.3pt;margin-right:0pt;margin-bottom:4.3pt;
margin-left:39.6pt;text-indent:-21.6pt'>1.4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span>Enter a condition that evaluates to false. I.e. 'DONOTINSTALL'. (Note
that an undefined property always evaluates to false).</p>

<p class=MsoNormal>Note that you can also use this step to disable other
configuration files without providing replacements.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Add
a new component containing the new configuration file.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>2.1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Select the 'Component'
table in the 'Tables' list.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>2.2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Select
'Tables'-&gt;'Add Row' (Ctrl-R).</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>2.3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Enter the following :</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:39.35pt;border-collapse:collapse;border:none'>
 <tr style='height:23.35pt'>
  <td width=115 valign=top style='width:86.25pt;border:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt;height:23.35pt'>
  <p class=PreformattedText>Component</p>
  </td>
  <td width=475 valign=top style='width:356.55pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0pt 5.4pt 0pt 5.4pt;height:23.35pt'>
  <p class=PreformattedText>cmf_my_CellServDB</p>
  </td>
 </tr>
 <tr>
  <td width=115 valign=top style='width:86.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>ComponentID</p>
  </td>
  <td width=475 valign=top style='width:356.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>{7019836F-BB2C-4AF6-9463-0D6EC9035CF1}</p>
  </td>
 </tr>
 <tr>
  <td width=115 valign=top style='width:86.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Directory_</p>
  </td>
  <td width=475 valign=top style='width:356.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>dirClient</p>
  </td>
 </tr>
 <tr>
  <td width=115 valign=top style='width:86.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Attributes</p>
  </td>
  <td width=475 valign=top style='width:356.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>144</p>
  </td>
 </tr>
 <tr>
  <td width=115 valign=top style='width:86.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Condition</p>
  </td>
  <td width=475 valign=top style='width:356.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=115 valign=top style='width:86.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>KeyPath</p>
  </td>
  <td width=475 valign=top style='width:356.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>fil_my_CellServDB</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:35.45pt'>Note that the ComponentId is an
uppercase GUID.  You can generate one using GUIDGEN.EXE or UUIDGEN.EXE, both of
which are included in the Platform SDK.</p>

<p class=MsoNormal style='margin-left:35.45pt'>The Attributes value of 144 is a
sum of msidbComponentAttributesPermanent (16) and
msidbComponentAttributesNeverOverwrite (128).  This ensures that local
modifications are not overwritten or lost during an installation or
uninstallation.  These are the same settings used on the default configuration
files.</p>

<p class=MsoNormal>            'fil_my_CellServDB' is a key into the 'File'
table which we will fill later.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Add
a new feature to hold the new component.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>3.1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Select the 'Feature'
table.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>3.2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Add a new row (Ctrl-R
or 'Tables'-&gt;'Add Row') with the following values:</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:40.1pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=126 valign=top style='width:94.8pt;border:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Feature</p>
  </td>
  <td width=462 valign=top style='width:346.2pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>fea_my_CellServDB</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.8pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Feature_Parent</p>
  </td>
  <td width=462 valign=top style='width:346.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>feaClient</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.8pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Title</p>
  </td>
  <td width=462 valign=top style='width:346.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.8pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Description</p>
  </td>
  <td width=462 valign=top style='width:346.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.8pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Display</p>
  </td>
  <td width=462 valign=top style='width:346.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>0</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.8pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Level</p>
  </td>
  <td width=462 valign=top style='width:346.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>30</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.8pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Directory_</p>
  </td>
  <td width=462 valign=top style='width:346.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.8pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Attributes</p>
  </td>
  <td width=462 valign=top style='width:346.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>8</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:35.45pt'>It is important to create the
new feature under the 'feaClient' feature, which will ensure that the configuration
file will be installed when the client binaries are installed.</p>

<p class=MsoNormal style='margin-left:35.45pt'>Setting 'Display' to 0 will hide
this feature from the feature selection dialog during an interactive installation. 
A value of 30 for 'Level' allows this feature to be installed by default (on a
'Typical' installation).</p>

<p class=MsoNormal style='margin-left:35.45pt'>The 'Attributes' value is msidbFeatureAttributesDisallowAdvertise
(8), which is set on all features in the OpenAFS MSI.  The OpenAFS MSI is not designed
for an advertised installation.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Join
the component and the feature.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>4.1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Select the
'FeatureComponents' table.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>4.2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Add a new row with the
following values:</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:40.1pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Feature</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>fea_my_CellServDB</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Component</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>cmf_my_CellServDB</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Add
an entry to the 'File' table.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>5.1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Select the 'File'
table.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>5.2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Add a new row with the
following values:</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:40.1pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>File</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>fil_my_CellServDB</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Component_</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>cmf_my_CellServDB</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>FileName</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>CellServDB</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>FileSize</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>(enter file size here)</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Attributes</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>8192</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>Sequence</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>1000</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>                (leave other fields blank)</p>

<p class=MsoNormal style='margin-left:35.45pt'>The 'Attributes' value is
msidbFileAttributesNonCompressed (8192).  This is because we will be placing
this file in the same directory as the MSI instead of embedding the file in
it.  Transforms do not support updating compressed sources or adding new
cabinet streams.</p>

<p class=MsoNormal style='margin-left:35.45pt'>Finally, the 'Sequence' value of
1000 will be used later to distinguish the file as being in a separate source location
than the other files in the MSI.</p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Set
a media source for the file.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>6.1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Select the 'Media'
table.</p>

<p class=MsoNormal style='margin-left:39.6pt;text-indent:-21.6pt'>6.2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Add a row with the
following values :</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:40.1pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>DiskId</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>2</p>
  </td>
 </tr>
 <tr>
  <td width=126 valign=top style='width:94.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>LastSequence</p>
  </td>
  <td width=462 valign=top style='width:346.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=PreformattedText>1000</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>                (leave other fields blank)</p>

<p class=MsoNormal style='margin-left:35.45pt'>The sequence number of 1000
designates this as the media source for the newly added file.</p>

<h4><a name="_Toc139981040"></a><a name="_Toc126872262"></a><a
name="_Toc115416193"></a><a name="_2.3.1_Components_for_Configuration "></a>7.2.3.1
Components for Configuration Files</h4>

<p class=PreformattedText style='text-indent:35.45pt'>CellServDB:
'cpf_CellServDB' (ID {D5BA4C15-DBEC-4292-91FC-B54C30F24F2A})</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981041"></a><a
name="_Toc126872263"></a><a name="_Toc115416194">7.2.4 Adding Domain Specific
Registry Keys</a></h3>

<p class=MsoNormal>Following is an example for adding domain specific registry
keys.</p>

<p class=MsoNormal>    Refer to <a
href="#_Appendix_A:_Registry_Values">Appendix A</a>
section 2.1 for more information.</p>

<p class=MsoNormal>    Columns that are unspecified should be left empty.</p>

<p class=MsoNormal>    We create a new feature and component to hold the new
registry keys.</p>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>    'Feature' table:</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Feature            : 'feaDomainKeys'<br>
            Feature Parent : 'feaClient'<br>
            Display           : 0<br>
            Level               : 30<br>
            Attributes        : 10</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>    'Component' table:</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
              Component     : 'rcm_DomainKeys'<br>
            ComponentId  : '{4E3FCBF4-8BE7-40B2-A108-C47CF743C627}'<br>
            Directory         : 'TARGETDIR'<br>
            Attributes        : 4<br>
            KeyPath          : 'reg_domkey0'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>    'FeatureComponents' table:</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Feature            : 'feaDomainKeys'<br>
            Component     : 'rcm_DomainKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>    'Registry' table:</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_domkey0'<br>
            Root                : 2<br>
            Key                 :
  'SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain'<br>
            Component     : 'rcm_DomainKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_domkey1'<br>
            Root                : 2<br>
            Key                 : 'SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain'<br>
            Name              : '*'<br>
            Component     : 'rcm_DomainKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_domkey2'<br>
            Root                : 2<br>
            Key                 :
  'SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\ATHENA.MIT.EDU'<br>
            Name              : '*'<br>
            Component     : 'rcm_DomainKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_domkey3'<br>
            Root                : 2<br>
            Key                 :
  'SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\ATHENA.MIT.EDU'<br>
            Name              : 'LogonOptions'<br>
            Value              : 1<br>
            Component     : 'rcm_DomainKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_domkey4'<br>
            Root                : 2<br>
            Key                 : SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\LOCALHOST'<br>
            Name              : '*'<br>
            Component     : 'rcm_DomainKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_domkey5'<br>
            Root                : 2<br>
            Key                 : 'SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\LOCALHOST'<br>
            Name              : 'LogonOptions'<br>
            Value              : 0<br>
            Component     : 'rcm_DomainKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_domkey6'<br>
            Root                : 2<br>
            Key                 :
  'SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\LOCALHOST'<br>
            Name              : 'FailLoginsSilently'<br>
            Value              : 1<br>
            Component     : 'rcm_DomainKeys'<br>
  <br>
  </p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The example adds domain specific keys for 'ATHENA.MIT.EDU'
(enable integrated logon) and 'LOCALHOST' (disable integrated logon and fail
logins silently).</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981042"></a><a
name="_Toc126872264"></a><a name="_Toc115416195">7.2.5 Adding Site Specific
Freelance Registry Keys</a></h3>

<p class=MsoNormal>Following is an example for adding site specific Freelance
registry keys to pre-populate the Mountpoints and Symlinks in the fake root.afs
volume.</p>

<p class=MsoNormal>    Columns that are unspecified should be left empty.</p>

<p class=MsoNormal>    We create a new feature and component to hold the new
registry keys.</p>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>    'Feature' table:</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Feature            : 'feaFreelanceKeys'<br>
            Feature Parent : 'feaClient'<br>
            Display           : 0<br>
            Level               : 30<br>
            Attributes        : 10</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>    'Component' table:</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
              Component     : 'rcm_FreelanceKeys'<br>
            ComponentId  : '{4E3B3CBF4-9AE7-40C3-7B09-C48CF842C583}'<br>
            Directory         : 'TARGETDIR'<br>
            Attributes        : 4<br>
            KeyPath          : 'reg_freekey0'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>    'FeatureComponents' table:</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Feature            : 'feaFreelanceKeys'<br>
            Component     : 'rcm_FreelanceKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>    'Registry' table:</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_freekey0'<br>
            Root                : 2<br>
            Key                 : 'SOFTWARE\OpenAFS\Client\Freelance'<br>
            Component     : 'rcm_FreelanceKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_freekey1'<br>
            Root                : 2<br>
            Key                 : 'SOFTWARE\OpenAFS\Client\Freelance'<br>
            Name              : '0'<br>
              Value              : 'athena.mit.edu#athena.mit.edu:root.cell.'<br>
            Component     : 'rcm_FreelanceKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_freekey2'<br>
            Root                : 2<br>
            Key                 : 'SOFTWARE\OpenAFS\Client\Freelance'<br>
            Name              : '1'<br>
              Value              : '.athena.mit.edu%athena.mit.edu:root.cell.'<br>
            Component     : 'rcm_FreelanceKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_freekey3'<br>
            Root                : 2<br>
            Key                 : 'SOFTWARE\OpenAFS\Client\Freelance\Symlinks'<br>
            Component     : 'rcm_FreelanceKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_freekey4'<br>
            Root                : 2<br>
            Key                 : 'SOFTWARE\OpenAFS\Client\Freelance\Symlinks'<br>
            Name              : '0'<br>
              Value              : 'athena:athena.mit.edu.'<br>
            Component     : 'rcm_FreelanceKeys'</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <p class=MsoNormal>            (new row)<br>
            Registry          : 'reg_freekey5'<br>
            Root                : 2<br>
            Key                 : 'SOFTWARE\OpenAFS\Client\Freelance\Symlinks'<br>
            Name              : '1'<br>
              Value              : '.athena:.athena.mit.edu.'<br>
            Component     : 'rcm_FreelanceKeys'</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>The example adds a read-only mountpoint to the
athena.mit.edu cell's root.afs volume as well as a read-write mountpoint. 
Aliases are also provided using symlinks.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981043"></a><a
name="_Toc126872265"></a><a name="_Toc115417101"></a><a name="_Toc115416196"></a><a
name="_Ref115275867">7.3 Additional Resources</a></h2>

<p class=MsoNormal>If you want to add registry keys or files you need to create
new components and features for those.  Refer to the Windows Platform SDK for
details.</p>

<p class=MsoNormal>It is beyond the scope of this document to provide a
comprehensive overview of how to add new resources through a transform.  Please
refer to the &quot;Windows Installer&quot; documentation for details.  The relevant
section is at :</p>

<p class=MsoNormal>http://msdn.microsoft.com/library/en-us/msi/setup/using_transforms_to_add_resources.asp</p>

<p class=MsoNormal>A sample walkthrough of adding a new configuration file is
in section 2.3.</p>

<p class=MsoNormal>Add new features under the 'feaClient' or 'feaServer' as appropriate
and set the 'Level' column for those features to equal the 'Level' for their
parent features for consistency.  Note that none of the features in the OpenAFS
for Windows MSI package are designed to be installed to run from 'source' or
'advertised'.  It is recommended that you set
'msidbFeatureAttributesFavorLocal' (0), 'msidbFeatureAttributesFollowParent'
(2) and 'msidbFeatureAttributesDisallowAdvertise' (8) attributes for new features.</p>

<p class=MsoNormal>If you are creating new components, retain the same
component GUID when creating new transforms against new releases of the OpenAFS
MSI package.</p>

<p class=MsoNormal>After making the adjustments to the MSI database using
ORCA.EXE you can generate a transform with MSITRAN.EXE as follows :</p>

<p class=MsoNormal>(Modified MSI package is 'openafs-en_US_new.msi' and the
original MSI package is 'openafs-en_US.msi'.  Generates transform 'openafs-transform.mst')</p>

<p class=MsoNormal>    &gt; msitran.exe -g openafs-en_US.msi
openafs-en_US_new.msi openafs-transform.mst</p>

<p class=MsoNormal>See the Platform SDK documentation for information on
command line options for MSITRAN.EXE.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981044"></a><a
name="_Toc126872266"></a><a name="_Toc115417102"></a><a name="_Toc115416197">7.4.
Upgrades</a></h2>

<p class=MsoNormal>The MSI package is designed to uninstall previous versions
of OpenAFS for Windows during installation.  Note that it doesn't directly
upgrade an existing installation.  This is intentional and ensures that
development releases which do not have strictly increasing version numbers are
properly upgraded.</p>

<p class=MsoNormal>Versions of OpenAFS that are upgraded by the MSI package are:</p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'>1)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OpenAFS
MSI package<br>
Upgrade code {6823EEDD-84FC-4204-ABB3-A80D25779833}<br>
Up to current release</p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'>2)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MIT's
Transarc AFS MSI package<br>
Upgrade code {5332B94F-DE38-4927-9EAB-51F4A64193A7}<br>
Up to version 3.6.2</p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt'>3)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OpenAFS
NSIS package<br>
All versions</p>

<p class=MsoNormal>Note that versions of the OpenAFS NSIS package prior to 1.3.65
had a bug where it couldn't be uninstalled properly in unattended mode. 
Therefore the MSI package will not try to uninstall an OpenAFS NSIS package if
running unattended.  This means that group policy based deployments will fail
on machines that have the OpenAFS NSIS package installed.</p>

<p class=MsoNormal>If you have used a different MSI package to install OpenAFS
and wish to upgrade it you can author rows into the 'Upgrade' table as described
in the Platform SDK.</p>

<p class=MsoNormal>When performing an upgrade with msiexec.exe execute the MSI
with the repair options &quot;vomus&quot;.</p>

<h1 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981045"></a><a
name="_Toc126872267"></a><a name="_Toc115417116"></a><a name="_Toc115417103"></a><a
name="_Toc115416198"></a><a name="_Appendix_A:_Registry_Values"></a>Appendix A:
Registry Values</h1>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981046"></a><a
name="_Toc126872268"></a><a name="_Toc115417104"></a><a name="_Toc115416199">A.1.
Service parameters</a></h2>

<p class=MsoBodyText>The service parameters primarily affect the behavior of
the AFS client service (afsd_service.exe).</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981047"></a><a
name="_Toc126872269"></a><a name="_Toc115416200">Regkey:<br>
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:145.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:145.25pt'>
  <h5><a name="_Toc139981048"></a><a name="_Toc126872270"></a><a
  name="_Toc115416201">Value: LANadapter</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: -1<br>
  Variable: LANadapter</p>
  <p class=MsoBodyText>LAN adapter number to use.  This is the lana number of
  the LAN adapter that the SMB server should bind to.  If unspecified or set to
  -1, a LAN adapter with named 'AFS' or a loopback adapter will be selected. 
  If neither are present, then all available adapters will be bound to.  When
  binding to a non-loopback adapter, the NetBIOS name hostname%-AFS' will be
  used (where %hostname% is the NetBIOS name of the host truncated to 11 characters).
  Otherwise, the NetBIOS name will be 'AFS'.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981049"></a><a name="_Toc126872271"></a><a
  name="_Toc115416202"></a><a name="_Value___: CacheSize"></a>Value: CacheSize</h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 98304 (CM_CONFIGDEFAULT_CACHESIZE)<br>
  Variable: cm_initParams.cacheSize</p>
  <p class=MsoBodyText>Size of the AFS cache in 1k blocks.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981050"></a><a name="_Toc126872272"></a><a
  name="_Toc115416203">Value: ChunkSize</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 17 (CM_CONFIGDEFAULT_CHUNKSIZE)<br>
  Variable: cm_logChunkSize (cm_chunkSize = 1 &lt;&lt; cm_logChunkSize)</p>
  <p class=MsoBodyText>Size of chunk for reading and writing. Actual chunk size
  is 2^cm_logChunkSize.</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981051"></a><a name="_Toc126872273"></a><a
  name="_Toc115416204">Value: Daemons</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 2 (CM_CONFIGDEFAULT_DAEMONS)<br>
  Variable: numBkgD</p>
  <p class=MsoBodyText>Number of background daemons (number of threads of
  cm_BkgDaemon). (see cm_BkgDaemon in cm_daemon.c)</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981052"></a><a name="_Toc126872274"></a><a
  name="_Toc115416205">Value: ServerThreads</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 25 (CM_CONFIGDEFAULT_SVTHREADS)<br>
  Variable: numSvThreads</p>
  <p class=MsoBodyText>Number of SMB server threads (number of threads of
  smb_Server). (see smb_Server in smb.c).</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981053"></a><a name="_Toc126872275"></a><a
  name="_Toc115416206">Value: Stats</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 10000 (CM_CONFIGDEFAULT_STATS)<br>
  Variable: cm_initParams.nStatCaches</p>
  <p class=MsoBodyText>Cache configuration.</p>
  </td>
 </tr>
 <tr style='height:78.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:78.5pt'>
  <h5><a name="_Toc139981054"></a><a name="_Toc126872276"></a><a
  name="_Toc115416207"></a><a name="_Value_:_LogoffPreserveTokens"></a>Value:
  LogoffPreserveTokens</h5>
  <p class=MsoBodyText>Type: DWORD {1,0}<br>
  Default : 0</p>
  <p class=MsoBodyText>If enabled (set to 1), the Logoff Event handler will not
  attempt to delete the user's tokens  if the user's profile is stored outside
  of AFS.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981055"></a><a name="_Toc126872277"></a><a
  name="_Toc115416208">Value: RootVolume</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &quot;root.afs&quot;<br>
  Variable: cm_rootVolumeName</p>
  <p class=MsoBodyText>Root volume name.</p>
  </td>
 </tr>
 <tr style='height:145.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:145.25pt'>
  <h5><a name="_Toc139981056"></a><a name="_Toc126872278"></a><a
  name="_Toc115416209"></a><a name="_Value_:_Mountroot"></a>Value: Mountroot</h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &quot;/afs&quot;<br>
  Variable: cm_mountRoot</p>
  <p class=MsoBodyText>Name of root mount point.  In symlinks, if a path starts
  with cm_mountRoot, it is assumed that the path is absolute (as opposed to
  relative) and is adjusted accordingly. Eg: if a path is specified as
  /afs/athena.mit.edu/foo/bar/baz and cm_mountRoot is &quot;/afs&quot;, then
  the path is interpreted as \\afs\all\athena.mit.edu\foo\bar\baz.  If a path
  does not start with with cm_mountRoot, the path is assumed to be relative and
  suffixed to the reference directory (i.e. directory where the symlink exists)</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981057"></a><a name="_Toc126872279"></a><a
  name="_Toc115416210"></a><a name="_Value_:_CachePath"></a>Value: CachePath</h5>
  <p class=MsoBodyText>Type: REG_SZ or REG_EXPAND_SZ<br>
  Default: &quot;%TEMP%\AFSCache&quot;<br>
  Variable: cm_CachePath</p>
  <p class=MsoBodyText>Location of on-disk cache file.  The default is the
  SYSTEM account's TEMP directory.  The attributes assigned to the file are
  HIDDEN and SYSTEM.</p>
  </td>
 </tr>
 <tr style='height:119.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:119.0pt'>
  <h5><a name="_Toc139981058"></a><a name="_Toc126872280"></a><a
  name="_Toc115416211">Value: NonPersistentCaching</a></h5>
  <p class=MsoBodyText>Type: DWORD [0..1]<br>
  Default: 0<br>
  Variable: buf_CacheType</p>
  <p class=MsoBodyText>When this registry value is set to a non-zero value, the
  CachePath value is ignored and the cache data is stored in the windows paging
  file.  This prevents the use of persistent caching (when available) as well
  as the ability to alter the size of the cache at runtime using the &quot;fs
  setcachesize&quot; command.</p>
  </td>
 </tr>
 <tr style='height:125.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:125.5pt'>
  <h5><a name="_Toc139981059"></a><a name="_Toc126872281"></a><a
  name="_Toc115416212">Value: ValidateCache</a></h5>
  <p class=MsoBodyText>Type: DWORD [0..2]<br>
  Default: 1<br>
  Variable: buf_CacheType</p>
  <p class=MsoBodyText>This value determines if and when persistent cache
  validation is performed.</p>
  <p class=MsoBodyText>0 - Validation is disabled<br>
  1 - Validation is performed at startup<br>
  2 - Validation is performed at shutdown</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981060"></a><a name="_Toc126872282"></a><a
  name="_Toc115416213">Value: TrapOnPanic</a></h5>
  <p class=MsoBodyText>Type: DWORD {1,0}<br>
  Default: 0<br>
  Variable: traceOnPanic</p>
  <p class=MsoBodyText>Issues a breakpoint in the event of a panic.
  (breakpoint: _asm int 3).</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981061"></a><a name="_Toc126872283"></a><a
  name="_Toc115416214"></a><a name="_Value___: NetbiosName"></a>Value: NetbiosName</h5>
  <p class=MsoBodyText>Type: REG_EXPAND_SZ<br>
  Default: &quot;AFS&quot;<br>
  Variable: cm_NetbiosName</p>
  <p class=MsoBodyText>Specifies the NetBIOS name to be used when binding to a
  Loopback adapter.  To provide the old behavior specify a value of 
  &quot;%COMPUTERNAME%-AFS&quot;.</p>
  </td>
 </tr>
 <tr style='height:152.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:152.0pt'>
  <h5><a name="_Toc139981062"></a><a name="_Toc126872284"></a><a
  name="_Toc115416215">Value: IsGateway</a></h5>
  <p class=MsoBodyText>Type: DWORD {1,0}<br>
  Default: 0<br>
  Variable: isGateway</p>
  <p class=MsoBodyText>Select whether or not this AFS client should act as a
  gateway.  If set and the NetBIOS name hostname-AFS is bound to a physical
  NIC, other machines in the subnet can access AFS via SMB connections to
  hostname-AFS.</p>
  <p class=MsoBodyText>When IsGateway is non-zero, the LAN adapter detection
  code will avoid binding to a loopback adapter.  This will ensure that the
  NetBIOS name will be of the form hostname-AFS instead of the value set by the
  &quot;NetbiosName&quot; registry value.</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981063"></a><a name="_Toc126872285"></a><a
  name="_Toc115416216">Value: ReportSessionStartups</a></h5>
  <p class=MsoBodyText>Type: DWORD {1,0}<br>
  Default: 0<br>
  Variable: reportSessionStartups</p>
  <p class=MsoBodyText>If enabled, all SMB sessions created are recorded in the
  Application event log.  This also enables other events such as drive mappings
  or various error types to be logged.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981064"></a><a name="_Toc126872286"></a><a
  name="_Toc115416217"></a><a name="_Value_:_TraceBufferSize"></a>Value:
  TraceBufferSize</h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 5000 (CM_CONFIGDEFAULT_TRACEBUFSIZE)<br>
  Variable: traceBufSize</p>
  <p class=MsoBodyText>Number of entries to keep in trace log.</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981065"></a><a name="_Toc126872287"></a><a
  name="_Toc115416218"></a><a name="_Value_:_SysName"></a>Value: SysName</h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &quot;i386_nt40&quot;<br>
  Variable: cm_sysName</p>
  <p class=MsoBodyText>Provides an initial value for &quot;fs sysname&quot;. 
  The string can contain one or more replacement values for @sys in order of
  preference separated by whitespace.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981066"></a><a name="_Toc126872288"></a><a
  name="_Toc115416219"></a><a name="_Value_:_SecurityLevel"></a>Value:
  SecurityLevel</h5>
  <p class=MsoBodyText>Type: DWORD {1,0}<br>
  Default: 0<br>
  Variable: cryptall</p>
  <p class=MsoBodyText>Enables encryption on RX calls.</p>
  </td>
 </tr>
 <tr style='height:112.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:112.25pt'>
  <h5><a name="_Toc139981067"></a><a name="_Toc126872289"></a><a
  name="_Toc115416220"></a><a name="_Value_:_UseDNS"></a>Value: UseDNS</h5>
  <p class=MsoBodyText>Type: DWORD {1,0}<br>
  Default: 1<br>
  Variable: cm_dnsEnabled</p>
  <p class=MsoBodyText>Enables resolving volservers using AFSDB DNS queries.</p>
  <p class=MsoBodyText>As of 1.3.60, this value is ignored as the DNS query
  support utilizes the Win32 DNSQuery API which is available on Win2000 and
  above.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981068"></a><a name="_Toc126872290"></a><a
  name="_Toc115416221"></a><a name="_Value_:_FreelanceClient"></a>Value:
  FreelanceClient</h5>
  <p class=MsoBodyText>Type: DWORD {1,0}<br>
  Default: 0<br>
  Variable: cm_freelanceEnabled</p>
  <p class=MsoBodyText>Enables freelance client.</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981069"></a><a name="_Toc126872291"></a><a
  name="_Toc115416222"></a><a name="_Value_:_HideDotFiles"></a>Value:
  HideDotFiles</h5>
  <p class=MsoBodyText>Type: DWORD {1,0}<br>
  Default: 1<br>
  Variable: smb_hideDotFiles</p>
  <p class=MsoBodyText>Enables marking dotfiles with the hidden attribute.  Dot
  files are files whose name starts with a period (excluding &quot;.&quot; and
  &quot;..&quot;).</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981070"></a><a name="_Toc126872292"></a><a
  name="_Toc115416223">Value: MaxMpxRequests</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 50<br>
  Variable: smb_maxMpxRequests</p>
  <p class=MsoBodyText>Maximum number of multiplexed SMB requests that can be
  made.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981071"></a><a name="_Toc126872293"></a><a
  name="_Toc115416224">Value: MaxVCPerServer</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 100<br>
  Variable: smb_maxVCPerServer</p>
  <p class=MsoBodyText>Maximum number of SMB virtual circuits.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981072"></a><a name="_Toc126872294"></a><a
  name="_Toc115416225"></a><a name="_Value_:_Cell"></a>Value: Cell</h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &lt;none&gt;<br>
  Variable: rootCellName</p>
  <p class=MsoBodyText>Name of root cell (the cell from which root.afs should
  be mounted in \\afs\all).</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981073"></a><a name="_Toc126872295"></a><a
  name="_Toc115416226">Value: RxNoJumbo</a></h5>
  <p class=MsoBodyText>Type: DWORD {0,1}<br>
  Default: 0<br>
  Variable: rx_nojumbo</p>
  <p class=MsoBodyText>If enabled, does not send or indicate that we are able to
  send or receive RX jumbograms.</p>
  </td>
 </tr>
 <tr style='height:124.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:124.75pt'>
  <h5><a name="_Toc139981074"></a><a name="_Toc126872296"></a><a
  name="_Toc115416227"></a><a name="_Value_:_RxMaxMTU"></a>Value: RxMaxMTU</h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: -1<br>
  Variable: rx_mtu</p>
  <p class=MsoBodyText>If set to anything other than -1, uses that value as the
  maximum MTU supported by the RX interface.</p>
  <p class=MsoBodyText>In order to enable OpenAFS to operate across the Cisco
  IPSec VPN client, this value must be set to 1264 or smaller.</p>
  </td>
 </tr>
 <tr style='height:151.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:151.75pt'>
  <h5><a name="_Toc139981075"></a><a name="_Toc126872297"></a><a
  name="_Toc115416228"></a><a name="_Value:_ConnDeadTimeout"></a>Value:
  ConnDeadTimeout</h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 60 (seconds)<br>
  Variable: ConnDeadtimeout</p>
  <p class=MsoBodyText>The Connection Dead Time is enforced to be at a minimum
  15 seconds longer than the minimum SMB timeout as specified by [HKLM\SYSTEM\CurrentControlSet\Services\lanmanworkstation\parameters]
  SessTimeout</p>
  <p class=MsoBodyText>If the minimum SMB timeout is not specified the value is
  45 seconds.  See <a
  href="http://support.microsoft.com/support/kb/articles/Q102/0/67.asp">http://support.microsoft.com:80/support/kb/articles/Q102/0/67.asp</a></p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981076"></a><a name="_Toc126872298"></a><a
  name="_Toc115416229">Value: HardDeadTimeout</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 120 (seconds)<br>
  Variable: HardDeadtimeout</p>
  <p class=MsoBodyText>The Hard Dead Time is enforced to be at least double the
  ConnDeadTimeout.  The provides an opportunity for at least one retry.</p>
  </td>
 </tr>
 <tr style='height:158.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:158.5pt'>
  <h5><a name="_Toc139981077"></a><a name="_Toc126872299"></a><a
  name="_Toc115416230"></a><a name="_Value__:_TraceOption"></a>Value:
  TraceOption</h5>
  <p class=MsoBodyText>Type: DWORD {0-15}<br>
  Default: 0</p>
  <p class=MsoBodyText>Enables logging of debug output to the Windows Event
  Log.</p>
  <p class=MsoBodyText>Bit 0 enables logging of &quot;Logon Events&quot;
  processed by the Network Provider and Winlogon Event Notification Handler.  </p>
  <p class=MsoBodyText>Bit 1 enables logging of events captured by the AFS
  Client Service.</p>
  <p class=MsoBodyText>Bit 2 enables real-time viewing of &quot;fs trace&quot;
  logging with DbgView or similar tools.</p>
  <p class=MsoBodyText>Bit 3 enables &quot;fs trace&quot; logging on startup.</p>
  </td>
 </tr>
 <tr style='height:98.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:98.5pt'>
  <h5><a name="_Toc139981078"></a><a name="_Toc126872300"></a><a
  name="_Toc115416231">Value: AllSubmount</a></h5>
  <p class=MsoBodyText>Type: DWORD {0, 1}<br>
  Default: 1</p>
  <p class=MsoBodyText>Variable: allSubmount (smb.c)</p>
  <p class=MsoBodyText>By setting this value to 0, the
  &quot;\\NetbiosName\all&quot; mount point will not be created.  This allows
  the read-write versions of root.afs to be hidden.</p>
  </td>
 </tr>
 <tr style='height:78.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:78.5pt'>
  <h5><a name="_Toc139981079"></a><a name="_Toc126872301"></a><a
  name="_Toc115416232"></a><a name="_Value___: NoFindLanaByName"></a>Value:
  NoFindLanaByName</h5>
  <p class=MsoBodyText>Type: DWORD {0, 1}<br>
  Default: 0</p>
  <p class=MsoBodyText>Disables the attempt to identity the network adapter to
  use by looking for an adapter with a display name of &quot;AFS&quot;.</p>
  </td>
 </tr>
 <tr style='height:78.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:78.5pt'>
  <h5><a name="_Toc139981080"></a><a name="_Toc126872302"></a><a
  name="_Toc115416233">Value: MaxCPUs</a></h5>
  <p class=MsoBodyText>Type: DWORD {1..32} or {1..64} depending on the
  architecture<br>
  Default: &lt;no default&gt;</p>
  <p class=MsoBodyText>If this value is specified, afsd_service.exe will
  restrict itself to executing on the specified number of CPUs if there are a
  greater number installed in the machine.  </p>
  </td>
 </tr>
 <tr style='height:151.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:151.75pt'>
  <h5><a name="_Toc139981081"></a><a name="_Toc126872303"></a><a
  name="_Toc115416234"></a><a name="_Value___: smbAuthType"></a>Value:
  smbAuthType</h5>
  <p class=MsoBodyText>Type: DWORD {0..2}<br>
  Default: 2</p>
  <p class=MsoBodyText>If this value is specified, it defines the type of SMB
  authentication which must be present in order for the Windows SMB client to
  connect to the AFS Client Service's SMB server.  The values are:</p>
  <p class=MsoBodyText>0 = No authentication required<br>
  1 = NTLM authentication required<br>
  2 = Extended (GSS SPNEGO) authentication required<br>
  The default is Extended authentication</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981082"></a><a name="_Toc126872304"></a><a
  name="_Toc115416235"></a><a name="_Value___: MaxLogSize"></a>Value:
  MaxLogSize</h5>
  <p class=MsoBodyText>Type: DWORD {0 .. MAXDWORD}<br>
  Default: 100K</p>
  <p class=MsoBodyText>This entry determines the maximum size of the
  %WINDIR%\TEMP\afsd_init.log file.  If the file is larger than this value when
  afsd_service.exe starts the file will be reset to 0 bytes.  If this value is
  0, it means the file should be allowed to grow indefinitely.</p>
  </td>
 </tr>
 <tr style='height:65.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:65.75pt'>
  <h5><a name="_Toc139981083"></a><a name="_Toc126872305"></a><a
  name="_Toc115416236">Value: FlushOnHibernate</a></h5>
  <p class=MsoBodyText>Type: DWORD {0,1}<br>
  Default: 1</p>
  <p class=MsoBodyText>If set, flushes all volumes before the machine goes on
  hibernate or stand-by.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981084"></a><a
name="_Toc126872306"></a><a name="_Toc115416237">Regkey:<br>
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters\GlobalAutoMapper]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:65.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:65.0pt'>
  <h5><a name="_Toc139981085"></a><a name="_Toc126872307"></a><a
  name="_Toc115416238">Value: &lt;Drive Letter:&gt; for example &quot;G:&quot;</a></h5>
  <p class=MsoBodyText>Type: REG_SZ</p>
  <p class=MsoBodyText>Specifies the submount name to be mapped by
  afsd_service.exe at startup to the provided drive letter.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981086"></a><a
name="_Toc126872308"></a><a name="_Toc115416239">Regkey:<br>
[HKLM\SOFTWARE\OpenAFS\Client]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:78.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:78.5pt'>
  <h5><a name="_Toc139981087"></a><a name="_Toc126872309"></a><a
  name="_Toc115416240"></a><a name="_Value___: CellServDBDir"></a>Value:
  CellServDBDir</h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &lt;not defined&gt;</p>
  <p class=MsoBodyText>Specifies the directory containing the CellServDB file. 
  When this value is not specified, the AFS Client install directory is used.</p>
  </td>
 </tr>
 <tr style='height:145.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:145.25pt'>
  <h5><a name="_Toc139981088"></a><a name="_Toc126872310"></a><a
  name="_Toc115416241"></a><a name="_Value___: VerifyServiceSignature"></a>Value:
  VerifyServiceSignature</h5>
  <p class=MsoBodyText>Type: REG_DWORD<br>
  Default: 0x1</p>
  <p class=MsoBodyText>This value can be used to disable the runtime
  verification of the digital signatures applied to afsd_service.exe and the
  OpenAFS DLLs it loads.  This test is performed to verify that   the DLLs
  which are loaded by afsd_service.exe are from the same distribution as
  afsd_service.exe.  This is to prevent random errors caused when DLLs from one
  distribution of AFS are loaded by another one.  This is not a security test. 
  The reason for disabling this test is to free up additional memory which can
  be used for a large cache size.</p>
  </td>
 </tr>
 <tr style='height:105.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:105.5pt'>
  <h5><a name="_Toc139981089"></a><a name="_Toc126872311"></a><a
  name="_Toc115416242"></a><a name="_Value___: IoctlDebug"></a>Value:
  IoctlDebug</h5>
  <p class=MsoBodyText>Type: REG_DWORD<br>
  Default: 0x0</p>
  <p class=MsoBodyText>This value can be used to debug the cause of pioctl()
  failures.  Set a non-zero value and the pioctl() library will output status
  information to stdout.  Executing command line tools such as tokens.exe,
  fs.exe, etc can then be used to determine why the pioctl() call is failing. </p>
  </td>
 </tr>
 <tr style='height:330.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:330.75pt'>
  <h5><a name="_Toc139981090"></a><a name="_Toc126872312"></a><a
  name="_Toc115416243">Value: MiniDumpType</a></h5>
  <p class=MsoBodyText>Type: REG_DWORD<br>
  Default: 0x0 (MiniDumpNormal)</p>
  <p class=MsoBodyText>This value is used to specify the type of minidump
  generated by afsd_service.exe either when the process crashes or when a user
  initiated is dump file is generated with the &quot;fs.exe minidump&quot;
  command.</p>
  <p class=MsoBodyText>Valid values are dependent on the version of DbgHelp.dll
  installed on the machine.  See the Microsoft Developer Library for further
  information.</p>
  <p class=MsoBodyText>MiniDumpNormal = 0x00000000,<br>
  MiniDumpWithDataSegs = 0x00000001,<br>
  MiniDumpWithFullMemory = 0x00000002,<br>
  MiniDumpWithHandleData = 0x00000004,<br>
  MiniDumpFilterMemory = 0x00000008,<br>
  MiniDumpScanMemory = 0x00000010,<br>
  MiniDumpWithUnloadedModules = 0x00000020,<br>
  MiniDumpWithIndirectlyReferencedMemory = 0x00000040,<br>
  MiniDumpFilterModulePaths = 0x00000080,<br>
  MiniDumpWithProcessThreadData = 0x00000100,<br>
  MiniDumpWithPrivateReadWriteMemory = 0x00000200,<br>
  MiniDumpWithoutOptionalData = 0x00000400,<br>
  MiniDumpWithFullMemoryInfo = 0x00000800,<br>
  MiniDumpWithThreadInfo = 0x00001000,<br>
  MiniDumpWithCodeSegs = 0x00002000</p>
  </td>
 </tr>
 <tr style='height:138.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:138.25pt'>
  <h5><a name="_Toc139981091"></a><a name="_Toc126872313"></a><a
  name="_Toc115416244"></a><a name="_Value___: StoreAnsiFilenames"></a>Value:
  StoreAnsiFilenames</h5>
  <p class=MsoBodyText>Type: REG_DWORD<br>
  Default: 0x0</p>
  <p class=MsoBodyText>This value can be used to force the AFS Client Service
  to store filenames using the Windows system's ANSI character set instead of
  the OEM Code Page character set which has traditionally been used by SMB file
  systems.  </p>
  <p class=MsoBodyText>Note: The use of ANSI characters will render access to
  files with 8-bit OEM file names unaccessible from Windows.  This option is of
  use primarily when you wish to allow file names produced on Windows to be
  accessible from Latin-1 UNIX systems and vice versa.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981092"></a><a
name="_Toc126872314"></a><a name="_Toc115416245">Regkey:<br>
[HKLM\SOFTWARE\OpenAFS\Client\CSCPolicy]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:112.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:112.0pt'>
  <h5><a name="_Toc139981093"></a><a name="_Toc126872315"></a><a
  name="_Toc115416246">Value: &quot;smb/cifs share name&quot;</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &lt;none&gt;</p>
  <p class=MsoBodyText>This key is used to map SMB/CIFS shares to Client Side
  Caching (off-line access) policies. For each share one of the following policies
  may be used: &quot;manual&quot;, &quot;programs&quot;, &quot;documents&quot;,
  &quot;disable&quot;.  </p>
  <p class=MsoBodyText>These values used to be stored in afsdsbmt.ini</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981094"></a><a
name="_Toc126872316"></a><a name="_Toc115416247"></a><a
name="_Regkey:_[HKLM\SOFTWARE\OpenAFS\Clie"></a>Regkey:<br>
[HKLM\SOFTWARE\OpenAFS\Client\Freelance]</h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:138.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:138.5pt'>
  <h5><a name="_Toc139981095"></a><a name="_Toc126872317"></a><a
  name="_Toc115416248">Value: &quot;numeric value&quot;</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &lt;none&gt;</p>
  <p class=MsoBodyText>This key is used to store dot terminated mount point
  strings for use in constructing the fake root.afs volume when Freelance
  (dynamic roots) mode is activated.</p>
  <p class=MsoBodyText>&quot;athena.mit.edu#athena.mit.edu:root.cell.&quot;</p>
  <p class=MsoBodyText>&quot;.athena.mit.edu%athena.mit.edu:root.cell.&quot;</p>
  <p class=MsoBodyText>These values used to be stored in afs_freelance.ini</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981096"></a><a
name="_Toc126872318"></a><a name="_Toc115416249"></a><a
name="_Regkey:_[HKLM\SOFTWARE\OpenAFS\Clie_1"></a>Regkey:<br>
[HKLM\SOFTWARE\OpenAFS\Client\Freelance\Symlinks]</h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:145.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:145.0pt'>
  <h5><a name="_Toc139981097"></a><a name="_Toc126872319"></a><a
  name="_Toc115416250">Value: &quot;numeric value&quot;</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &lt;none&gt;</p>
  <p class=MsoBodyText>This key is used to store a dot terminated symlink
  strings for use in constructing the fake root.afs volume when Freelance
  (dynamic roots) mode is activated.</p>
  <p class=MsoBodyText>&quot;linkname:destination-path.&quot;</p>
  <p class=MsoBodyText>&quot;athena:athena.mit.edu.&quot;</p>
  <p class=MsoBodyText>&quot;home:athena.mit.edu\user\j\a\jaltman.&quot;</p>
  <p class=MsoBodyText>&quot;filename:path\file.&quot;</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981098"></a><a
name="_Toc126872320"></a><a name="_Toc115416251">Regkey:<br>
[HKLM\SOFTWARE\OpenAFS\Client\Submounts]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:171.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:171.75pt'>
  <h5><a name="_Toc139981099"></a><a name="_Toc126872321"></a><a
  name="_Toc115416252">Value: &quot;submount name&quot;</a></h5>
  <p class=MsoBodyText>Type: REG_EXPAND_SZ<br>
  Default: &lt;none&gt;</p>
  <p class=MsoBodyText>This key is used to store mappings of UNIX style AFS
  paths to submount names which can be referenced as UNC paths.  For example
  the submount string /athena.mit.edu/user/j/a/jaltman&quot; can be associated
  with the submount name &quot;jaltman.home&quot;.  This can then be referenced
  as the UNC path \\AFS\jaltman.home.</p>
  <p class=MsoBodyText>These values used to be stored in afsdsbmt.ini</p>
  <p class=MsoBodyText>NOTE: Submounts should no longer be used with OpenAFS.
  Use the Windows Explorer to create drive mappings to AFS UNC paths instead of
  using the AFS Submount mechanism.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981100"></a><a
name="_Toc126872322"></a><a name="_Toc115416253"></a><a
name="_Regkey:_[HKLM\SOFTWARE\OpenAFS\Clie_2"></a>Regkey:<br>
[HKLM\SOFTWARE\OpenAFS\Client\Server Preferences\VLDB]</h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:105.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:105.5pt'>
  <h5><a name="_Toc139981101"></a><a name="_Toc126872323"></a><a
  name="_Toc115416254">Value: &quot;hostname or ip address&quot;</a></h5>
  <p class=MsoBodyText>Type: REG_DWORD<br>
  Default: &lt;none&gt;</p>
  <p class=MsoBodyText>This key is used to specify a default set of VLDB server
  preferences. For each entry the value name will be either the IP address of a
  server or a fully qualified domain name.  The value will be the ranking.  The
  ranking will be adjusted by a random value between 0 and 256 prior to the
  preference being set.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981102"></a><a
name="_Toc126872324"></a><a name="_Toc115416255">Regkey:<br>
[HKLM\SOFTWARE\OpenAFS\Client\Server Preferences\File]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:105.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:105.5pt'>
  <h5><a name="_Toc139981103"></a><a name="_Toc126872325"></a><a
  name="_Toc115416256">Value: &quot;hostname or ip address&quot;</a></h5>
  <p class=MsoBodyText>Type: REG_DWORD<br>
  Default: &lt;none&gt;</p>
  <p class=MsoBodyText>This key is used to specify a default set of File server
  preferences. For each entry the value name will be either the IP address of a
  server or a fully qualified domain name.  The value will be the ranking.  The
  ranking will be adjusted by a random value between 0 and 256 prior to the
  preference being set.</p>
  </td>
 </tr>
</table>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981104"></a><a
name="_Toc126872326"></a><a name="_Toc115417105"></a><a name="_Toc115416257">A.2.
Integrated Logon Network provider parameters</a></h2>

<p class=MsoBodyText>Affects the network provider (afslogon.dll).</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981105"></a><a
name="_Toc126872327"></a><a name="_Toc115416258">Regkey: [HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:65.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:65.75pt'>
  <h5><a name="_Toc139981106"></a><a name="_Toc126872328"></a><a
  name="_Toc115416259">Value: FailLoginsSilently</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 0</p>
  <p class=MsoBodyText>Do not display message boxes if the login fails.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981107"></a><a
name="_Toc126872329"></a><a name="_Toc115416260">Regkey:<br>
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:65.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:65.75pt'>
  <h5><a name="_Toc139981108"></a><a name="_Toc126872330"></a><a
  name="_Toc115416261">Value: NoWarnings</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 0</p>
  <p class=MsoBodyText>Disables visible warnings during logon.</p>
  </td>
 </tr>
 <tr style='height:65.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:65.75pt'>
  <h5><a name="_Toc139981109"></a><a name="_Toc126872331"></a><a
  name="_Toc115416262">Value: AuthentProviderPath</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  NSIS: %WINDIR%\SYSTEM32\afslogon.dll</p>
  <p class=MsoBodyText>Specifies the install location of the authentication
  provider dll.</p>
  </td>
 </tr>
 <tr style='height:65.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:65.75pt'>
  <h5><a name="_Toc139981110"></a><a name="_Toc126872332"></a><a
  name="_Toc115416263">Value: Class</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  NSIS: 0x02</p>
  <p class=MsoBodyText>Specifies the class of network provider</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981111"></a><a name="_Toc126872333"></a><a
  name="_Toc115416264">Value: DependOnGroup</a></h5>
  <p class=MsoBodyText>Type: REG_MULTI_SZ<br>
  NSIS: PNP_TDI</p>
  <p class=MsoBodyText>Specifies the service groups upon which the AFS Client
  Service depends.  Windows should not attempt to start the AFS Client Service
  until all of the services within these groups have successfully started.</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981112"></a><a name="_Toc126872334"></a><a
  name="_Toc115416265">Value: DependOnService</a></h5>
  <p class=MsoBodyText>Type: REG_MULTI_SZ<br>
  NSIS: Tcpip NETBIOS RpcSs</p>
  <p class=MsoBodyText>Specifies a list of services upon which the AFS Client
  Service depends.  Windows should not attempt to start the AFS Client Service
  until all of the specified services have successfully started.</p>
  </td>
 </tr>
 <tr style='height:65.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:65.75pt'>
  <h5><a name="_Toc139981113"></a><a name="_Toc126872335"></a><a
  name="_Toc115416266">Value: Name</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  NSIS: &quot;OpenAFSDaemon&quot;</p>
  <p class=MsoBodyText>Specifies the display name of the AFS Client Service</p>
  </td>
 </tr>
 <tr style='height:65.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:65.75pt'>
  <h5><a name="_Toc139981114"></a><a name="_Toc126872336"></a><a
  name="_Toc115416267">Value: ProviderPath</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  NSIS: %WINDIR%\SYSTEM32\afslogon.dll</p>
  <p class=MsoBodyText>Specifies the DLL to use for the network provider</p>
  </td>
 </tr>
</table>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981115"></a><a
name="_Toc126872337"></a><a name="_Toc115417106"></a><a name="_Toc115416268"></a><a
name="_A.2.1_Domain_specific_configuration"></a>A.2.1 Domain specific configuration
keys for the Network Provider</h2>

<p class=MsoBodyText>The network provider can be configured to have different
behavior depending on the domain that the user logs into.  These settings are only
relevant when using integrated login.  A domain refers to an Active Directory
(AD) domain, a trusted Kerberos (non-AD) realm or the local machine (i.e. local
account logins).  The domain name that is used for selecting the domain would
be the domain that is passed into the NPLogonNotify function of the network
provider.</p>

<p class=MsoBodyText>Domain specific registry keys are:</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981116"></a><a
name="_Toc126872338"></a><a name="_Toc115416269">[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider]</a></h3>

<p class=MsoBodyText>  (NP key)</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981117"></a><a
name="_Toc126872339"></a><a name="_Toc115416270">[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain]</a></h3>

<p class=MsoBodyText>  (Domains key)</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981118"></a><a
name="_Toc126872340"></a><a name="_Toc115416271">[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\&quot;domain
name&quot;]</a></h3>

<p class=MsoBodyText>  (Specific domain key. One per domain.)</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981119"></a><a
name="_Toc126872341"></a><a name="_Toc115416272">[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\LOCALHOST]</a></h3>

<p class=MsoBodyText>  (Localhost key)</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981120"></a><a
name="_Toc126872342"></a><a name="_Toc115416273">Example:</a></h3>

<p class=PreformattedText> HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider</p>

<p class=PreformattedText>  |</p>

<p class=PreformattedText>  +- Domain</p>

<p class=PreformattedText>     +-AD1.EXAMPLE.COM</p>

<p class=PreformattedText>     +-AD2.EXAMPLE.NET</p>

<p class=PreformattedText>     +-LOCALHOST</p>

<p class=MsoBodyText>Each of the domain specific keys can have the set of
values described in 2.1.1.  The effective values are chosen as described in
2.1.2.</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981121"></a><a
name="_Toc126872343"></a><a name="_Toc115416274">A.2.1.1 Domain specific
configuration values</a></h3>

<h4><a name="_Toc139981122"></a><a name="_Toc126872344"></a><a
name="_Toc115416275">[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider]<br>
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain]<br>
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\&quot;domain
name&quot;]<br>
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider\Domain\LOCALHOST]</a></h4>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:191.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:191.0pt'>
  <h5><a name="_Toc139981123"></a><a name="_Toc126872345"></a><a
  name="_Toc115416276"></a><a name="_Value___: LogonOptions"></a>Value:
  LogonOptions</h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 0x01</p>
  <p class=MsoBodyText>NSIS/WiX: depends on user configuration</p>
  <p class=MsoBodyText>0x00 - Integrated Logon is not used<br>
  0x01 - Integrated Logon is used<br>
  0x02 - High Security Mode is used (deprecated)<br>
  0x03 - Integrated Logon with High Security Mode is used (deprecated)</p>
  <p class=MsoBodyText>High Security Mode generates random SMB names for the
  creation of Drive Mappings.  This mode should not be used without Integrated
  Logon.</p>
  <p class=MsoBodyText>As of 1.3.65 the SMB server supports SMB
  authentication.  The High Security Mode should not be used when using SMB
  authentication (SMBAuthType setting is non zero).</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981124"></a><a name="_Toc126872346"></a><a
  name="_Toc115416277">Value: FailLoginsSilentl</a></h5>
  <p class=MsoBodyText>Type: DWORD (1|0)<br>
  Default: 0<br>
  NSIS/WiX: (not set)</p>
  <p class=MsoBodyText>If true, does not display any visible warnings in the
  event of an error during the integrated login process.</p>
  </td>
 </tr>
 <tr style='height:139.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:139.0pt'>
  <h5><a name="_Toc139981125"></a><a name="_Toc126872347"></a><a
  name="_Toc115416278">Value: LogonScript</a></h5>
  <p class=MsoBodyText>Type: REG_SZ or REG_EXPAND_SZ<br>
  Default: (null)<br>
  NSIS/WiX: (only value under NP key) &lt;install path&gt;\afscreds.exe -:%s -x
  -a -m -n -q</p>
  <p class=MsoBodyText>A logon script that will be scheduled to be run after
  the profile load is complete.  If using the REG_EXPAND_SZ type, you can use
  any system environment variable as &quot;%varname%&quot; which would be
  expanded at the time the network provider is run.  Optionally using a
  &quot;%s&quot; in the value would result in it being expanded into the AFS
  SMB username for the session.</p>
  </td>
 </tr>
 <tr style='height:105.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:105.5pt'>
  <h5><a name="_Toc139981126"></a><a name="_Toc126872348"></a><a
  name="_Toc115416279">Value: LoginRetryInterval</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 30<br>
  NSIS/WiX: (not set)</p>
  <p class=MsoBodyText>If the OpenAFS client service has not started yet, the
  network provider will wait for a maximum of &quot;LoginRetryInterval&quot;
  seconds while retrying every &quot;LoginSleepInterval&quot; seconds to check
  if the service is up.</p>
  </td>
 </tr>
 <tr style='height:79.25pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:79.25pt'>
  <h5><a name="_Toc139981127"></a><a name="_Toc126872349"></a><a
  name="_Toc115416280">Value: LoginSleepInterval</a></h5>
  <p class=MsoBodyText>Type: DWORD<br>
  Default: 5<br>
  NSIS/WiX: (not set)</p>
  <p class=MsoBodyText>See description of LoginRetryInterval.</p>
  </td>
 </tr>
 <tr style='height:78.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:78.5pt'>
  <h5><a name="_Toc139981128"></a><a name="_Toc126872350"></a><a
  name="_Toc115416281"></a><a name="_Value:_TheseCells"></a>Value: TheseCells</h5>
  <p class=MsoBodyText>Type: REG_MULTI_SZ<br>
  NSIS: &lt;not set&gt;</p>
  <p class=MsoBodyText>When Kerberos 5 is being used, TheseCells provides a
  list of additional cells for which tokens should be obtained with the default
  Kerberos 5 principal.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981129"></a><a
name="_Toc126872351"></a><a name="_Toc115416282">A.2.1.2  Selection of
effective values for domain specific configuration</a></h3>

<p class=MsoBodyText>During login to domain X, where X is the domain passed
into NPLogonNotify as lpAuthentInfo-&gt;LogonDomainName or the string 'LOCALHOST'
if lpAuthentInfo-&gt;LogonDomainName equals the name of the computer, the
following keys will be looked up.</p>

<p class=MsoBodyText style='margin-left:36.0pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NP
key. (&quot;HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\NetworkProvider&quot;)</p>

<p class=MsoBodyText style='margin-left:36.0pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Domains
key. (NP key\&quot;Domain&quot;)</p>

<p class=MsoBodyText style='margin-left:36.0pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Specific
domain key. (Domains key\X)</p>

<p class=MsoBodyText>If the specific domain key does not exist, then the
domains key will be ignored.  All the configuration information in this case
will come from the NP key.</p>

<p class=MsoBodyText>If the specific domain key exists, then for each of the
values metioned in (2), they will be looked up in the specific domain key, domains
key and the NP key successively until the value is found. The first instance of
the value found this way will be the effective for the login session.  If no
such instance can be found, the default will be used.  To re-iterate, a value
in a more specific key supercedes a value in a less specific key.  The
exceptions to this rule are stated below.</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981130"></a><a
name="_Toc126872352"></a><a name="_Toc115416283">A.2.1.3 Exceptions to A.2.1.2</a></h3>

<p class=MsoBodyText>To retain backwards compatibility, the following
exceptions are made to 2.1.2.</p>

<h4><a name="_Toc139981131"></a><a name="_Toc126872353"></a><a
name="_Toc115416284">2.1.3.1 'FailLoginsSilently'</a></h4>

<p class=MsoBodyText>Historically, the 'FailLoginsSilently' value was in HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters
key and not in the NP key.  Therefore, for backwards compatibility, the value
in the Parameters key will supercede all instances of this value in other
keys.  In the absence of this value in the Parameters key, normal scope rules
apply.</p>

<h4><a name="_Toc139981132"></a><a name="_Toc126872354"></a><a
name="_Toc115416285">2.1.3.2 'LogonScript'</a></h4>

<p class=MsoBodyText>If a 'LogonScript' is not specified in the specific domain
key nor in the domains key, the value in the NP key will only be checked if the
effective 'LogonOptions' specify a high security integrated login.  If a logon
script is specified in the specific domain key or the domains key, it will be
used regardless of the high security setting.  Please be aware of this when
setting this value.</p>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981133"></a><a
name="_Toc126872355"></a><a name="_Toc115417107"></a><a name="_Toc115416286">A.3.
AFS Credentials System Tray Tool parameters</a></h2>

<p class=MsoBodyText>Affects the behavior of afscreds.exe</p>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981134"></a><a
name="_Toc126872356"></a><a name="_Toc115416287">Regkey:<br>
[HKLM\SYSTEM\CurrentControlSet\Services\TransarcAFSDaemon\Parameters]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981135"></a><a name="_Toc126872357"></a><a
  name="_Toc115416288">Value: Gateway</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &quot;&quot;<br>
  Function: GetGatewayName()</p>
  <p class=MsoBodyText>If the AFS client is utilizing a gateway to obtain AFS
  access, the name of the gateway is specified by this value.</p>
  </td>
 </tr>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981136"></a><a name="_Toc126872358"></a><a
  name="_Toc115416289">Value: Cell</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &lt;none&gt;<br>
  Variable: IsServiceConfigured()</p>
  <p class=MsoBodyText>The value Cell is used to determine if the AFS Client
  Service has been properly configured or not.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981137"></a><a
name="_Toc126872359"></a><a name="_Toc115416290">Regkey:<br>
[HKLM\SOFTWARE\OpenAFS\Client]<br>
[HKCU\SOFTWARE\OpenAFS\Client]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:157.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:157.5pt'>
  <h5><a name="_Toc139981138"></a><a name="_Toc126872360"></a><a
  name="_Toc115416291">Value: ShowTrayIcon</a></h5>
  <p class=MsoBodyText>Type: DWORD {0, 1}<br>
  Default: 1<br>
  Function: InitApp(), Main_OnCheckTerminate()</p>
  <p class=MsoBodyText>This value is used to determine whether or not a
  shortcut should be maintained in the user's Start
  Menu-&gt;Programs-&gt;Startup folder. </p>
  <p class=MsoBodyText>This value used to be stored at [HKLM\Software\TransarcCorporation\AFS
  Client\AfsCreds].</p>
  <p class=MsoBodyText>The current user value is checked first; if it does not
  exist the local machine value is checked.</p>
  </td>
 </tr>
 <tr style='height:119.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:119.0pt'>
  <h5><a name="_Toc139981139"></a><a name="_Toc126872361"></a><a
  name="_Toc115416292">Value: EnableKFW</a></h5>
  <p class=MsoBodyText>Type: DWORD {0, 1}<br>
  Default: 1<br>
  Function: KFW_is_available()</p>
  <p class=MsoBodyText>When MIT Kerberos for Windows can be loaded, Kerberos 5
  will be used to obtain AFS credentials.  By setting this value to 0, the
  internal Kerberos 4 implementation will be used instead.  The current user
  value is checked first; if it does not exist the local machine value is
  checked.</p>
  </td>
 </tr>
 <tr style='height:119.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:119.0pt'>
  <h5><a name="_Toc139981140"></a><a name="_Toc126872362"></a><a
  name="_Toc115416293"></a><a name="_Value___: Use524"></a>Value: Use524</h5>
  <p class=MsoBodyText>Type: DWORD {0, 1}<br>
  Default: 0<br>
  Function: KFW_use_krb524()</p>
  <p class=MsoBodyText>When MIT Kerberos for Windows can be loaded, Kerberos 5
  will be used to obtain AFS credentials.  By setting this value to 1, the
  Kerberos 5 tickets will be converted to Kerberos 4 tokens via a call to the
  krb524 daemon.  The current user value is checked first; if it does not exist
  the local machine value is checked.</p>
  </td>
 </tr>
 <tr style='height:251.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:251.5pt'>
  <h5><a name="_Toc139981141"></a><a name="_Toc126872363"></a><a
  name="_Toc115416294"></a><a name="_Value___: AfscredsShortcutParams"></a>Value:
  AfscredsShortcutParams</h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &quot;-A -M -N -Q&quot;<br>
  Function: Shortcut_FixStartup</p>
  <p class=MsoBodyText>This value specifies the command line options which
  should be set as part of the shortcut to afscreds.exe.  afscreds.exe rewrites
  the shortcut each time it exits so as to ensure that the shortcut points to
  the latest version of the program.  This value is used to determine which
  values should be used for command line parameters.  The current user value is
  checked first; if it does not exist the local machine value is checked.</p>
  <p class=MsoBodyText>The following subset of the command line options is
  appropriate for use in this registry setting:</p>
  <p class=MsoBodyText>-A = autoinit<br>
  -M = renew drive maps<br>
  -N = ip address change detection<br>
  -Q = quiet mode.  do not display start service dialog if afsd_service is not
  already running<br>
  -S = show tokens dialog on startup<br>
  -Z = unmap drives</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981142"></a><a
name="_Toc126872364"></a><a name="_Toc115416295">Regkey:<br>
[HKCU\SOFTWARE\OpenAFS\Client]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:92.0pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:92.0pt'>
  <h5><a name="_Toc139981143"></a><a name="_Toc126872365"></a><a
  name="_Toc115416296">Value: Authentication Cell</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &lt;none&gt;<br>
  Function: Afscreds.exe GetDefaultCell()</p>
  <p class=MsoBodyText>This value allows the user to configure a different cell
  name to be used as the default cell when acquiring tokens in afscreds.exe.</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981144"></a><a
name="_Toc126872366"></a><a name="_Toc115416297">Regkey:<br>
[HKCU\SOFTWARE\OpenAFS\Client\Reminders]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:124.75pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:124.75pt'>
  <h5><a name="_Toc139981145"></a><a name="_Toc126872367"></a><a
  name="_Toc115416298">Value: &quot;afs cell name&quot;</a></h5>
  <p class=MsoBodyText>Type: DWORD {0, 1}<br>
  Default: &lt;none&gt;<br>
  Function: LoadRemind(), SaveRemind()</p>
  <p class=MsoBodyText>These values are used to save and restore the state of
  the reminder flag for each cell for which the user has obtained tokens.</p>
  <p class=MsoBodyText>This value used to be stored at [HKLM\Software\TransarcCorporation\AFS
  Client\AfsCreds].</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981146"></a><a
name="_Toc126872368"></a><a name="_Toc115416299">Regkey:<br>
[HKCU\SOFTWARE\OpenAFS\Client\Active Maps]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:98.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:98.5pt'>
  <h5><a name="_Toc139981147"></a><a name="_Toc126872369"></a><a
  name="_Toc115416300">Value: &quot;upper case drive letter&quot;</a></h5>
  <p class=MsoBodyText>Type: DWORD {0, 1}<br>
  Default: &lt;none&gt;</p>
  <p class=MsoBodyText>These values are used to store the persistence state of
  the AFS drive mappings as listed in the [...\Client\Mappings] key.</p>
  <p class=MsoBodyText>These values used to be stored in the afsdsbmt.ini file</p>
  </td>
 </tr>
</table>

<h3 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981148"></a><a
name="_Toc126872370"></a><a name="_Toc115416301">Regkey:<br>
[HKCU\SOFTWARE\OpenAFS\Client\Mappings]</a></h3>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr style='height:98.5pt'>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt;
  height:98.5pt'>
  <h5><a name="_Toc139981149"></a><a name="_Toc126872371"></a><a
  name="_Toc115416302">Value: &quot;upper case drive letter&quot;</a></h5>
  <p class=MsoBodyText>Type: REG_SZ<br>
  Default: &lt;none&gt;</p>
  <p class=MsoBodyText>These values are used to store the AFS path in UNIX
  notation to which the drive letter is to be mapped.</p>
  <p class=MsoBodyText>These values used to be stored in the afsdsbmt.ini file.</p>
  </td>
 </tr>
</table>

<h2 style='margin-left:0pt;text-indent:0pt'><a name="_Toc139981150"></a><a
name="_Toc126872372"></a><a name="_Toc115417108"></a><a name="_Toc115416303">A.4
OpenAFS Client Service Environment Variables</a></h2>

<table class=MsoTableWeb1 border=1 cellspacing=3 cellpadding=0>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h5><a name="_Toc139981151"></a><a name="_Toc126872373"></a><a
  name="_Toc115416304">Variable: AFS_RPC_ENCRYPT</a></h5>
  <p class=MsoBodyText>Values:   &quot;OFF&quot; disables the use of RPC
  encryption any other value allows RPC encryption to be used<br>
  Default:  RPC encryption is on</p>
  </td>
 </tr>
 <tr>
  <td width=590 valign=top style='width:442.8pt;padding:0pt 5.4pt 0pt 5.4pt'>
  <h5><a name="_Toc139981152"></a><a name="_Toc126872374"></a><a
  name="_Toc115416305">Variable: AFS_RPC_PROTSEQ</a></h5>
  <p class=MsoBodyText>Values:            &quot;ncalrpc&quot;  - local RPC<br>
                          &quot;ncacn_np&quot; - named pipes<br>
                          &quot;ncacn_ip_tcp&quot; - tcp/ip<br>
  Default:  local RPC</p>
  </td>
 </tr>
</table>

<p class=MsoBodyText>&nbsp;</p>

</div>

</body>

</html>
