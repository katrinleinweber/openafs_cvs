# Copyright 2000, International Business Machines Corporation and others.
# All Rights Reserved.
# 
# This software has been released under the terms of the IBM Public
# License.  For details, see the LICENSE file in the top-level source
# directory or online at http://www.openafs.org/dl/license10.html

!INCLUDE ..\..\config\NTMakefile.$(SYS_NAME)
!INCLUDE ..\..\config\NTMakefile.version


############################################################################
# Export header files

LIBINCLUDES = \
	$(DESTDIR)\include\pthread.h

############################################################################
# Build standard afspthread.dll

PTHR_DLLFILE = $(DESTDIR)\lib\afspthread.dll

PTHR_DLLOBJS = \
	pthread.obj \
	pthread.res

$(PTHR_DLLFILE): $(PTHR_DLLOBJS)
	$(DLLCONLINK) /DEF:pthread.def
	$(DLLPREP)

############################################################################
# Build Windows 95 version of afspthread.dll

PTHR95_DLLFILE = $(DESTDIR)\lib\win95\afspthread.dll

PTHR95_DLLOBJS = \
	pthread_95.obj \
	pthread95.res

$(PTHR95_DLLFILE): $(PTHR95_DLLOBJS)
	$(DLLCONLINK) /DEF:pthread.def
	$(DLLPREP)

pthread_95.obj: pthread.c
	$(C2OBJ) pthread.c -DAFS_WIN95_ENV /Fopthread_95.obj

install: $(PTHR95_DLLFILE) $(PTHR_DLLFILE) $(LIBINCLUDES)

install9x: install

pthread.res: pthread.rc AFS_component_version_number.h
	$(RC) $*.rc

pthread95.res: pthread95.rc AFS_component_version_number.h
	$(RC) $*.rc

clean::
	$(DEL) /q $(DESTDIR)\lib\win95\*.*
