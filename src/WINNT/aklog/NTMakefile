# Copyright 2004, OpenAFS.ORG and others.
# All Rights Reserved.
# 
# This software has been released under the terms of the IBM Public
# License.  For details, see the LICENSE file in the top-level source
# directory or online at http://www.openafs.org/dl/license10.html

# include the primary makefile
RELDIR=WINNT\aklog
!INCLUDE ..\..\config\NTMakefile.$(SYS_NAME)
!INCLUDE ..\..\config\NTMakefile.version

############################################################################
#
# BUILD TARGETS
#

EXEFILE = $(DESTDIR)\root.client\usr\vice\etc\aklog.exe

EXEOBJS = \
	$(OUT)\aklog.obj \
	$(OUT)\linked_list.obj

EXELIBS = \
	$(DESTDIR)\lib\afs\afspioctl.lib \
    $(DESTDIR)\lib\afsauthent.lib \
    $(DESTDIR)\lib\afs\afskauth.lib

OTHERLIBS = \
    ..\kfw\lib\i386\krbv4w32.lib \
    ..\kfw\lib\i386\krb5_32.lib \
    dnsapi.lib

afscflags = -I..\kfw\inc\krb5 -I..\kfw\inc\krb4 $(afscflags)

$(EXEOBJS): $$(@B).c
	$(C2OBJ) $**

############################################################################

$(EXEFILE) : $(EXEOBJS) $(OUT)\aklog.res $(EXELIBS)
	$(EXECONLINK) $(OTHERLIBS)
	$(EXEPREP) 

install : $(COPYHEADERS) $(EXEFILE)

############################################################################
#
# Dependencies
#

$(OUT)\aklog.res : aklog.rc AFS_component_version_number.h

mkdir:
	-mkdir $(OUT)\lang
	cd lang
	nmake /nologo /f ntmakefile SRC=$(SRC) OBJ=$(OBJ) mkdir
	cd ..

