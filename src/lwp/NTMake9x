# Copyright 2000, International Business Machines Corporation and others.
# All Rights Reserved.
# 
# This software has been released under the terms of the IBM Public
# License.  For details, see the LICENSE file in the top-level source
# directory or online at http://www.openafs.org/dl/license10.html

# nmake Makefile for NT build of LWP. 

!include ..\config\NTMakefile.$(SYS_NAME)
!IF (EXIST(..\config\NTMakefile.version))
!include ..\config\NTMakefile.version
!ENDIF

#LIBOBJS = lock.obj \
	  #lwp_nt.obj \
	  #iomgr.obj \
	  #timer.obj\
	  #fasttime.obj \
	  #waitkey.obj \
	  #AFS_component_version_number.obj
LIBOBJS=tlwp.obj process.obj lock.obj tiomgr.obj timer.obj fasttime.obj preempt.obj AFS_component_version_number.obj pthread.obj

#tlwp.o: lwp.c lwp.h
     #$(CC) $(CFLAGS) -DUSE_SOLARIS_THREADSX -c lwp.c
     #mv lwp.o tlwp.o
#
#tiomgr.o: iomgr.c lwp.h
#     $(CC) $(CFLAGS) -DUSE_SOLARIS_THREADSX -c iomgr.c
#     mv iomgr.o tiomgr.o
#
#pthread.o : pthread.c
#     $(CC) $(CFLAGS) -DUSE_SOLARIS_THREADSX -c pthread.c

LIBFILE = $(DESTDIR)\lib\afslwp.lib

INCFILES = \
	$(DESTDIR)\include\lock.h \
	$(DESTDIR)\include\lwp.h \
	$(DESTDIR)\include\preempt.h \
	$(DESTDIR)\include\timer.h



install: $(LIBFILE) $(INCFILES)

$(LIBFILE): $(LIBOBJS)
	$(LIBARCH)

tests: rw.exe

rw.exe: rw.obj $(LIBFILE) $(DESTDIR)\lib\afs\afsutil.lib
	$(EXECONLINK)
