# Copyright 2000, International Business Machines Corporation and others.
# All Rights Reserved.
# 
# This software has been released under the terms of the IBM Public
# License.  For details, see the LICENSE file in the top-level source
# directory or online at http://www.openafs.org/dl/license10.html

!INCLUDE ..\config\NTMakefile.$(SYS_NAME)
!IF (EXIST(..\config\NTMakefile.version))
!INCLUDE ..\config\NTMakefile.version
!ENDIF

# Definitions for installing header files

INCFILEDIR = $(DESTDIR)\include\afs

INCFILES =\
	$(INCFILEDIR)\afsint.h \
	$(INCFILEDIR)\afscbint.h

# afsint.lib

LIBFILE = $(DESTDIR)\lib\afs\afsint.lib

LIBOBJS =\
	$(OJT)\afscbint.cs.obj \
	$(OJT)\afscbint.ss.obj \
	$(OJT)\afscbint.xdr.obj \
	$(OJT)\afsint.cs.obj 	\
	$(OJT)\afsint.ss.obj 	\
	$(OJT)\afsint.xdr.obj 	\
	$(OJT)\afsaux.obj      \
	$(OJT)\AFS_component_version_number.obj

$(LIBFILE): $(LIBOBJS)
	$(LIBARCH)  

# use rxgen on afscbint.xg and afsint.xg
afscbint.cs.c afscbint.ss.c afscbint.xdr.c afscbint.h : afscbint.xg common.xg
	$(RXGEN) -x -y afscbint.xg

afsint.cs.c afsint.ss.c afsint.xdr.c afsint.h: afsint.xg common.xg
	$(RXGEN) -x afsint.xg

# mtafsint.lib

MT_LIBFILE = $(DESTDIR)\lib\afs\mtafsint.lib

MT_LIBOBJS =\
	$(OJT)\afscbint.cs_mt.obj \
	$(OJT)\afscbint.ss_mt.obj \
	$(OJT)\afscbint.xdr_mt.obj \
	$(OJT)\afsint.cs_mt.obj 	\
	$(OJT)\afsint.ss_mt.obj 	\
	$(OJT)\afsint.xdr_mt.obj 	\
	$(OJT)\afsaux_mt.obj      \
	$(OJT)\AFS_component_version_number.obj


$(OJT)\afscbint.cs_mt.obj:afscbint.cs.c
	$(C2OBJ) $** -DAFS_PTHREAD_ENV 

$(OJT)\afscbint.ss_mt.obj:afscbint.ss.c
	$(C2OBJ) $** -DAFS_PTHREAD_ENV 

$(OJT)\afscbint.xdr_mt.obj:afscbint.xdr.c
	$(C2OBJ) $** -DAFS_PTHREAD_ENV 

$(OJT)\afsint.cs_mt.obj:afsint.cs.c
	$(C2OBJ) $** -DAFS_PTHREAD_ENV 

$(OJT)\afsint.ss_mt.obj:afsint.ss.c
	$(C2OBJ) $** -DAFS_PTHREAD_ENV 

$(OJT)\afsint.xdr_mt.obj:afsint.xdr.c
	$(C2OBJ) $** -DAFS_PTHREAD_ENV 

$(OJT)\afsaux_mt.obj:afsaux.c
	$(C2OBJ) $** -DAFS_PTHREAD_ENV 

$(MT_LIBFILE): $(MT_LIBOBJS)
	$(LIBARCH)  

install: $(LIBFILE) $(INCFILES) $(MT_LIBFILE)

install9x: install

clean::
	$(DEL) *.cs.c *.ss.c *.xdr.c afsint.h afscbint.h
	$(DEL) $(LIBFILE) $(MT_LIBFILE)
mkdir:
	
