<?xml version="1.0" encoding="UTF-8"?>
<refentry id="fms8">
  <refmeta>
    <refentrytitle>fms</refentrytitle>
    <manvolnum>8</manvolnum>
  </refmeta>
  <refnamediv>
    <refname>fms</refname>
    <refpurpose>Determine a tape's capacity and a tape device's filemark size</refpurpose>
  </refnamediv>
  <refsect1>
    <title>Synopsis</title>
    <para><emphasis role="bold">fms</emphasis> <emphasis role="bold">-tape</emphasis> &lt;<emphasis>tape special file</emphasis>&gt; [<emphasis role="bold">-help</emphasis>]</para>

    <para><emphasis role="bold">fms</emphasis> <emphasis role="bold">-t</emphasis> &lt;<emphasis>tape special file</emphasis>&gt; [<emphasis role="bold">-h</emphasis>]</para>

  </refsect1>
  <refsect1>
    <title>Description</title>
    <para>The <emphasis role="bold">fms</emphasis> command determines the capacity of the tape currently in the
    tape device identified by the <emphasis role="bold">-tape</emphasis> argument, along with the size of
    the filemark for the device. The filemark is also referred to as the
    device's end-of-file (EOF) marker, and can differ for each combination of
    tape and tape device.</para>

    <para>As the Tape Coordinator writes a dump, it writes a filemark between the
    data included from each volume and also tracks the amount of space left
    before the end of the tape (EOT). For some tape devices, the filemark is
    large enough (multiple megabytes) that failure to consider it leads the
    Tape Coordinator significantly to overestimate the available space.</para>

    <para>The intended use of this command is to determine tape capacity and
    filemark size values that can be specified in a tape device's entry in the
    <replaceable>/usr/afs/backup/tapeconfig</replaceable> file. For certain types of tape drives, the
    Tape Coordinator operates more efficiently when the <replaceable>tapeconfig</replaceable> file
    lists accurate values. For further discussion, see the <emphasis>IBM AFS
    Administration Guide</emphasis> chapter on configuring the Backup System.</para>

    <para>Insert a tape in the drive before issuing this command.</para>

  </refsect1>
  <refsect1>
    <title>Cautions</title>
    <para>Do not use this command on compressing tape devices in compression mode or
    with tape devices that handle tapes of multigigabyte (or multiterabyte)
    capacity. It does not produce accurate results in those cases.  For
    alternate suggestions on the values to record in the <emphasis role="bold">tapeconfig</emphasis> file
    for compressing drives, see the <emphasis>IBM AFS Administration Guide</emphasis> chapter on
    configuring the Backup System.</para>

    <para>Running the command completely overwrites the tape, so use a blank one or
    one that can be recycled.</para>

    <para>Because it writes filemarks to the complete length of the tape, the
    command can take from several hours to more than a day to complete.</para>

  </refsect1>
  <refsect1>
    <title>Options</title>
    <variablelist>
      <varlistentry>
        <term><emphasis role="bold">-tape</emphasis> &lt;<emphasis>tape special file</emphasis>&gt;</term>
        <listitem>
          <para>Specifies the UNIX device name of the tape device for which to determine
          filemark size and the capacity of the tape it currently contains. The
          format varies on different system types, but usually begins with <replaceable>/dev</replaceable>;
          an example is <replaceable>/dev/sd0a</replaceable>.</para>

        </listitem>
      </varlistentry>
      <varlistentry>
        <term><emphasis role="bold">-help</emphasis></term>
        <listitem>
          <para>Prints the online help for this command. All other valid options are
          ignored.</para>

        </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>
  <refsect1>
    <title>Output</title>
    <para>The command generates output both on the standard output stream and in the
    <replaceable>fms.log</replaceable> file that it creates in the current working directory. The
    output reports the capacity of the tape in the device and the device's
    filemark size.</para>

    <para>The first few lines of output include status information about the
    execution of the command, including such information as the number of
    blocks and the number of file marks written to the tape by the
    command. The last two lines of both screen and file output provide the
    following information:</para>

    <itemizedlist>
      <listitem>
        <para><computeroutput>Tape capacity is </computeroutput><emphasis>number</emphasis><computeroutput> bytes</computeroutput>: specifies the size, in bytes, of the
        tape in the device.</para>

      </listitem>
      <listitem>
        <para><computeroutput>File marks are </computeroutput><emphasis>number</emphasis><computeroutput> bytes</computeroutput>: specifies the device's filemark size in
        bytes.</para>

      </listitem>
    </itemizedlist>
    <para>The following message indicates that the fms command interpreter cannot
    access the tape device. The command halts.</para>

<programlisting>
   Can't open tape drive I&amp;lt;device&amp;gt;

</programlisting>
      <para>The following message indicates that the command interpreter cannot create
      the <replaceable>fms.log</replaceable> log file. Again, the command halts.</para>

<programlisting>
   Can't open log file

</programlisting>
      </refsect1>
      <refsect1>
        <title>Examples</title>
        <para>The following command illustrates the output for the device called
        <replaceable>/dev/rmt1h</replaceable>:</para>

<programlisting>
   % fms /dev/rmt1h
   wrote block: 130408
   Finished data capacity test - rewinding
   wrote 1109 blocks, 1109 file marks
   Finished file mark test
   Tape capacity is 2136604672 bytes
   File marks are 1910205 bytes

</programlisting>
          <para>The following appears in the <replaceable>fms.log</replaceable> file:</para>

<programlisting>
   fms test started
   wrote 9230 blocks
   Finished file mark test
   Tape capacity is 151224320 bytes
   File marks are 2375680 bytes

</programlisting>
          </refsect1>
          <refsect1>
            <title>Privilege Required</title>
            <para>The issuer must be able to insert and write to files in the currently
            working directory, if the <replaceable>fms.log</replaceable> file does not already exist. If it
            already exists, the issuer need only be able to write to it.</para>

          </refsect1>
          <refsect1>
            <title>See Also</title>
            <para><link linkend="fms_log5">fms.log(5)</link>,
            <link linkend="tapeconfig5">tapeconfig(5)</link></para>

          </refsect1>
          <refsect1>
            <title>Copyright</title>
            <para>IBM Corporation 2000. &lt;http://www.ibm.com/&gt; All Rights Reserved.</para>

            <para>This documentation is covered by the IBM Public License Version 1.0.  It was
            converted from HTML to POD by software written by Chas Williams and Russ
            Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</para>

          </refsect1>
        </refentry>
