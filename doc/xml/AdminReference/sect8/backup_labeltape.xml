<?xml version="1.0" encoding="UTF-8"?>
<refentry id="backup_labeltape8">
  <refmeta>
    <refentrytitle>backup labeltape</refentrytitle>
    <manvolnum>8</manvolnum>
  </refmeta>
  <refnamediv>
    <refname>backup labeltape</refname>
    <refpurpose>Creates the magnetic label on a tape</refpurpose>
  </refnamediv>
  <refsect1>
    <title>Synopsis</title>
    <para><emphasis role="bold">backup labeltape</emphasis> [<emphasis role="bold">-name</emphasis> &lt;<emphasis>AFS tape name, defaults to NULL</emphasis>&gt;]
        [<emphasis role="bold">-size</emphasis> &lt;<emphasis>tape size in Kbytes, defaults to size in tapeconfig</emphasis>&gt;]
        [<emphasis role="bold">-portoffset</emphasis> &lt;<emphasis>TC port offset</emphasis>&gt;] [<emphasis role="bold">-pname</emphasis> &lt;<emphasis>permanent tape name</emphasis>&gt;]
        [<emphasis role="bold">-localauth</emphasis>] [<emphasis role="bold">-cell</emphasis> &lt;<emphasis>cell name</emphasis>&gt;] [<emphasis role="bold">-help</emphasis>]</para>

    <para><emphasis role="bold">backup la</emphasis> [<emphasis role="bold">-n</emphasis> &lt;<emphasis>AFS tape name, defaults to NULL</emphasis>&gt;]
        [<emphasis role="bold">-s</emphasis> &lt;<emphasis>tape size in Kbytes, defaults to size in tapeconfig</emphasis>&gt;]
        [<emphasis role="bold">-po</emphasis> &lt;<emphasis>TC port offset</emphasis>&gt;] [<emphasis role="bold">-pn</emphasis> &lt;<emphasis>permanent tape name</emphasis>&gt;]
        [<emphasis role="bold">-l</emphasis>] [<emphasis role="bold">-c</emphasis> &lt;<emphasis>cell name</emphasis>&gt;] [<emphasis role="bold">-h</emphasis>]</para>

  </refsect1>
  <refsect1>
    <title>Description</title>
    <para>The <emphasis role="bold">backup labeltape</emphasis> command creates a magnetic label, readable by the
    Backup System, at the beginning of a tape. The label records the tape's
    name (either a <emphasis>permanent name</emphasis>, or an <emphasis>AFS tape name</emphasis> that reflects the
    tape's contents in a prescribed format) and its capacity.</para>

    <para>(If the <computeroutput>FILE YES</computeroutput> instruction appears in the
    <replaceable>/usr/afs/backup/CFG_</replaceable><emphasis>device_name</emphasis><replaceable></replaceable> file on the Tape Coordinator machine
    associated with the specified port offset, then the <emphasis role="bold">backup</emphasis> command
    writes label information to the first 16 KB block in the backup data file
    listed for that port offset in the Tape Coordinator's
    <replaceable>/usr/afs/backup/tapeconfig</replaceable> file, rather than at the beginning of a
    tape. For the sake of clarity, the following text refers to tapes only,
    but the Backup System handles backup data files in much the same way.)</para>

    <para>Relabeling a tape that already contains AFS backup data effectively makes
    the data unusable, because the command removes the Backup Database record
    of the complete dump set of which the tape is a part. Use this command to
    enable recycling of a tape that contains unexpired dumps that are not
    actually still needed.</para>

    <para>To write a permanent name on the label, include the <emphasis role="bold">-pname</emphasis> argument to
    specify a string of up to 32 characters. The permanent name persists until
    the <emphasis role="bold">-pname</emphasis> argument is again included on the <emphasis role="bold">backup labeltape</emphasis>
    command, regardless of the tape's contents and of how often the tape is
    otherwise relabeled or recycled. Include this argument or the <emphasis role="bold">-name</emphasis>
    argument, but not both. If this argument is included, the AFS tape name is
    set to <computeroutput>&lt;NULL&gt;</computeroutput>.  The permanent name is set to <computeroutput>&lt;NULL&gt;</computeroutput> if this
    argument is omitted and no permanent name already exists.</para>

    <para>The issuer must ensure that a permanent name is unique among the tapes
    used for AFS backup in the cell, because the <emphasis role="bold">backup</emphasis> command interpreter
    does not verify that another tape does not already have the same permanent
    name. When a tape has a permanent name, the Backup System uses it instead
    of the AFS tape name in most prompts and when referring to the tape in
    output from <emphasis role="bold">backup</emphasis> commands. The permanent name appears in the <computeroutput>tape
    name</computeroutput> field of the output from the <emphasis role="bold">backup readlabel</emphasis> command.</para>

    <para>To write an AFS tape name on the label, provide a value for the <emphasis role="bold">-name</emphasis>
    argument in the required format described in <link linkend="OPTIONS">OPTIONS</link>.  Include the
    <emphasis role="bold">-name</emphasis> argument or the <emphasis role="bold">-pname</emphasis> argument, but not both. If this
    argument is omitted, the AFS tape name is set to <computeroutput>&lt;NULL&gt;</computeroutput>, but the
    Backup System automatically assigns the appropriate name when the tape is
    used in a future <emphasis role="bold">backup dump</emphasis> or <emphasis role="bold">backup savedb</emphasis> operation.  The AFS
    tape name appears in the <computeroutput>AFS tape name</computeroutput> field of the output from the
    <emphasis role="bold">backup readlabel</emphasis> and <emphasis role="bold">backup scantape</emphasis> commands.</para>

    <para>The backup command interpreter does not accept the <emphasis role="bold">-name</emphasis> argument if
    the tape already has a permanent name. To erase a tape's permanent name,
    provide a null value to the <emphasis role="bold">-pname</emphasis> argument by issuing the following
    command:</para>

<programlisting>
   % backup labeltape -pname ""

</programlisting>
      <para>To record the tape's capacity on the label, specify a number of kilobytes
      as the <emphasis role="bold">-size</emphasis> argument. If the argument is omitted the first time a tape
      is labeled, the Backup System records the default tape capacity recorded
      for the specified port offset in the <replaceable>/usr/afs/backup/tapeconfig</replaceable> file on
      the Tape Coordinator machine. Subsequently, the value in the size field
      persists until the <emphasis role="bold">-size</emphasis> argument is again included on the <emphasis role="bold">backup
      labeltape</emphasis> command.</para>

      <para>To determine how much data can be written to a tape during a backup dump
      or <emphasis role="bold">backup savedb</emphasis> operation, the Tape Coordinator reads the capacity
      recorded on the tape's label (or uses the value associated with its port
      offset in the <replaceable>/usr/afs/backup/tapeconfig</replaceable> file, if the tape was never
      labeled). For further description, see the <emphasis role="bold">backup dump</emphasis> reference page.</para>

      <para>The Tape Coordinator's default response to this command is to access the
      tape by invoking the <computeroutput>MOUNT</computeroutput> instruction in the local
      <replaceable>/usr/afs/backup/CFG_</replaceable><emphasis>device_name</emphasis><replaceable></replaceable> file, or by prompting the backup
      operator to insert the tape if there is no <computeroutput>MOUNT</computeroutput> instruction. However,
      if the <computeroutput>AUTOQUERY NO</computeroutput> instruction appears in the <replaceable>CFG_</replaceable><emphasis>device_name</emphasis><replaceable></replaceable>
      file, or if the issuer of the <emphasis role="bold">butc</emphasis> command included the <emphasis role="bold">-noautoquery</emphasis>
      flag, the Tape Coordinator instead expects the tape to be in the device
      already.  If it is not, the Tape Coordinator invokes the <computeroutput>MOUNT</computeroutput>
      instruction or prompts the operator.</para>

    </refsect1>
    <refsect1>
      <title>Options</title>
      <variablelist>
        <varlistentry>
          <term><emphasis role="bold">-name</emphasis> &lt;<emphasis>AFS tape name</emphasis>&gt;</term>
          <listitem>
            <para>Specifies the AFS tape name to record on the label. Include this argument
            or the <emphasis role="bold">-pname</emphasis> argument, but not both. If this argument is omitted, the
            AFS tape name is set to <computeroutput>&lt;NULL&gt;</computeroutput>.  If this argument is provided, it
            must have the following format:</para>

<programlisting>
   &amp;lt;volume_set_name&amp;gt;.&amp;lt;dump_level_name&amp;gt;.&amp;lt;tape_index&amp;gt;

</programlisting>
              <para>for the tape to be acceptable for use in a future backup dump
              operation. The &lt;volume_set_name&gt; must match the volume set name of the
              initial dump to be written to the tape, &lt;dump_level_name&gt; must match the
              last element of the dump level pathname at which the volume set will be
              dumped, and &lt;tape_index&gt; indicates the order of the tape in the dump set
              (indexing begins with <computeroutput>1</computeroutput>). To disable this type of name checking,
              include the <computeroutput>NAME_CHECK NO</computeroutput> instruction in the <replaceable>CFG_</replaceable><emphasis>device_name</emphasis><replaceable></replaceable>
              file.</para>

              <para>For the tape to be acceptable for use in a future backup savedb operation,
              the value specified for the <emphasis role="bold">-name</emphasis> argument must have the following
              format:</para>

<programlisting>
   Ubik_db_dump.&amp;lt;tape_index&amp;gt;

</programlisting>
                <para>where &lt;tape_index&gt; indicates the order of the tape in the set of tapes
                that house the Backup Database dump; indexing begins with <computeroutput>1</computeroutput> (one).</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term><emphasis role="bold">-size</emphasis> &lt;<emphasis>tape size</emphasis>&gt;</term>
              <listitem>
                <para>Specifies the tape capacity to record on the label. Provide an integer
                value followed by a letter that indicates units, with no intervening
                space. A unit value of <computeroutput>k</computeroutput> or <computeroutput>K</computeroutput> indicates kilobytes, <computeroutput>m</computeroutput> or <computeroutput>M</computeroutput>
                indicates megabytes, and <computeroutput>g</computeroutput> or <computeroutput>G</computeroutput> indicates gigabytes. If the units
                letter is omitted, the default is kilobytes.</para>

                <para>If this argument is omitted the first time a tape is labeled, the Backup
                System records the capacity that is associated with the specified port
                offset in the <replaceable>/usr/afs/backup/tapeconfig</replaceable> file on the Tape Coordinator
                machine. The value recorded the first time then persists until the
                <emphasis role="bold">-size</emphasis> argument is provided on a future issuance of the command.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term><emphasis role="bold">-portoffset</emphasis> &lt;<emphasis>TC port offset</emphasis>&gt;</term>
              <listitem>
                <para>Specifies the port offset number of the Tape Coordinator handling the tape
                for this operation.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term><emphasis role="bold">-pname</emphasis> &lt;<emphasis>permanent tape name</emphasis>&gt;</term>
              <listitem>
                <para>Specifies the permanent name to record on the label. It can be up to 32
                characters in length, and include any alphanumeric characters.  Avoid
                metacharacters that have a special meaning to the shell, to avoid having
                to mark them as literal in commands issued at the shell prompt.</para>

                <para>Include this argument or the <emphasis role="bold">-name</emphasis> argument, but not both. If this
                argument is provided, the AFS tape name is set to <computeroutput>&lt;NULL&gt;</computeroutput>. If this
                argument is omitted, any existing permanent name is retained.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term><emphasis role="bold">-localauth</emphasis></term>
              <listitem>
                <para>Constructs a server ticket using a key from the local
                <replaceable>/usr/afs/etc/KeyFile</replaceable> file. The <emphasis role="bold">backup</emphasis> command interpreter presents
                it to the Backup Server, Volume Server and VL Server during mutual
                authentication. Do not combine this flag with the <emphasis role="bold">-cell</emphasis> argument. For
                more details, see <link linkend="backup8">backup(8)</link>.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term><emphasis role="bold">-cell</emphasis> &lt;<emphasis>cell name</emphasis>&gt;</term>
              <listitem>
                <para>Names the cell in which to run the command. Do not combine this argument
                with the <emphasis role="bold">-localauth</emphasis> flag. For more details, see <link linkend="backup8">backup(8)</link>.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term><emphasis role="bold">-help</emphasis></term>
              <listitem>
                <para>Prints the online help for this command. All other valid options are
                ignored.</para>

              </listitem>
            </varlistentry>
          </variablelist>
        </refsect1>
        <refsect1>
          <title>Examples</title>
          <para>The following command records the AFS tape name <computeroutput>user.monthly.1</computeroutput> on the
          label of the tape in the device with port offset 3:</para>

<programlisting>
   % backup labeltape -name user.monthly.1 -portoffset 3

</programlisting>
            <para>The following three commands are equivalent in effect: they all record a
            capacity of 2 GB on the label of the tape in the device with port offset
            4. They set the AFS tape name to <computeroutput>&lt;NULL&gt;</computeroutput> and leave the permanent
            name unchanged.</para>

<programlisting>
   % backup labeltape -size 2g -portoffset 4
   % backup labeltape -size 2048M -portoffset 4
   % backup labeltape -size 2097152 -portoffset 4

</programlisting>
            </refsect1>
            <refsect1>
              <title>Privilege Required</title>
              <para>The issuer must be listed in the <replaceable>/usr/afs/etc/UserList</replaceable> file on every
              machine where the Backup Server is running, or must be logged onto a
              server machine as the local superuser <computeroutput>root</computeroutput> if the <emphasis role="bold">-localauth</emphasis> flag is
              included.</para>

            </refsect1>
            <refsect1>
              <title>See Also</title>
              <para><link linkend="butc5">butc(5)</link>,
              <link linkend="backup8">backup(8)</link>,
              <link linkend="backup_readlabel8">backup_readlabel(8)</link>,
              <link linkend="butc8">butc(8)</link></para>

            </refsect1>
            <refsect1>
              <title>Copyright</title>
              <para>IBM Corporation 2000. &lt;http://www.ibm.com/&gt; All Rights Reserved.</para>

              <para>This documentation is covered by the IBM Public License Version 1.0.  It was
              converted from HTML to POD by software written by Chas Williams and Russ
              Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</para>

            </refsect1>
          </refentry>
