<?xml version="1.0" encoding="UTF-8"?>
<refentry id="backup_readlabel8">
  <refmeta>
    <refentrytitle>backup readlabel</refentrytitle>
    <manvolnum>8</manvolnum>
  </refmeta>
  <refnamediv>
    <refname>backup readlabel</refname>
    <refpurpose>Reads and displays a tape's label</refpurpose>
  </refnamediv>
  <refsect1>
    <title>Synopsis</title>
    <para><emphasis role="bold">backup readlabel</emphasis> [<emphasis role="bold">-portoffset</emphasis> &lt;<emphasis>TC port offset</emphasis>&gt;] [<emphasis role="bold">-localauth</emphasis>]
        [<emphasis role="bold">-cell</emphasis> &lt;<emphasis>cell name</emphasis>&gt;] [<emphasis role="bold">-help</emphasis>]</para>

    <para><emphasis role="bold">backup rea</emphasis> [<emphasis role="bold">-p</emphasis> &lt;<emphasis>TC port offset</emphasis>&gt;] [<emphasis role="bold">-l</emphasis>] [<emphasis role="bold">-c</emphasis> &lt;<emphasis>cell name</emphasis>&gt;]
        [<emphasis role="bold">-h</emphasis>]</para>

  </refsect1>
  <refsect1>
    <title>Description</title>
    <para>The <emphasis role="bold">backup readlabel</emphasis> command displays information from the magnetic
    tape label of a tape. The information includes the tape's name (either a
    <emphasis>permanent name</emphasis>, or an <emphasis>AFS tape name</emphasis> that reflects the tape's
    contents in a prescribed format) and its capacity.</para>

    <para>If the <computeroutput>FILE YES</computeroutput> instruction appears in the
    <replaceable>/usr/afs/backup/CFG_</replaceable><emphasis>device_name</emphasis><replaceable></replaceable> file associated with the specified
    port offset, then the <emphasis role="bold">backup readlabel</emphasis> command reads the label
    information from the first 16 KB block in the backup data file listed for
    that port offset in the Tape Coordinator's <replaceable>/usr/afs/backup/tapeconfig</replaceable>
    file, rather than from the beginning of a tape.</para>

    <para>The Tape Coordinator's default response to this command is to access the
    tape by invoking the <computeroutput>MOUNT</computeroutput> instruction in the local
    <replaceable>/usr/afs/backup/CFG_</replaceable><emphasis>device_name</emphasis><replaceable></replaceable> file, or by prompting the backup
    operator to insert the tape if there is no <computeroutput>MOUNT</computeroutput> instruction. However,
    if the <computeroutput>AUTOQUERY NO</computeroutput> instruction appears in the <replaceable>CFG_</replaceable><emphasis>device_name</emphasis><replaceable></replaceable>
    file, or if the issuer of the <emphasis role="bold">butc</emphasis> command included the <emphasis role="bold">-noautoquery</emphasis>
    flag, the Tape Coordinator instead expects the tape to be in the device
    already.  If it is not, the Tape Coordinator invokes the <computeroutput>MOUNT</computeroutput>
    instruction or prompts the operator.</para>

  </refsect1>
  <refsect1>
    <title>Options</title>
    <variablelist>
      <varlistentry>
        <term><emphasis role="bold">-portoffset</emphasis> &lt;<emphasis>TC port offset</emphasis>&gt;</term>
        <listitem>
          <para>Specifies the port offset number of the Tape Coordinator handling the
          tapes for this operation.</para>

        </listitem>
      </varlistentry>
      <varlistentry>
        <term><emphasis role="bold">-localauth</emphasis></term>
        <listitem>
          <para>Constructs a server ticket using a key from the local
          <replaceable>/usr/afs/etc/KeyFile</replaceable> file. The <emphasis role="bold">backup</emphasis> command interpreter presents
          it to the Backup Server, Volume Server and VL Server during mutual
          authentication. Do not combine this flag with the <emphasis role="bold">-cell</emphasis> argument. For
          more details, see <link linkend="backup8">backup(8)</link>.</para>

        </listitem>
      </varlistentry>
      <varlistentry>
        <term><emphasis role="bold">-cell</emphasis> &lt;<emphasis>cell name</emphasis>&gt;</term>
        <listitem>
          <para>Names the cell in which to run the command. Do not combine this argument
          with the <emphasis role="bold">-localauth</emphasis> flag. For more details, see <link linkend="backup8">backup(8)</link>.</para>

        </listitem>
      </varlistentry>
      <varlistentry>
        <term><emphasis role="bold">-help</emphasis></term>
        <listitem>
          <para>Prints the online help for this command. All other valid options are
          ignored.</para>

        </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>
  <refsect1>
    <title>Output</title>
    <para>Output from this command appears in both the shell window where the
    command is issued, and in the Tape Coordinator window.</para>

    <para>If the tape is unlabeled or if the specified tape device is empty, the
    output reads</para>

<programlisting>
   Failed to read tape label.

</programlisting>
      <para>Otherwise, the output in the shell window has the following format:</para>

<programlisting>
   Tape read was labelled: &amp;lt;tape name&amp;gt; (&amp;lt;dump id&amp;gt;)
        size: &amp;lt;size&amp;gt; Kbytes

</programlisting>
        <para>where &lt;tape name&gt; is the permanent name if the tape has one, or the AFS
        tape name otherwise. The &lt;dump ID&gt; is dump ID of the initial dump on the
        tape, and &lt;size&gt; is the recorded capacity of the tape in kilobytes.</para>

        <para>The output in the Tape Coordinator windows is bounded by an underlined
        <computeroutput>Tape label</computeroutput> header at the top, and the following string at the bottom:</para>

<programlisting>
   -- End of tape label --

</programlisting>
          <para>In between are lines reporting the following information:</para>

          <variablelist>
            <varlistentry>
              <term>tape name</term>
              <listitem>
                <para>The permanent name assigned by using the -pname argument of the <emphasis role="bold">backup
                labeltape</emphasis> command. This name remains on the tape until that argument is
                used again, no matter how many times the tape is recycled or otherwise
                relabeled. If the tape does not have a permanent name, the value <computeroutput>&lt;NULL&gt;</computeroutput> appears in this field.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term>AFS tape name</term>
              <listitem>
                <para>A tape name in one of the following prescribed formats. The Backup System
                automatically writes the appropriate AFS tape name to the label as part of
                a <emphasis role="bold">backup dump</emphasis> or <emphasis role="bold">backup savedb</emphasis> operation, or the operator can assign
                it with the <emphasis role="bold">-name</emphasis> argument to the <emphasis role="bold">backup labeltape</emphasis> command.</para>

                <itemizedlist>
                  <listitem>
                    <para><emphasis>volume_set_name</emphasis><emphasis role="bold">.</emphasis><emphasis>dump_level_name</emphasis>.<emphasis>tape_index</emphasis>, if the tape
                    contains volume data. The <emphasis>volume_set_name</emphasis> is the name of the volume set
                    that was dumped to create the initial dump in the dump set of to which
                    this tape belongs; <emphasis>dump_level_name</emphasis> is the last pathname element of the
                    dump level at which the initial dump was backed up; and <emphasis>tape_index</emphasis> is
                    the numerical position of the tape in the dump set.</para>

                  </listitem>
                  <listitem>
                    <para><computeroutput>Ubik.db.dump.</computeroutput><emphasis>tape_index</emphasis> if the tape contains a dump of the Backup
                    Database, created with the <emphasis role="bold">backup savedb</emphasis> command. The <emphasis>tape_index</emphasis> is
                    the ordinal of the tape in the dump set.</para>

                  </listitem>
                  <listitem>
                    <para><computeroutput>&lt;NULL&gt;</computeroutput> if the tape has no AFS tape name. This is normally the case
                    if the <emphasis role="bold">-name</emphasis> argument was not included the last time the <emphasis role="bold">backup
                    labeltape</emphasis> command was used on this tape, and no data has been written to
                    it since.</para>

                  </listitem>
                </itemizedlist>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>creationTime</term>
              <listitem>
                <para>The date and time at which the Backup System started performing the dump
                operation that created the initial dump.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term>cell</term>
              <listitem>
                <para>The cell in which the dump set was created. This is the cell whose Backup
                Database contains a record of the dump set.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term>size</term>
              <listitem>
                <para>The tape's capacity (in kilobytes) as recorded on the label, rather than
                the amount of data on the tape. The value is assigned by the <emphasis role="bold">-size</emphasis>
                argument to the <emphasis role="bold">backup labeltape</emphasis> command or derived from the
                <replaceable>/usr/afs/backup/tapeconfig</replaceable> file on the Tape Coordinator machine, not
                from a measurement of the tape.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term>dump path</term>
              <listitem>
                <para>The dump level of the initial dump in the dump set.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term>dump id</term>
              <listitem>
                <para>The dump ID number of the initial dump in the dump set, as recorded in the
                Backup Database.</para>

              </listitem>
            </varlistentry>
            <varlistentry>
              <term>useCount</term>
              <listitem>
                <para>The number of times a dump has been written to the tape, or it has been
                relabeled.</para>

              </listitem>
            </varlistentry>
          </variablelist>
          <para>The message <computeroutput>ReadLabel: Finished</computeroutput> indicates the completion of the output.</para>

        </refsect1>
        <refsect1>
          <title>Examples</title>
          <para>The following example shows the output for the tape with permanent name
          <computeroutput>oct.guest.dump</computeroutput> and capacity 2 MB, expressed in kilobyte units (2097152
          equals 2 times 10242).</para>

<programlisting>
   % backup readlabel -portoffset 6
   Tape read was labelled: oct.guest.dump (907215000)
        size: 2097152 Kbytes

</programlisting>
            <para>The output in the Tape Coordinator window reads:</para>

<programlisting>
   Tape label
   ----------
   tape name = oct.guest.dump
   AFS tape name = guests.monthly.3
   creationTime = Thu Oct 1 00:10:00 1998
   cell = abc.com
   size = 2097152 Kbytes
   dump path = /monthly
   dump id = 907215000
   useCount = 5
   ---- End of tape label ----

</programlisting>
              <para>The following example is for a tape that does not have a permanent tape.</para>

<programlisting>
   % backup readlabel -portoffset 6
   Tape read was labelled: guests.monthly.2 (909899900)
        size: 2097152 Kbytes

</programlisting>
                <para>The output in the Tape Coordinator window reads:</para>

<programlisting>
   Tape label
   ----------
   tape name = &amp;lt;NULL&amp;gt;
   AFS tape name = guests.monthly.2
   creationTime = Sun Nov 1 00:58:20 1998
   cell = abc.com
   size = 2097152 Kbytes
   dump path = /monthly
   dump id = 909899900
   useCount = 1
   ---- End of tape label ----

</programlisting>
                </refsect1>
                <refsect1>
                  <title>Privilege Required</title>
                  <para>The issuer must be listed in the <replaceable>/usr/afs/etc/UserList</replaceable> file on every
                  machine where the Backup Server is running, or must be logged onto a
                  server machine as the local superuser <computeroutput>root</computeroutput> if the <emphasis role="bold">-localauth</emphasis> flag is
                  included.</para>

                </refsect1>
                <refsect1>
                  <title>See Also</title>
                  <para><link linkend="butc5">butc(5)</link>,
                  <link linkend="backup8">backup(8)</link>,
                  <link linkend="backup_labeltape8">backup_labeltape(8)</link>,
                  <link linkend="butc8">butc(8)</link></para>

                </refsect1>
                <refsect1>
                  <title>Copyright</title>
                  <para>IBM Corporation 2000. &lt;http://www.ibm.com/&gt; All Rights Reserved.</para>

                  <para>This documentation is covered by the IBM Public License Version 1.0.  It was
                  converted from HTML to POD by software written by Chas Williams and Russ
                  Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</para>

                </refsect1>
              </refentry>
