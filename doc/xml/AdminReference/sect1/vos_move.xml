<?xml version="1.0" encoding="UTF-8"?>
<refentry id="vos_move1">
  <refmeta>
    <refentrytitle>vos move</refentrytitle>
    <manvolnum>1</manvolnum>
  </refmeta>
  <refnamediv>
    <refname>vos move</refname>
    <refpurpose>Moves a read/write volume to another site</refpurpose>
  </refnamediv>
  <refsect1>
    <title>Synopsis</title>
    <para><emphasis role="bold">vos move</emphasis> <emphasis role="bold">-id</emphasis> &lt;<emphasis>volume name or ID</emphasis>&gt;
        <emphasis role="bold">-fromserver</emphasis> &lt;<emphasis>machine name on source</emphasis>&gt;
        <emphasis role="bold">-frompartition</emphasis> &lt;<emphasis>partition name on source</emphasis>&gt;
        <emphasis role="bold">-toserver</emphasis> &lt;<emphasis>machine name on destination</emphasis>&gt;
        <emphasis role="bold">-topartition</emphasis> &lt;<emphasis>partition name on destination</emphasis>&gt;
        [<emphasis role="bold">-cell</emphasis> &lt;<emphasis>cell name</emphasis>&gt;] [<emphasis role="bold">-noauth</emphasis>] [<emphasis role="bold">-localauth</emphasis>] [<emphasis role="bold">-verbose</emphasis>]
        [<emphasis role="bold">-help</emphasis>]</para>

    <para><emphasis role="bold">vos m -i</emphasis> &lt;<emphasis>volume name or ID</emphasis>&gt;
        <emphasis role="bold">-froms</emphasis> &lt;<emphasis>machine name on source</emphasis>&gt;
        <emphasis role="bold">-fromp</emphasis> &lt;<emphasis>partition name on source</emphasis>&gt;
        <emphasis role="bold">-tos</emphasis> &lt;<emphasis>machine name on destination</emphasis>&gt;
        <emphasis role="bold">-top</emphasis> &lt;<emphasis>partition name on destination</emphasis>&gt;
        [-c &lt;<emphasis>cell name</emphasis>&gt;] [<emphasis role="bold">-n</emphasis>] [<emphasis role="bold">-l</emphasis>] [<emphasis role="bold">-v</emphasis>] [<emphasis role="bold">-h</emphasis>]</para>

  </refsect1>
  <refsect1>
    <title>Description</title>
    <para>The <emphasis role="bold">vos move</emphasis> command moves the indicated read/write volume from its
    current site (specified with the <emphasis role="bold">-fromserver</emphasis> and <emphasis role="bold">-frompartition</emphasis>
    arguments) to the destination site (specified with the <emphasis role="bold">-toserver</emphasis> and
    <emphasis role="bold">-topartition</emphasis> arguments). This command automatically removes the backup
    copy from the current site, if it exists. To create a new backup volume at
    the destination site, use the <emphasis role="bold">vos backup</emphasis> command.</para>

    <para>This command works on read/write volumes only. To move a read-only volume,
    use the <emphasis role="bold">vos addsite</emphasis> and <emphasis role="bold">vos release</emphasis> commands to define a new
    read-only site and release the volume contents to it, and then use the
    <emphasis role="bold">vos remove</emphasis> command to remove the previous read-only volume's definition
    from the Volume Location Database (VLDB) and data from the partition. To
    move a backup volume, use this command to move its read/write source and
    then issue the <emphasis role="bold">vos backup</emphasis> command.</para>

    <para>Before executing this command, the <emphasis role="bold">vos</emphasis> command interpreter initiates a
    check that the destination partition contains enough space to house the
    volume being moved. If there is not enough space, the move operation is
    not attempted and the following message appears:</para>

<programlisting>
   vos: no space on target partition &amp;lt;dest_part&amp;gt; to move volume &amp;lt;volume&amp;gt;

</programlisting>
    </refsect1>
    <refsect1>
      <title>Cautions</title>
      <para>Unless there is a compelling reason, do not interrupt a <emphasis role="bold">vos move</emphasis>
      command in progress. Interrupting a move can result in one or more of the
      following inconsistent states:</para>

      <itemizedlist>
        <listitem>
          <para>There are two versions of the volume, one at the source site and one at
          the destination site. (If this happens, retain the version identified by
          the VLDB and use the <emphasis role="bold">vos zap</emphasis> command to remove the other version.)</para>

        </listitem>
        <listitem>
          <para>The backup version of the volume is stranded at the old site. (If this
          happens, use the <emphasis role="bold">vos zap</emphasis> command to remove it.)</para>

        </listitem>
        <listitem>
          <para>The volume is off-line. (If this happens, run the <emphasis role="bold">bos salvage</emphasis> command
          to bring it back on line.)</para>

        </listitem>
      </itemizedlist>
      <para>If the Ctrl-C interrupt signal is pressed while a vos move operation is
      executing, the following message warns of the consequences and requests
      confirmation of the kill signal:</para>

<programlisting>
   SIGINT handler: vos move operation in progress
   WARNING: may leave AFS storage and metadata in indeterminate state
   enter second control-c to exit

</programlisting>
        <para>To confirm termination of the operation, press Ctrl-C a second time; press
        any other key to continue the operation.</para>

      </refsect1>
      <refsect1>
        <title>Options</title>
        <variablelist>
          <varlistentry>
            <term><emphasis role="bold">-id</emphasis> &lt;<emphasis>volume name or ID</emphasis>&gt;</term>
            <listitem>
              <para>Specifies either the complete name or volume ID number of a read/write
              volume.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-fromserver</emphasis> &lt;<emphasis>server name</emphasis>&gt;</term>
            <listitem>
              <para>Identifies the file server machine where the volume currently
              resides. Provide the machine's IP address or its host name (either fully
              qualified or using an unambiguous abbreviation). For details, see
              <link linkend="vos1">vos(1)</link>.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-frompartition</emphasis> &lt;<emphasis>partition name</emphasis>&gt;</term>
            <listitem>
              <para>Names the partition where the volume currently resides. Provide the full
              partition name (for, example, <emphasis role="bold">/vicepa</emphasis>) or one of the abbreviated forms
              described in <link linkend="vos1">vos(1)</link>.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-toserver</emphasis> &lt;<emphasis>server name</emphasis>&gt;</term>
            <listitem>
              <para>Identifies the file server machine to which to move the volume.  Provide
              the machine's IP address or its host name (either fully qualified or using
              an unambiguous abbreviation). For details, see <link linkend="vos1">vos(1)</link>.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-topartition</emphasis> &lt;<emphasis>partition name</emphasis>&gt;</term>
            <listitem>
              <para>Names the partition to which to move the volume. Provide the full
              partition name (for, example, <emphasis role="bold">/vicepa</emphasis>) or one of the abbreviated forms
              described in <link linkend="vos1">vos(1)</link>.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-cell</emphasis> &lt;<emphasis>cell name</emphasis>&gt;</term>
            <listitem>
              <para>Names the cell in which to run the command. Do not combine this argument
              with the <emphasis role="bold">-localauth</emphasis> flag. For more details, see <link linkend="vos1">vos(1)</link>.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-noauth</emphasis></term>
            <listitem>
              <para>Assigns the unprivileged identity <computeroutput>anonymous</computeroutput> to the issuer. Do not
              combine this flag with the <emphasis role="bold">-localauth</emphasis> flag. For more details, see
              <link linkend="vos1">vos(1)</link>.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-localauth</emphasis></term>
            <listitem>
              <para>Constructs a server ticket using a key from the local
              <replaceable>/usr/afs/etc/KeyFile</replaceable> file. The <emphasis role="bold">vos</emphasis> command interpreter presents it
              to the Volume Server and Volume Location Server during mutual
              authentication. Do not combine this flag with the <emphasis role="bold">-cell</emphasis> argument or
              <emphasis role="bold">-noauth</emphasis> flag. For more details, see <link linkend="vos1">vos(1)</link>.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-verbose</emphasis></term>
            <listitem>
              <para>Produces on the standard output stream a detailed trace of the command's
              execution. If this argument is omitted, only warnings and error messages
              appear.</para>

            </listitem>
          </varlistentry>
          <varlistentry>
            <term><emphasis role="bold">-help</emphasis></term>
            <listitem>
              <para>Prints the online help for this command. All other valid options are
              ignored.</para>

            </listitem>
          </varlistentry>
        </variablelist>
      </refsect1>
      <refsect1>
        <title>Examples</title>
        <para>The following example moves the volume <computeroutput>user.smith</computeroutput> from the <replaceable>/vicepb</replaceable>
        partition on the file server machine <computeroutput>fs3.abc.com</computeroutput> to the <replaceable>/vicepg</replaceable>
        partition on the file server machine <computeroutput>fs7.abc.com</computeroutput>.</para>

<programlisting>
   % vos move -id user.smith -fromserver fs3.abc.com -frompartition b \
       -toserver fs7.abc.com -topartition g

</programlisting>
        </refsect1>
        <refsect1>
          <title>Privilege Required</title>
          <para>The issuer must be listed in the <replaceable>/usr/afs/etc/UserList</replaceable> file on the
          machines specified with the <emphasis role="bold">-toserver</emphasis> and <emphasis role="bold">-fromserver</emphasis> arguments and
          on each database server machine.  If the <emphasis role="bold">-localauth</emphasis> flag is included,
          the issuer must instead be logged on to a server machine as the local
          superuser <computeroutput>root</computeroutput>.</para>

        </refsect1>
        <refsect1>
          <title>See Also</title>
          <para><link linkend="vos1">vos(1)</link>,
          <link linkend="vos_addsite1">vos_addsite(1)</link>,
          <link linkend="vos_backup1">vos_backup(1)</link>,
          <link linkend="vos_release1">vos_release(1)</link>,
          <link linkend="vos_listvol1">vos_listvol(1)</link>,
          <link linkend="vos_remove1">vos_remove(1)</link></para>

        </refsect1>
        <refsect1>
          <title>Copyright</title>
          <para>IBM Corporation 2000. &lt;http://www.ibm.com/&gt; All Rights Reserved.</para>

          <para>This documentation is covered by the IBM Public License Version 1.0.  It was
          converted from HTML to POD by software written by Chas Williams and Russ
          Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</para>

        </refsect1>
      </refentry>
