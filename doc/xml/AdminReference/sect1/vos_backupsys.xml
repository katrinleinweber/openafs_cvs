<?xml version="1.0" encoding="UTF-8"?>
<refentry id="vos_backupsys1">
  <refmeta>
    <refentrytitle>vos backupsys</refentrytitle>
    <manvolnum>1</manvolnum>
  </refmeta>
  <refnamediv>
    <refname>vos backupsys</refname>
    <refpurpose>Creates a backup volume for several read/write volumes</refpurpose>
  </refnamediv>
  <refsect1>
    <title>Synopsis</title>
    <para><emphasis role="bold">vos backupsys</emphasis> [<emphasis role="bold">-prefix</emphasis> &lt;<emphasis>common prefix on volume(s)</emphasis>&gt;+]
        [<emphasis role="bold">-server</emphasis> &lt;<emphasis>machine name</emphasis>&gt;] [<emphasis role="bold">-partition</emphasis> &lt;<emphasis>partition name</emphasis>&gt;]
        [<emphasis role="bold">-exclude</emphasis>] [<emphasis role="bold">-xprefix</emphasis> &lt;<emphasis>negative prefix on volume(s)</emphasis>&gt;+]
        [<emphasis role="bold">-dryrun</emphasis>] [<emphasis role="bold">-cell</emphasis> &lt;<emphasis>cell name</emphasis>&gt;] [<emphasis role="bold">-noauth</emphasis>] [<emphasis role="bold">-localauth</emphasis>]
        [<emphasis role="bold">-verbose</emphasis>] [<emphasis role="bold">-help</emphasis>]</para>

    <para><emphasis role="bold">vos backups</emphasis> [<emphasis role="bold">-pr</emphasis> &lt;<emphasis>common prefix on volume(s)</emphasis>&gt;+]
        [<emphasis role="bold">-s</emphasis> &lt;<emphasis>machine name</emphasis>&gt;] [<emphasis role="bold">-pa</emphasis> &lt;<emphasis>partition name</emphasis>&gt;] [<emphasis role="bold">-e</emphasis>]
        [<emphasis role="bold">-x</emphasis> &lt;<emphasis>negative prefix on volume(s)</emphasis>&gt;+] [<emphasis role="bold">-d</emphasis>]
        [<emphasis role="bold">-c</emphasis> &lt;<emphasis>cell name</emphasis>&gt;] [<emphasis role="bold">-n</emphasis>] [<emphasis role="bold">-l</emphasis>] [<emphasis role="bold">-v</emphasis>] [<emphasis role="bold">-h</emphasis>]</para>

  </refsect1>
  <refsect1>
    <title>Description</title>
    <para>The <emphasis role="bold">vos backupsys</emphasis> command clones each indicated read/write volume to
    create a backup version, placing each clone at the same site as its
    read/write source version. It assigns each clone the same name as the
    read/write source, adding a <computeroutput>.backup</computeroutput> extension. It assigns the volume ID
    number already allocated for the backup version in the Volume Location
    Database (VLDB). If a backup version already exists for a given volume,
    the new clone replaces it.</para>

    <para>To clone every read/write volume listed in the VLDB, omit all of the
    command's options. Otherwise, combine the command's options to clone
    various groups of volumes. The options use one of two basic criteria to
    select volumes: location (the <emphasis role="bold">-server</emphasis> and <emphasis role="bold">-partition</emphasis> arguments) or
    presence in the volume name of one of a set of specified character strings
    (the <emphasis role="bold">-prefix</emphasis>, <emphasis role="bold">-exclude</emphasis>, and <emphasis role="bold">-xprefix</emphasis> options).</para>

    <para>To clone only volumes that reside on one file server machine, include the
    <emphasis role="bold">-server</emphasis> argument. To clone only volumes that reside on one partition,
    combine the <emphasis role="bold">-server</emphasis> and <emphasis role="bold">-partition</emphasis> arguments. The <emphasis role="bold">-partition</emphasis>
    argument can also be used alone to clone volumes that reside on the
    indicated partition on every file server machine. These arguments can be
    combined with those that select volumes based on their names.</para>

    <para>Combine the <emphasis role="bold">-prefix</emphasis>, -exclude, and <emphasis role="bold">-xprefix</emphasis> options (with or without
    the <emphasis role="bold">-server</emphasis> and <emphasis role="bold">-partition</emphasis> arguments) in the indicated ways to
    select volumes based on character strings contained in their names:</para>

    <itemizedlist>
      <listitem>
        <para>To clone every read/write volume at the specified location whose name
        includes one of a set of specified character strings (for example, begins
        with <computeroutput>user.</computeroutput> or includes the string <computeroutput>afs</computeroutput>), use the <emphasis role="bold">-prefix</emphasis> argument
        or combine the <emphasis role="bold">-xprefix</emphasis> and <emphasis role="bold">-exclude</emphasis> options.</para>

      </listitem>
      <listitem>
        <para>To clone every read/write volume at the specified location except those
        whose name includes one of a set of specified character strings, use the
        <emphasis role="bold">-xprefix</emphasis> argument or combine the <emphasis role="bold">-prefix</emphasis> and <emphasis role="bold">-exclude</emphasis> options.</para>

      </listitem>
      <listitem>
        <para>To clone every read/write volume at the specified location whose name
        includes one of one of a set of specified character strings, except those
        whose names include one of a different set of specified character strings,
        combine the <emphasis role="bold">-prefix</emphasis> and <emphasis role="bold">-xprefix</emphasis> arguments. The command creates a
        list of all volumes that match the <emphasis role="bold">-prefix</emphasis> argument and then removes
        from the list the volumes that match the <emphasis role="bold">-xprefix</emphasis> argument. For
        effective results, the strings specified by the <emphasis role="bold">-xprefix</emphasis> argument must
        designate a subset of the volumes specified by the <emphasis role="bold">-prefix</emphasis> argument.</para>

        <para>If the <emphasis role="bold">-exclude</emphasis> flag is combined with the <emphasis role="bold">-prefix</emphasis> and <emphasis role="bold">-xprefix</emphasis>
        arguments, the command creates a list of all volumes that do not match the
        <emphasis role="bold">-prefix</emphasis> argument and then adds to the list any volumes that match the
        <emphasis role="bold">-xprefix</emphasis> argument. As when the <emphasis role="bold">-exclude</emphasis> flag is not used, the result
        is effective only if the strings specified by the <emphasis role="bold">-xprefix</emphasis> argument
        designate a subset of the volumes specified by the <emphasis role="bold">-prefix</emphasis> argument.</para>

      </listitem>
    </itemizedlist>
    <para>The <emphasis role="bold">-prefix</emphasis> and <emphasis role="bold">-xprefix</emphasis> arguments both accept multiple values,
    which can be used to define disjoint groups of volumes. Each value can be
    one of two types:</para>

    <itemizedlist>
      <listitem>
        <para>A simple character string, which matches volumes whose name begin with the
        string. All characters are interpreted literally (that is, characters that
        potentially have special meaning to the command shell, such as the period,
        have only their literal meaning).</para>

      </listitem>
      <listitem>
        <para>A regular expression, which matches volumes whose names contain the
        expressions. Place a caret (<computeroutput>^</computeroutput>) at the beginning of the expression, and
        enclose the entire string in single quotes (<computeroutput>''</computeroutput>). Explaining regular
        expressions is outside the scope of this reference page; see the UNIX
        manual page for regexp(5) or (for a brief introduction)
        <link linkend="backup_addvolentry8">backup_addvolentry(8)</link>. As an example, the following expression matches
        volumes that have the string <computeroutput>aix</computeroutput> anywhere in their names:</para>

<programlisting>
   -prefix  '^.*aix'

</programlisting>
        </listitem>
      </itemizedlist>
      <para>To display a list of the volumes to be cloned, without actually cloning
      them, include the <emphasis role="bold">-dryrun</emphasis> flag. To display a statement that summarizes
      the criteria being used to select volume, include the <emphasis role="bold">-verbose</emphasis> flag.</para>

      <para>This command can be used to clone a single read/write volume; specify its
      complete name as the <emphasis role="bold">-prefix</emphasis> argument. However, it is more efficient to
      use the <emphasis role="bold">vos backup</emphasis> command, which employs a more streamlined technique
      for finding a single volume.</para>

    </refsect1>
    <refsect1>
      <title>Options</title>
      <variablelist>
        <varlistentry>
          <term><emphasis role="bold">-prefix</emphasis> &lt;<emphasis>common prefix</emphasis>&gt;</term>
          <listitem>
            <para>Specifies one or more simple character strings or regular expressions of
            any length; a volume whose name includes the string is placed on the set
            of volumes to be cloned. Include field separators (such as periods) if
            appropriate. This argument can be combined with any combination of the
            <emphasis role="bold">-server</emphasis>, <emphasis role="bold">-partition</emphasis>, <emphasis role="bold">-exclude</emphasis>, and <emphasis role="bold">-xprefix</emphasis> options.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-server</emphasis> &lt;<emphasis>machine name</emphasis>&gt;</term>
          <listitem>
            <para>Identifies the file server machine where each read/write source volume
            resides. Provide the machine's IP address or its host name (either fully
            qualified or using an unambiguous abbreviation). For details, see
            <link linkend="vos1">vos(1)</link>.</para>

            <para>This argument can be combined with any combination of the <emphasis role="bold">-prefix</emphasis>,
            <emphasis role="bold">-partition</emphasis>, <emphasis role="bold">-exclude</emphasis>, and <emphasis role="bold">-xprefix</emphasis> options.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-partition</emphasis> &lt;<emphasis>partition name</emphasis>&gt;</term>
          <listitem>
            <para>Identifies the partition where each read/write source volume
            resides. Provide the partition's complete name with preceding slash (for
            example, <computeroutput>/vicepa</computeroutput>) or use one of the three acceptable abbreviated
            forms. For details, see <link linkend="vos1">vos(1)</link>.</para>

            <para>This argument can be combined with any combination of the <emphasis role="bold">-prefix</emphasis>,
            <emphasis role="bold">-server</emphasis>, <emphasis role="bold">-exclude</emphasis>, and <emphasis role="bold">-xprefix</emphasis> options.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-exclude</emphasis></term>
          <listitem>
            <para>Reverses the meaning of the <emphasis role="bold">-prefix</emphasis> or <emphasis role="bold">-xprefix</emphasis> argument. This flag
            can be combined with any combination of the <emphasis role="bold">-prefix</emphasis>, <emphasis role="bold">-server</emphasis>,
            <emphasis role="bold">-partition</emphasis>, and <emphasis role="bold">-xprefix</emphasis> options.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-xprefix</emphasis> &lt;<emphasis>negative prefix</emphasis>&gt;</term>
          <listitem>
            <para>Specifies a simple character string or regular expression of any length; a
            volume whose name includes the string is removed from the set of volumes
            to be cloned. Include field separators (such as periods) if
            appropriate. This argument can be combined with any combination of the
            <emphasis role="bold">-prefix</emphasis>, <emphasis role="bold">-server</emphasis>, <emphasis role="bold">-partition</emphasis>, and <emphasis role="bold">-exclude</emphasis> options.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-dryrun</emphasis></term>
          <listitem>
            <para>Displays on the standard output stream a list of the volumes to be cloned,
            without actually cloning them.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-cell</emphasis> &lt;<emphasis>cell name</emphasis>&gt;</term>
          <listitem>
            <para>Names the cell in which to run the command. Do not combine this argument
            with the <emphasis role="bold">-localauth</emphasis> flag. For more details, see <link linkend="vos1">vos(1)</link>.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-noauth</emphasis></term>
          <listitem>
            <para>Assigns the unprivileged identity <computeroutput>anonymous</computeroutput> to the issuer. Do not
            combine this flag with the <emphasis role="bold">-localauth</emphasis> flag. For more details, see
            <link linkend="vos1">vos(1)</link>.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-localauth</emphasis></term>
          <listitem>
            <para>Constructs a server ticket using a key from the local
            <replaceable>/usr/afs/etc/KeyFile</replaceable> file. The <emphasis role="bold">vos</emphasis> command interpreter presents it
            to the Volume Server and Volume Location Server during mutual
            authentication. Do not combine this flag with the <emphasis role="bold">-cell</emphasis> argument or
            <emphasis role="bold">-noauth</emphasis> flag. For more details, see <link linkend="vos1">vos(1)</link>.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-verbose</emphasis></term>
          <listitem>
            <para>Produces on the standard output stream a detailed trace of the command's
            execution. If this argument is omitted, only warnings and error messages
            appear.</para>

          </listitem>
        </varlistentry>
        <varlistentry>
          <term><emphasis role="bold">-help</emphasis></term>
          <listitem>
            <para>Prints the online help for this command. All other valid options are
            ignored.</para>

          </listitem>
        </varlistentry>
      </variablelist>
    </refsect1>
    <refsect1>
      <title>Output</title>
      <para>The command generates the following messages on the standard output stream
      to confirm that the operation was successful:</para>

<programlisting>
   done
   Total volumes backed up: &amp;lt;number_cloned&amp;gt;; failed to backup: &amp;lt;failures&amp;gt;

</programlisting>
        <para>If the <emphasis role="bold">-dryrun</emphasis> flag is included, a list of the volumes to be backed up
        precedes the standard confirmation messages.</para>

        <para>If the <emphasis role="bold">-verbose</emphasis> flag is included but not the <emphasis role="bold">-dryrun</emphasis> flag, the
        following messages appear for each volume. The output concludes with the
        standard confirmation messages.</para>

<programlisting>
   Creating backup volume for &amp;lt;volume_name&amp;gt; on &amp;lt;date/time&amp;gt;
   {Recloning backup volume | Creating a new backup clone} &amp;lt;backup_volumeID&amp;gt; . . .done

</programlisting>
          <para>If both the <emphasis role="bold">-dryrun</emphasis> and <emphasis role="bold">-verbose</emphasis> flags are included, the output
          begins with a statement summarizing the criteria being used to select the
          volumes, followed by a list of the volumes and the standard confirmation
          messages. The format of the criteria summary statement depends on which
          other options are provided:</para>

          <itemizedlist>
            <listitem>
              <para>If only the <emphasis role="bold">-prefix</emphasis> argument is provided, or the <emphasis role="bold">-xprefix</emphasis> and
              <emphasis role="bold">-exclude</emphasis> options are combined:</para>

<programlisting>
   Would have backed up volumes which are prefixed with &amp;lt;string&amp;gt; [or &amp;lt;string&amp;gt;] . .

</programlisting>
              </listitem>
              <listitem>
                <para>If only the <emphasis role="bold">-xprefix</emphasis> argument is provided, or the <emphasis role="bold">-prefix</emphasis> and
                <emphasis role="bold">-exclude</emphasis> options are combined:</para>

<programlisting>
   Would have backed up volumes which are not prefixed with &amp;lt;string&amp;gt; [nor &amp;lt;string&amp;gt;] . .

</programlisting>
                </listitem>
                <listitem>
                  <para>If the <emphasis role="bold">-prefix</emphasis> and <emphasis role="bold">-xprefix</emphasis> arguments are combined:</para>

<programlisting>
   Would have backed up volumes which are prefixed with &amp;lt;string&amp;gt; [or &amp;lt;string&amp;gt;] \
      removing those which are prefixed with &amp;lt;x_string&amp;gt; [or &amp;lt;x_string&amp;gt;] . .

</programlisting>
                  </listitem>
                  <listitem>
                    <para>If the <emphasis role="bold">-prefix</emphasis>, <emphasis role="bold">-xprefix</emphasis>, and <emphasis role="bold">-exclude</emphasis> options are provided:</para>

<programlisting>
   Would have backed up volumes which are not prefixed with &amp;lt;string&amp;gt; [nor &amp;lt;string&amp;gt;] \
      adding those which are prefixed with &amp;lt;x_string&amp;gt; [or &amp;lt;x_string&amp;gt;] . .

</programlisting>
                    </listitem>
                  </itemizedlist>
                </refsect1>
                <refsect1>
                  <title>Examples</title>
                  <para>The following example creates a backup version of every read/write volume
                  listed in the cell's VLDB whose name begins with the string <emphasis role="bold">user</emphasis>.</para>

<programlisting>
   % vos backupsys -prefix user

</programlisting>
                    <para>The following example, appropriate in the ABC Corporation cell, creates a
                    backup version of every read/write volume on the file server machine
                    <computeroutput>fs3.abc.com</computeroutput>.</para>

<programlisting>
   % vos backupsys -server fs3.abc.com

</programlisting>
                      <para>The following example, appropriate in the State University cell, creates a
                      backup version of every read/write volume on the file server machine
                      <computeroutput>db1.stateu.edu</computeroutput> except those whose name includes the string <computeroutput>temp</computeroutput>.</para>

<programlisting>
   % vos backupsys  -server db1.stateu.edu -prefix '^.*temp'

</programlisting>
                        <para>The following example creates a backup version of every volume listed in
                        the cell's VLDB, excluding those whose names contain the string <computeroutput>source</computeroutput>,
                        but including those whose names contain the string <computeroutput>source.current</computeroutput>.</para>

<programlisting>
   % vos backupsys  -prefix '^.*source' -exclude -xprefix '^.*source\.current'

</programlisting>
                        </refsect1>
                        <refsect1>
                          <title>Privilege Required</title>
                          <para>The issuer must be listed in the <replaceable>/usr/afs/etc/UserList</replaceable> file on the
                          machine specified with the <emphasis role="bold">-server</emphasis> argument and on each database server
                          machine. If the <emphasis role="bold">-localauth</emphasis> flag is included, the issuer must instead be
                          logged on to a server machine as the local superuser <computeroutput>root</computeroutput>.</para>

                        </refsect1>
                        <refsect1>
                          <title>See Also</title>
                          <para><link linkend="backup_addvolentry8">backup_addvolentry(8)</link>,
                          <link linkend="vos1">vos(1)</link>,
                          <link linkend="vos_backup1">vos_backup(1)</link></para>

                          <para>UNIX manual page for regexp(5)</para>

                        </refsect1>
                        <refsect1>
                          <title>Copyright</title>
                          <para>IBM Corporation 2000. &lt;http://www.ibm.com/&gt; All Rights Reserved.</para>

                          <para>This documentation is covered by the IBM Public License Version 1.0.  It was
                          converted from HTML to POD by software written by Chas Williams and Russ
                          Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</para>

                        </refsect1>
                      </refentry>
